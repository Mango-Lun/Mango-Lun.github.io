<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>项目学习记录-商品汇</title>
      <link href="/2022/11/07/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95-%E5%95%86%E5%93%81%E6%B1%87/"/>
      <url>/2022/11/07/%E9%A1%B9%E7%9B%AE%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95-%E5%95%86%E5%93%81%E6%B1%87/</url>
      
        <content type="html"><![CDATA[<h2 id="1-vue-cli-新建项目"><a href="#1-vue-cli-新建项目" class="headerlink" title="1. vue-cli 新建项目"></a>1. vue-cli 新建项目</h2><ul><li><p>nodu_modules文件夹: 项目依赖文件夹。</p></li><li><p>public文件夹：一般放置一些静态资源（图片），需要注意，放在 public 文件夹中的静态资源，webpack 进行打包的时候，会原封不动的到报道 dist 文件夹中。</p></li><li><p>src 文件夹（程序员源代码文件夹）：</p><ul><li>assets文件夹： 一般也是放置静态资源（一般放置多个组件公用的静态资源），需要注意，放置在 assets 文件夹里面的静态资源，在 webpack 打包的时候，会把静态资源当作一个模块，打包到 js 文件里面。</li></ul></li><li><p>components文件夹：一般放置的是非路由组件（全局组件）</p><ul><li>App.vue： 唯一的根组件，Vue 当中的组件（.vue）</li></ul></li><li><p>main.js：程序入口文件，也是整个程序当中最先执行的文件</p></li><li><p>babel.config.js：配置文件（babel相关）</p></li><li><p>package.json：认为项目‘身份证’，记录项目叫做什么，项目当中有那些依赖，项目怎么运行</p></li><li><p>package-lock.json：缓存性文件</p></li><li><p>README.md：说明书</p></li></ul><h2 id="2-项目的其他配置"><a href="#2-项目的其他配置" class="headerlink" title="2. 项目的其他配置"></a>2. 项目的其他配置</h2><h3 id="项目运行起来的时候，让浏览器自动打开"><a href="#项目运行起来的时候，让浏览器自动打开" class="headerlink" title="项目运行起来的时候，让浏览器自动打开"></a>项目运行起来的时候，让浏览器自动打开</h3><p>在根目录下的 vue.config.js 中 添加如下配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">devServer</span>: &#123;</span><br><span class="line">  <span class="attr">port</span>: <span class="number">3333</span>,</span><br><span class="line">  <span class="attr">host</span>: <span class="string">&#x27;localhost&#x27;</span>,</span><br><span class="line">  <span class="attr">open</span>: <span class="literal">true</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="eslint校验功能关闭："><a href="#eslint校验功能关闭：" class="headerlink" title="eslint校验功能关闭："></a>eslint校验功能关闭：</h3><p>在根目录下的 vue.config.js 中 添加如下配置：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lintOnSave</span>: <span class="literal">false</span></span><br></pre></td></tr></table></figure><h3 id="src-目录简写方法，配置别名（-）"><a href="#src-目录简写方法，配置别名（-）" class="headerlink" title="src 目录简写方法，配置别名（@）"></a>src 目录简写方法，配置别名（@）</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;complierOptions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;baseUrl&quot;</span><span class="punctuation">:</span> <span class="string">&quot;./&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;paths&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;@/*&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;src/*&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="comment">// 在如下文件中不能使用以上配置</span></span><br><span class="line">    <span class="attr">&quot;exclude&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;node_modules&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;dist&quot;</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-项目路由的分析"><a href="#3-项目路由的分析" class="headerlink" title="3. 项目路由的分析"></a>3. 项目路由的分析</h2><p>前端所谓的路由：kv键值对</p><p>key：URL（地址栏中的路径）</p><p>value：相应的路由组件</p><p>注意：项目是上中下结构</p><p>路由组件：</p><ul><li>Home首页路由组件、search搜索路由组件、login登陆路由、refister注册路由</li></ul><p>非路由组件：</p><ul><li>header（首页、搜索页有）</li><li>footer（首页、搜索页有，但是在登陆、注册页面没有）</li></ul><h2 id="4-项目中遇到的一些问题"><a href="#4-项目中遇到的一些问题" class="headerlink" title="4. 项目中遇到的一些问题"></a>4. 项目中遇到的一些问题</h2><h3 id="组件的显示与隐藏"><a href="#组件的显示与隐藏" class="headerlink" title="组件的显示与隐藏"></a>组件的显示与隐藏</h3><p>通过配置路由元信息<code>$route.mete.xxx</code>和<code>v-if</code>属性来控制 footer 组件的显示与隐藏</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">mete</span>: &#123;<span class="attr">show</span>:<span class="literal">true</span>&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/home&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">    <span class="attr">mete</span>: &#123;<span class="attr">show</span>:<span class="literal">true</span>&#125;</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/login&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Login</span>,</span><br><span class="line">    <span class="attr">mete</span>: &#123;<span class="attr">show</span>:<span class="literal">false</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;Footer v-show=&quot;$route.mete.show&quot;&gt;&lt;/Footer&gt;</span><br></pre></td></tr></table></figure><h3 id="路由传参"><a href="#路由传参" class="headerlink" title="路由传参"></a>路由传参</h3><p><strong>路由以对象形式传递参数时，path是否可以结合params参数一起使用？</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">path</span>:<span class="string">&#x27;/search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br></pre></td></tr></table></figure><p>路由跳转的时候，对象的写法可以是name、path的形式，但是需要注意的是，path这种写法不能与params参数的形式一起使用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&quot;/search/:keyword&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;search&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br></pre></td></tr></table></figure><p><strong>如果指定了路由路径中需要携带params参数，而在使用编程式导航时没有携带params参数。路径会出现问题。如本该是<code>http://localhost:8080/#/search?k=QWE</code>变成了<code>http://localhost:8080/#/?k=QWE</code></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;search&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">query</span>:&#123;k=<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br><span class="line"><span class="comment">// 调用时并没有传递params参数</span></span><br></pre></td></tr></table></figure><p>如果需要指定的params参数可以传递也可以不传递，在配置路由的时候，在占位的后面加上一个问好。代表params可传可不传。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword?&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;search&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>params参数可以传递也可以不传，但是如果传递的是空字符串，如何解决？</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="string">&#x27;&#x27;</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br></pre></td></tr></table></figure><p>路径会出错。如本该是<code>http://localhost:8080/#/search?k=QWE</code>变成了<code>http://localhost:8080/#/?k=QWE</code></p><p>使用undefined解决：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="string">&#x27;&#x27;</span>||<span class="literal">undefined</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br></pre></td></tr></table></figure><p><strong>路由组件能不能传递props数据？</strong></p><p>可以。</p><p>第一种方式，布尔值写法，开启props传参，但是只能接收到params的参数，不能接收到query的参数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword?&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;search&quot;</span>,</span><br><span class="line">    <span class="attr">props</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第二种写法，对象写法，额外的给路由组件传递一些自定义的props。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword?&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;search&quot;</span>,</span><br><span class="line">    <span class="attr">props</span>: &#123;<span class="attr">a</span>:<span class="number">1</span>,<span class="attr">b</span>:<span class="number">2</span>&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>第三种写法，函数写法，可以传递params、query参数给props</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>:<span class="string">&quot;/search/:keyword?&quot;</span>,</span><br><span class="line">    <span class="attr">component</span>: <span class="title class_">Search</span>,</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;search&quot;</span>,</span><br><span class="line">    <span class="attr">props</span>: <span class="function">(<span class="params">$route</span>) =&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;<span class="attr">keyword</span>:$route.<span class="property">params</span>.<span class="property">keyword</span>,<span class="attr">k</span>:$route.<span class="property">query</span>.<span class="property">k</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="重写-push-和-replace-方法"><a href="#重写-push-和-replace-方法" class="headerlink" title="重写 push 和 replace 方法"></a>重写 push 和 replace 方法</h3><p>在输入的字符串不变时，我们连续点击搜索按钮时，终端会抛出错误<code>NavigationDuplicated</code>。</p><p>我们试着输出push的返回值：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> result = <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/11/01/Rw9yN8AQqrEuheF.png" alt="image-20221101113837871.png"></p><p>发现是一个promise对象，而我们知道promise都需要一个成功的回调函数，而我们没有。所以我们在调用push方法的时候，在参数后面加上成功和失败的回调函数就不会再报错了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span>, <span class="attr">parmas</span>:&#123;<span class="attr">keyword</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>&#125;, <span class="attr">query</span>:&#123;<span class="attr">k</span>:<span class="variable language_">this</span>.<span class="property">keyword</span>.<span class="title function_">toUpperCase</span>()&#125;&#125;,<span class="function">()=&gt;</span>&#123;&#125;,<span class="function">(<span class="params">error</span>)=&gt;</span>&#123;<span class="variable language_">console</span>.<span class="title function_">log</span>(error)&#125;)</span><br></pre></td></tr></table></figure><p>这种写法，治标不治本，将来在别的组件中调用push、replace方法时，每次都得手动加上两个回调函数。</p><p>this：当前组件实例（search）</p><p>this.$router：属性值VueRouter类的一个实例，当在入口文件注册路由的时候，给组件实例添加 $router|$route 属性。</p><p>push：是VueRouter原型对象<code>VueRouter.prototype</code>上的一个方法，而需要注意的是，当我们想调用push方法的时候，使用push方法的对象的上下文必须得是VueRouter实例对象。这点在后面的代码对体现。</p><p>我们在 <code>router-&gt;index.js</code>中重写push、repalce方法，因为我们在这里为每个vue组件声明了VueRouter的实例对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VueRouter</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 先把VueRouter原型对象的push保存一份</span></span><br><span class="line"><span class="keyword">let</span> originPush = <span class="title class_">VueRouter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 重写push\replace</span></span><br><span class="line"><span class="comment">// 第一个参数：告诉原来的push方法，你往哪跳转（传递那些参数）</span></span><br><span class="line"><span class="comment">// 第二个参数：成功的回调</span></span><br><span class="line"><span class="comment">// 第三个参数：失败的回调</span></span><br><span class="line"><span class="title class_">VueRouter</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">push</span> = <span class="keyword">function</span>(<span class="params">location, resolve, reject</span>) &#123;</span><br><span class="line">    <span class="comment">// 之前说过，要调用push方法，首先的保证此时的上下文必须是VueRouter实例</span></span><br><span class="line">    <span class="comment">// console.log(this) 这里输出一下，发现上下文是VueRouter实例，继续</span></span><br><span class="line">    <span class="comment">// 如果传递了成功和失败的回调,调用原来的push方法</span></span><br><span class="line">    <span class="keyword">if</span>(resolve &amp;&amp; reject) &#123;</span><br><span class="line">        <span class="comment">// 这里不能使用originPush(),因为这样会使得上下文变成window</span></span><br><span class="line">        <span class="comment">// call和apply</span></span><br><span class="line">        <span class="comment">// 相同点：都可以调用函数一次，都可以篡改函数的上下文一次</span></span><br><span class="line">        <span class="comment">// 不同点：call传递参数用逗号隔开，apply传递数组</span></span><br><span class="line">        <span class="comment">// 传递this,告诉方法当前上下文为VueRouter实例对象</span></span><br><span class="line">        originPush.<span class="title function_">call</span>(<span class="variable language_">this</span>,location,resolve,reject)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; <span class="comment">// 有成功的回调或失败的回调，或两个都没有</span></span><br><span class="line">        originPush.<span class="title function_">call</span>(<span class="variable language_">this</span>,location,<span class="function">()=&gt;</span>&#123;&#125;,<span class="function">()=&gt;</span>&#123;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;...&#125;)</span><br></pre></td></tr></table></figure><h3 id="axios-二次封装"><a href="#axios-二次封装" class="headerlink" title="axios 二次封装"></a>axios 二次封装</h3><p>为什么进行二次封装？</p><p>请求拦截器、响应拦截器：请求拦截器可以在发请求之前处理一些业务，响应拦截器，当服务器数据返回以后，可以处理一些事情。</p><p><code>api -&gt; requests.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="comment">// 引入进度条</span></span><br><span class="line"><span class="keyword">import</span> nprogress <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span></span><br><span class="line"><span class="comment">// start:进度条开始 done:进度条结束</span></span><br><span class="line"><span class="comment">// 进度条样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.利用axios对象的方法create，去创建一个axios实例</span></span><br><span class="line"><span class="comment">// 2.requests就是axios，只不过稍微配置一下</span></span><br><span class="line"><span class="keyword">const</span> requests = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;/api&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求拦截器</span></span><br><span class="line">requests.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// config：配置对象，对象里面有一个属性很重要，headers请求头</span></span><br><span class="line">    nprogress.<span class="title function_">start</span>()</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 响应拦截器</span></span><br><span class="line">requests.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    nprogress.<span class="title function_">done</span>()</span><br><span class="line"><span class="comment">// 成功的回调函数</span></span><br><span class="line">    <span class="keyword">return</span> res.<span class="property">data</span></span><br><span class="line">&#125;,<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 响应失败的回调函数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Errpr</span>(<span class="string">&#x27;faile&#x27;</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对外暴露</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> resquests</span><br></pre></td></tr></table></figure><blockquote><p>安装nprogreass <code>npm instsall --save nprogress</code></p></blockquote><h3 id="api接口统一管理以及跨域"><a href="#api接口统一管理以及跨域" class="headerlink" title="api接口统一管理以及跨域"></a>api接口统一管理以及跨域</h3><p>如果项目很小，我们可能不需要在一个文件中进行 api 的统一管理，但是当项目比较大的时候，我们调用接口的次数变多，而这个时候如果我们是在给一个组件中单独发起请求，当有一天后端接口改变时，我们要手动修改每一个请求方法。所以这时我们需要统一管理接口。如：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// api -&gt; index.js</span></span><br><span class="line"><span class="comment">// 导入我们二次封装好的axios</span></span><br><span class="line"><span class="keyword">import</span> requests <span class="keyword">from</span> <span class="string">&#x27;./requests&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 向外共享接口方法</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">reqCategoryList</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">request</span>(&#123;<span class="attr">url</span>:<span class="string">&#x27;/product/getBaseCategoryList&#x27;</span>,<span class="attr">method</span>:<span class="string">&#x27;get&#x27;</span>&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>而在这时我们在<code>main.js</code>调用此函数会出现跨域的问题。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;reqCategoryList&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api&#x27;</span></span><br><span class="line"><span class="title function_">reqCategoryList</span>()</span><br></pre></td></tr></table></figure><p><strong>什么是跨域</strong></p><p>协议、域名、端口号不同的请求。</p><p><code>http://localhost:8080</code> —-前端服务器</p><p><code>http://39.38.123.211</code>  —–后台服务器</p><p><strong>解决方法：</strong>JSONP、CROS、代理</p><p>通过代理解决跨域</p><p><code>webpack.config.js or vue.config.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">export</span> = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 代理跨域</span></span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">proxy</span>: &#123;</span><br><span class="line">            <span class="comment">// 凡是路径中带有 /api 的都会处理</span></span><br><span class="line">            <span class="string">&#x27;/api&#x27;</span>: &#123;</span><br><span class="line">                <span class="attr">target</span>: <span class="string">&#x27;http://39.98.123.211&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="vuex状态管理库"><a href="#vuex状态管理库" class="headerlink" title="vuex状态管理库"></a>vuex状态管理库</h3><p><strong>什么是vuex？</strong></p><blockquote><p><code>npm install --save vuex</code></p></blockquote><p>vuex是官方提供的一个插件，状态管理库，集中式管理项目中组件共用的数据。</p><p>切记，并不是全部项目都需要vuex，如果项目很小，完全不需要vuex，如果项目很大，组件很多、数据很多，数据维护很费劲，就用vuex。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// stor -&gt; index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//需要使用插件一次</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// state: 仓库存储数据的地方</span></span><br><span class="line"><span class="keyword">const</span> sate = &#123;&#125;</span><br><span class="line"><span class="comment">// mutations: 修改state的唯一手段</span></span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="comment">// actions：可以书写自己的业务逻辑，也可以处理异步</span></span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="comment">// getters：理解为计算属性，用于简化仓库数据，让组件获取仓库的数据更加方便</span></span><br><span class="line"><span class="keyword">const</span> getters = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//对外暴露Store类的一个实例</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">state,</span><br><span class="line">    mutations,</span><br><span class="line">    actions,</span><br><span class="line">    getters</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在入口文件<code>main.js</code>中注册仓库</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// 引入仓库</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;@/store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span> (&#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">// 注册仓库：组件实例的身上会多一个属性$store</span></span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p><strong>vuex模块式开发</strong></p><p>想一想：如果当我们的项目特别大，数据特别多，这时我们把数据都放在 state 里面，方便吗？</p><p>所以vuex也能模块式开发，即把大仓库拆分成很多个小仓库。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store-&gt;home-&gt;index.js</span></span><br><span class="line"><span class="comment">// home模块下的仓库</span></span><br><span class="line"><span class="keyword">const</span> sate = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> getters = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    state,</span><br><span class="line">    mutations,</span><br><span class="line">    actions,</span><br><span class="line">    getters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store-&gt;search-&gt;index.js</span></span><br><span class="line"><span class="comment">// search</span></span><br><span class="line"><span class="keyword">const</span> sate = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;&#125;</span><br><span class="line"><span class="keyword">const</span> getters = &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    state,</span><br><span class="line">    mutations,</span><br><span class="line">    actions,</span><br><span class="line">    getters</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store -&gt; index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//需要使用插件一次</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//引入小仓库</span></span><br><span class="line"><span class="keyword">import</span> home <span class="keyword">from</span> <span class="string">&#x27;./home&#x27;</span></span><br><span class="line"><span class="keyword">import</span> search <span class="keyword">from</span> <span class="string">&#x27;./search&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//对外暴露Store类的一个实例</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line"><span class="comment">//实现vuex仓库模块式开发存储数据</span></span><br><span class="line">    <span class="attr">modules</span>:&#123;</span><br><span class="line">        home,</span><br><span class="line">        search</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="防抖与节流"><a href="#防抖与节流" class="headerlink" title="防抖与节流"></a>防抖与节流</h3><p><strong>防抖：</strong>前面的所有的触发都被取消，最后一次执行在规定的时间之后才会触发，也就是说如果连续快速的触发只会执行一次。</p><blockquote><p>lol回城：被打断后，重新计时开始读条回城</p></blockquote><p>如：用户输入框输入数据，发起ajax请求</p><p><strong>节流：</strong>在规定的间隔时间范围内不会重复触发回调，只有大于这个时间间隔才会触发回调，把频繁触发变为少量触发。</p><blockquote><p>lol技能冷却：第一次按下技能释放后，技能冷却时间内无法再次发动技能，只有等技能结束以后，才能再次发动技能</p></blockquote><p>如：轮播图的切换（一秒之内，点击箭头只触发一次）、移动端下滑获取数据</p><p><strong>实现防抖与节流</strong></p><p>安装第三方库<code>lodash.js</code></p><p>防抖函数<code>_.debounce(function()&#123;...&#125;)</code></p><p>节流函数<code>_.throttle(function()&#123;...&#125;)</code></p><h3 id="三级联动实现路由跳转以及参数传递"><a href="#三级联动实现路由跳转以及参数传递" class="headerlink" title="三级联动实现路由跳转以及参数传递"></a>三级联动实现路由跳转以及参数传递</h3><p>我们通过 v-for 循环获取到的导航列表参数渲染出了导航列表，现在我们需要点击相应的标签进行路由跳转以及传递相应的name和id属性。</p><p><img src="https://s2.loli.net/2022/11/02/FfVqHhW8jLniCKr.png" alt="image-20221102094854142.png"></p><p><strong>第一种方式：</strong></p><p>将三级列表的a标签换成router-link标签。</p><p>缺点：router-link是一个组件，在切换一级导航时，我们循环渲染二级和三级导航，会出现页面卡顿的现象。</p><p><strong>第二种方式</strong>：</p><p>为每一级导航添加点击事件和回调函数<code>@click=&quot;toSearch&quot;</code></p><p>缺点：我们的二级三级导航很多，需要绑定的事件和处理函数就很多</p><p><strong>第三种方式</strong></p><p>通过事件委托的方式，为它们的父元素添加点击事件和处理函数。</p><p>那么问题来了：我们怎么知道我们点击的是a标签而不是父元素中其他的标签？就算我们知道我们点击的是a标签，按我们怎么知道我们点击的是一级的a标签还是二级的还是三级的？</p><p><strong>第一种方式：</strong></p><p>将三级列表的a标签换成router-link标签。(声明式导航)</p><p>缺点：router-link是一个组件，在切换一级导航时，我们循环渲染二级和三级导航，会出现页面卡顿的现象。</p><p><strong>第二种方式</strong>：</p><p>为每一级导航添加点击事件和回调函数<code>@click=&quot;toSearch&quot;</code> （编程式导航）</p><p>缺点：我们的二级三级导航很多，需要绑定的事件和处理函数就很多</p><p><strong>第三种方式</strong></p><p>事件委托 + 编程式导航</p><p>通过事件委托的方式，为它们的父元素添加点击事件和处理函数。</p><p>那么问题来了：我们怎么知道我们点击的是a标签而不是父元素中其他的标签？就算我们知道我们点击的是a标签，按我们怎么知道我们点击的是一级的a标签还是二级的还是三级的？</p><p>解决方法：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:data-categoryName</span>=<span class="string">&quot;c1.categoryName&quot;</span> <span class="attr">:data-categoryId1</span>=<span class="string">&quot;c1.categoryId&quot;</span>&gt;</span>&#123;&#123;c1.categoryName&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:data-categoryName</span>=<span class="string">&quot;c2.categoryName&quot;</span> <span class="attr">:data-categoryId2</span>=<span class="string">&quot;c2.categoryId&quot;</span>&gt;</span>&#123;&#123;c1.categoryName&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:data-categoryName</span>=<span class="string">&quot;c3.categoryName&quot;</span> <span class="attr">:data-categoryId3</span>=<span class="string">&quot;c3.categoryId&quot;</span>&gt;</span>&#123;&#123;c1.categoryName&#125;&#125;<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="attr">methods</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">gotoSearch</span>(<span class="params">event</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 获取到当前触发这个事件的节点</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> element = event.<span class="property">target</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 节点有一个属性dataset，可以获取节点的自定义属性和属性</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> &#123;categoryname, categoryid1, categoryid2, categoryid3&#125; = element.<span class="property">dataset</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 如果标签上有categoryName就一定是a节点</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(categoryName) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 整理路由跳转参数</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> location = &#123; <span class="attr">name</span>:<span class="string">&#x27;search&#x27;</span> &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">let</span> query = &#123; <span class="attr">categoryName</span>: categoryname &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 一级导航</span></span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(categoryid1) &#123;</span></span><br><span class="line"><span class="language-javascript">                    query.<span class="property">categoryId1</span> = categoryid1</span></span><br><span class="line"><span class="language-javascript">                &#125;<span class="keyword">else</span> <span class="keyword">if</span>(categoryid2) &#123;</span></span><br><span class="line"><span class="language-javascript">                    query.<span class="property">categoryId2</span> = categoryid2</span></span><br><span class="line"><span class="language-javascript">                &#125;<span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    query.<span class="property">categoryId3</span> = categoryid3</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 整理完整参数</span></span></span><br><span class="line"><span class="language-javascript">                location.<span class="property">query</span> = query</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// 路由跳转</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(location)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：自定义属性 data-categoryName 在浏览器中会自动转换为小写 data-categoryname</p></blockquote><h3 id="mockjs模拟数据"><a href="#mockjs模拟数据" class="headerlink" title="mockjs模拟数据"></a>mockjs模拟数据</h3><p>如果想要跳过后端，自己在前端模拟数据，可以通过mockjs模拟数据。</p><ul><li>在项目当中src文件夹中创建mock文件夹</li><li>准备JSON数据（mock文件夹中创建相应的JSON文件） —格式化一下，别留多余空格</li><li>把mock数据需要的图片放置到public文件夹中。（public文件夹在打包的时候，会把相应的资源原封不动的打包到dist文件夹中）</li><li>创建mock.js通过mockjs插件实现模拟数据</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 这里一定是大写，Mock是一个对象</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mock</span> <span class="keyword">from</span> <span class="string">&#x27;mockjs</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// 把JSON数据格式引入进来（JSON数据格式没有对外暴露，但是可以引入）</span></span><br><span class="line"><span class="string">// webpack默认对外暴露的文件：图片、JSON数据格式</span></span><br><span class="line"><span class="string">import banner from &#x27;</span>./banner.<span class="property">json</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">import floor from &#x27;</span>./floor.<span class="property">json</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">// mock数据：第一个参数请求地址 第二个参数：请求数据</span></span><br><span class="line"><span class="string">Mock.mock(&quot;/mock/banner&quot;, &#123;code:200, data: banner&#125;)</span></span><br><span class="line"><span class="string">Mock.mock(&quot;/mock/floor&quot;, &#123;code:200, data: floor&#125;)</span></span><br></pre></td></tr></table></figure><ul><li>mockServer.js文件在入口文件中引入（至少需要执行一次，才能模拟数据）</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"><span class="comment">// 这里并没有 a from b 因为mockServer并没有向外暴露，只需要引入后执行就行了 </span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;@/mock/mockServer.js&#x27;</span>、</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p><strong>封装ajax请求</strong></p><p>注意：这里不能使用之前封装的ajax请求，因为之前封装的请求的根路径是 /api 而我们要拿到mock的模拟数据，我们的根路径得是 /mock，所以要再封装一个 根路径为 /mock 的ajax请求</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// api -&gt; mockAjax.js</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">import</span> nprogress <span class="keyword">from</span> <span class="string">&#x27;nprogress&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;nprogress/nprogress.css&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mockRequests = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">    <span class="attr">baseURL</span>: <span class="string">&#x27;/mock&#x27;</span>,</span><br><span class="line">    <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mockRequests.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">config</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="comment">// config：配置对象，对象里面有一个属性很重要，headers请求头</span></span><br><span class="line">    nprogress.<span class="title function_">start</span>()</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mockRequests.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">    nprogress.<span class="title function_">done</span>()</span><br><span class="line">    <span class="keyword">return</span> res.<span class="property">data</span></span><br><span class="line">&#125;,<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(<span class="keyword">new</span> <span class="title class_">Errpr</span>(<span class="string">&#x27;faile&#x27;</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> mockRequests</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// api -&gt; index.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">import</span> mockRequests <span class="keyword">from</span> <span class="string">&#x27;./mockAjax&#x27;</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">reqGetBannerList</span> = (<span class="params"></span>) =&gt; mockRequests.<span class="title function_">get</span>(<span class="string">&#x27;/banner&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>组件使用接口获取mock数据</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 派发action：通过Vuex发起ajax请求，将数据存储在仓库</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;getBannerList&#x27;</span>)</span><br><span class="line">&#125;,</span><br><span class="line">    ...</span><br><span class="line">&#125;   </span><br></pre></td></tr></table></figure><p>在home页面的数据仓库中调用接口，存储数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store -&gt; home.js</span></span><br><span class="line"><span class="keyword">import</span> &#123;reqGetBannerList&#125; <span class="keyword">from</span> <span class="string">&#x27;@/api&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> state = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//轮播图的数据</span></span><br><span class="line">    <span class="attr">bannerList</span>: []</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="title function_">GETBANNERLIST</span>(<span class="params">state, bannerList</span>) &#123;</span><br><span class="line">    state.<span class="property">bannerList</span> = bannerList</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">    ...</span><br><span class="line">    <span class="comment">//获取首页轮播图的数据</span></span><br><span class="line">    <span class="keyword">async</span> <span class="title function_">getBannerList</span>(<span class="params">&#123;commit&#125;</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> result = <span class="keyword">await</span> <span class="title function_">reqGetBannerList</span>()</span><br><span class="line">        <span class="keyword">if</span>(result.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">            <span class="title function_">commit</span>(<span class="string">&#x27;GETBANNERLIST&#x27;</span>, result.<span class="property">data</span>)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>到这里，仓库中就已经存储了相应数据的，但是组件中还是没有，需要在组件中请求仓库数据</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    ...</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">computed</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">        ...<span class="title function_">mapState</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">bannerList</span>: <span class="function"><span class="params">state</span> =&gt;</span> state.<span class="property">home</span>.<span class="property">bannerList</span></span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="swiper实现轮播图"><a href="#swiper实现轮播图" class="headerlink" title="swiper实现轮播图"></a>swiper实现轮播图</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save swiper@5</span><br></pre></td></tr></table></figure><ol><li>引包（相应 js、css）</li><li>页面中结构务必要有</li><li>new Swiper实例 （轮播图添加动态效果）</li></ol><p>由于项目中的所有轮播图样式都是一样的，所以没有必要每一个用到轮播图的组件都单独引入样式，即在入口文件中引入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;swiper/css/swiper.css&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">...</span><br><span class="line">&lt;div class=&quot;swiper&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-wrapper&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;swiper-slide&quot; v-for=&quot;(carousel, index) in bannerList&quot; :key=&quot;carousel.id&quot;&gt;</span><br><span class="line">&lt;img :src=&quot;carousel,imgUrl&quot; /&gt;                </span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;!-- 如果需要分页器 --&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-pagination&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 如果需要导航按钮 --&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-button-prev&quot;&gt;&lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-button-next&quot;&gt;&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 如果需要滚动条 --&gt;</span><br><span class="line">        &lt;div class=&quot;swiper-scrollbar&quot;&gt;&lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import Swiper from &#x27;swiper&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">    ...</span><br><span class="line">    mounted() &#123;</span><br><span class="line">    ...</span><br><span class="line">    this.$store.dispatch(&#x27;getBannerList&#x27;)</span><br><span class="line">        // new Swipe实例</span><br><span class="line">        var mySwiper = new Swiper (&#x27;.swiper&#x27;, &#123;</span><br><span class="line">            direction: &#x27;vertical&#x27;, // 垂直切换选项</span><br><span class="line">            loop: true, // 循环模式选项</span><br><span class="line"></span><br><span class="line">            // 如果需要分页器</span><br><span class="line">            pagination: &#123;</span><br><span class="line">              el: &#x27;.swiper-pagination&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            // 如果需要前进后退按钮</span><br><span class="line">            navigation: &#123;</span><br><span class="line">              nextEl: &#x27;.swiper-button-next&#x27;,</span><br><span class="line">              prevEl: &#x27;.swiper-button-prev&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            // 如果需要滚动条</span><br><span class="line">            scrollbar: &#123;</span><br><span class="line">              el: &#x27;.swiper-scrollbar&#x27;,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)        </span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>ok,这里问题来了，如果我们使用以上代码实现轮播图，当我们打开网页查看效果的时候会发现，根本没有动态效果（轮播图点不动），这是为什么？</p><p><strong>因为dispatch当中涉及到异步语句，导致浏览器可能还在获取数据的时候，v-for还没有遍历渲染结构，浏览器就已经执行new Swiper里面的语句了，而DOM结构中还根本不存在需要添加效果的DOM元素。</strong></p><p>那么解决方法是什么捏？</p><p><strong>第一种方法：设置延时器–笨方法</strong></p><p>设置延时器，给异步方法足够的时间，等时间到了再执行是swiper相关语句</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&quot;getBannerList&quot;</span>)</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> mySwiper = <span class="keyword">new</span> <span class="title class_">Swiper</span> (<span class="string">&#x27;.swiper&#x27;</span>, &#123;</span><br><span class="line">            <span class="attr">direction</span>: <span class="string">&#x27;vertical&#x27;</span>, <span class="comment">// 垂直切换选项</span></span><br><span class="line">            <span class="attr">loop</span>: <span class="literal">true</span>, <span class="comment">// 循环模式选项</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果需要分页器</span></span><br><span class="line">            <span class="attr">pagination</span>: &#123;</span><br><span class="line">              <span class="attr">el</span>: <span class="string">&#x27;.swiper-pagination&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果需要前进后退按钮</span></span><br><span class="line">            <span class="attr">navigation</span>: &#123;</span><br><span class="line">              <span class="attr">nextEl</span>: <span class="string">&#x27;.swiper-button-next&#x27;</span>,</span><br><span class="line">              <span class="attr">prevEl</span>: <span class="string">&#x27;.swiper-button-prev&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果需要滚动条</span></span><br><span class="line">            <span class="attr">scrollbar</span>: &#123;</span><br><span class="line">              <span class="attr">el</span>: <span class="string">&#x27;.swiper-scrollbar&#x27;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;)     </span><br><span class="line">    &#125;, <span class="number">2000</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>第二种方法：watch + nextTick</strong></p><p>watch：监听已有数据的变化。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="comment">// 监听办呢容List数据的变化：由空数组变为里面有数据的数组</span></span><br><span class="line">    <span class="attr">bannerList</span>: &#123;</span><br><span class="line">        <span class="title function_">handler</span>(<span class="params">newValue, oldValue</span>) &#123;</span><br><span class="line">            <span class="keyword">var</span> mySwiper = <span class="keyword">new</span> <span class="title class_">Swiper</span> (<span class="string">&#x27;.swiper&#x27;</span>, &#123;...&#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过watch侦听器，我们确实实现了只有当页面拿到了bannerList数据的时候才开始执行动态渲染，但是，我们虽然拿到了数据，然而紧接着我们就开始执行动态渲染，这里就出现问题了，在这之前的v-for的渲染也是需要一定时间的，在没有DOM元素时，还是无法拿到DOM元素添加动态效果。</p><p>简单来说，<strong>watch监听器只能保证我们的数据已经有了，但是不能确保v-for是否把结构渲染完毕。</strong></p><p>nextTick：在下次DOM更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取跟新后的DOM。</p><p>引入到当前情景理解：</p><ul><li>在下次DOM更新：当服务器已经返回数据并且我们组件也拿到了数据。数组由空变成了有数据。</li><li>循环结束之后：v-for结束之后。</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line">    <span class="attr">bannerList</span>: &#123;</span><br><span class="line">        <span class="title function_">handler</span>(<span class="params">newValue,oldValue</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.$nextTick(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="keyword">var</span> mySwiper = <span class="keyword">new</span> <span class="title class_">Swiper</span> (<span class="string">&#x27;.swiper&#x27;</span>, &#123;...&#125;)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>$nextTick: 可以保证页面中的结构一定是有的，经常和很多插件一起使用（因为很多插件都需要DOM存在）</p></blockquote><h3 id="bus-实现组件之间通信"><a href="#bus-实现组件之间通信" class="headerlink" title="$bus 实现组件之间通信"></a>$bus 实现组件之间通信</h3><p>项目中要实现点击删除面包屑后，搜索栏中的信息也得跟着一起删除。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main.js</span></span><br><span class="line">...</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">...</span><br><span class="line">    <span class="comment">// 全局事件总线$bus配置</span></span><br><span class="line">    <span class="title function_">beforeCreate</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$bus</span> = <span class="variable language_">this</span></span><br><span class="line">&#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// search -&gt; index.vue</span></span><br><span class="line">...</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">removeKeyword</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">searchParams</span>.<span class="property">keyword</span> = <span class="literal">undefined</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getData</span>()</span><br><span class="line">        <span class="comment">// 通知兄弟组件清除关键字</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$bus</span>.$emit(<span class="string">&#x27;clear&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// home -&gt; index.js</span></span><br><span class="line">...</span><br><span class="line"><span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 通过全局事件总线清楚关键字</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$bus</span>.$on(<span class="string">&#x27;clear&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">keyword</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Object-assign-合并参数"><a href="#Object-assign-合并参数" class="headerlink" title="Object.assign 合并参数"></a>Object.assign 合并参数</h3><p><u>如果目标对象与源对象具有相同的 key，则目标对象中的属性将被源对象中的属性覆盖，后面的源对象的属性将类似地覆盖前面的源对象的属性。</u></p><p>当用户点击分类之后再输入关键字，进行参数合并。</p><h3 id="分页器"><a href="#分页器" class="headerlink" title="分页器"></a>分页器</h3><p>先不用 element-ui 的分页器，我们自己写一个。静态页面样式这里就不写了，直接开始逻辑。</p><blockquote><p>注意：一般情况下，写代码，先用自己假的数据，功能全部完成后，再调用服务器的数据。</p></blockquote><p>分页器一般需要的数据：</p><ul><li>pageNo：当前页数</li><li>pageSize：每一页展示数据条数</li><li>total：数据总数</li><li>continues：分页连续页面个数</li></ul><p>对于分页器而言，有一个很重要的地方；要算出连续页面起始的数字和结束的数字（就中间那一坨）</p><p>components/Pagenation/index.vue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">        &lt;button :disable=&quot;pageNo == 1&quot; @click=&quot;$emit(&#x27;getPageNo&#x27;, pageNo - 1)&quot;&gt;上一页&lt;/button&gt;</span><br><span class="line">        &lt;button v-if=&quot;startNumAndEndNum.start &gt; 1&quot; @click=&quot;$emit(&#x27;getPageNo&#x27;, 1)&quot; :class=&quot;active:pageNo == 1&quot;&gt;1&lt;/button&gt;</span><br><span class="line">        &lt;button v-if=&quot;startNumAndEndNum.start &gt; 2&quot; &gt;...&lt;/button&gt;</span><br><span class="line">        </span><br><span class="line">&lt;button v-for=&quot;(page,index) in startNumAndEndNum.end&quot; :key=&quot;index&quot; v-if=&quot;page &gt;= startNumAndEndNum.start&quot; @click=&quot;$emit(&#x27;getPageNo&#x27;, page)&quot; :class=&quot;active:pageNo == page&quot;&gt;&#123;&#123;page&#125;&#125;&lt;/button&gt;</span><br><span class="line">        </span><br><span class="line">        &lt;button v-if=&quot;startNumAndEndNum.end &lt; totalPage -1&quot; &gt;...&lt;/button&gt;</span><br><span class="line">        &lt;button v-if=&quot;startNumAndEndNum.edd &lt; totalPage&quot; @click=&quot;$emit(&#x27;getPageNo&#x27;, totalPage)&quot; :class=&quot;active:pageNo == total&quot;&gt;&#123;&#123;totalPage&#125;&#125;&lt;/button&gt;</span><br><span class="line">        &lt;button :disable=&quot;pageNo == totalPage&quot; @click=&quot;$emit(&#x27;getPageNo&#x27;, pageNo + 1)&quot;&gt;下一页&lt;/button&gt;</span><br><span class="line">        &lt;button&gt;共&#123;&#123;total&#125;&#125;条&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/templte&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        name: &#x27;pagenation&#x27;,</span><br><span class="line">        // 父组件传递假数据：8，3，91，5</span><br><span class="line">        props: [&#x27;pageNo&#x27;, &#x27;pageSize&#x27;, &#x27;total&#x27;, &#x27;continues&#x27;],</span><br><span class="line">        computed: &#123;</span><br><span class="line">            // 总共多少页</span><br><span class="line">            totalPage() &#123;</span><br><span class="line">                // 向上取整</span><br><span class="line">                return Math.ceil(this.total/this.pageSize)</span><br><span class="line">            &#125;,</span><br><span class="line">            // 计算出连续的页码的起始数字和结束数字</span><br><span class="line">            startNumAndEndNum() &#123;</span><br><span class="line">                // 解构</span><br><span class="line">                const &#123;continues, pageNo, totalPage&#125; = this</span><br><span class="line">                // 先定义两个变量存储其实数字与结束数字</span><br><span class="line">                let start = 0, end = 0</span><br><span class="line">                // 不正常现象</span><br><span class="line">                // 连续页码数字是5（也就是说页面最少得有五页），但是数据就是不够五页</span><br><span class="line">                if(continues &gt; totalPage) &#123;</span><br><span class="line">                    start = 1</span><br><span class="line">                    end = totalPage</span><br><span class="line">                &#125;else &#123;</span><br><span class="line">                    // 正常现象</span><br><span class="line">                    start = pageNo - parseInt(continues/2)</span><br><span class="line">                    end = pageNo + parseInt(continues/2)</span><br><span class="line">                    // 不正常现象</span><br><span class="line">                    // 假如当前页是 1|2 那分页器是 -1 0 1 2 3 | 0 1 2 3 4 5 这不行把</span><br><span class="line">                    if(start &lt; 1) &#123;</span><br><span class="line">                        start = 1</span><br><span class="line">                        end = continues</span><br><span class="line">                    &#125;</span><br><span class="line">                    // 起始页可能不正常，那结束页也可能不正常</span><br><span class="line">                    if(end &gt; totalPage) &#123;</span><br><span class="line">                        end = totalPage</span><br><span class="line">                        start = totalPage - continues + 1</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">                return &#123;start, end&#125;</span><br><span class="line">            &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;    </span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">...</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p>Search/index.vue</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">...</span><br><span class="line">&lt;Pagenation :pageNo=&quot;searchParams.pageNo&quot; :pageSize=&quot;searchParams.pageSize&quot; :total=&quot;total&quot; :continues=:&quot;5&quot; @getPageNo=&quot;getPageNo&quot;/&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">import &#123;mapState&#125; from &#x27;vuex&#x27;</span><br><span class="line">...</span><br><span class="line">export default &#123;</span><br><span class="line">...</span><br><span class="line">    computed: &#123;</span><br><span class="line">        ...mapState(&#123;</span><br><span class="line">            total: state =&gt; state.search.searchList.total</span><br><span class="line">        &#125;),</span><br><span class="line">        ...</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">        ...</span><br><span class="line">        getPageNo(pageNo) &#123;</span><br><span class="line">      // 整理带给服务器的请求</span><br><span class="line">            this.searchParams.pageNo = pageNo</span><br><span class="line">            // 再次发起请求</span><br><span class="line">            this.getDate()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="路由懒加载"><a href="#路由懒加载" class="headerlink" title="路由懒加载"></a>路由懒加载</h3><p>在 router/routes.js 中我们都是一股脑的引入组件。这样当打包构建应用时，JavaScript包会变得非常大，影响页面加载。如果我们能把不同路由对应的组件分割成不同的代码块，然后当路由访问的时候才加载对应的组件，这样就更高效了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;@/views/Home&#x27;</span></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">       <span class="attr">component</span>: <span class="title class_">Home</span></span><br><span class="line">&#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>改进为路由懒加载</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Foo</span> = (<span class="params"></span>) =&gt; &#123;<span class="keyword">return</span> <span class="title function_">import</span>(<span class="string">&#x27;@/views/Home&#x27;</span>)&#125;</span><br><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">Foo</span></span><br><span class="line">&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure><p>简写形式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> [</span><br><span class="line">&#123;</span><br><span class="line"><span class="attr">path</span>: <span class="string">&#x27;/home&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="function">() =&gt;</span> <span class="title function_">import</span>(<span class="string">&#x27;@/views/Home&#x27;</span>)</span><br><span class="line">&#125;,</span><br><span class="line">    ...</span><br><span class="line">]</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>Html、Css、Js 实现简单的登陆页面主题切换</title>
      <link href="/2022/10/27/%E7%AE%80%E5%8D%95%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2/"/>
      <url>/2022/10/27/%E7%AE%80%E5%8D%95%E4%B8%BB%E9%A2%98%E5%88%87%E6%8D%A2/</url>
      
        <content type="html"><![CDATA[<h3 id="Html、Css、Js-实现简单的登陆页面主题切换"><a href="#Html、Css、Js-实现简单的登陆页面主题切换" class="headerlink" title="Html、Css、Js 实现简单的登陆页面主题切换"></a>Html、Css、Js 实现简单的登陆页面主题切换</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;login&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span> <span class="attr">id</span>=<span class="string">&quot;text&quot;</span>&gt;</span>Login<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;用户名&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;密码&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">value</span>=<span class="string">&quot;登陆&quot;</span> <span class="attr">id</span>=<span class="string">&quot;btn&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;group&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>忘记密码<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;colors&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;active&quot;</span> <span class="attr">style</span>=<span class="string">&quot;--clr:#1dd1a1;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeColor(&#x27;#1dd1a1&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;--clr:#ff6b6b;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeColor(&#x27;#ff6b6b&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;--clr:#2386de;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeColor(&#x27;#2386de&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;--clr:#f368e0;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeColor(&#x27;#f368e0&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;--clr:#ff9f43;&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;changeColor(&#x27;#ff9f43&#x27;)&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> text = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;text&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// let text = document.getElementsByClassName(&#x27;text&#x27;)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">changeColor</span>(<span class="params">color</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = color</span></span><br><span class="line"><span class="language-javascript">    btn.<span class="property">style</span>.<span class="property">backgroundColor</span> = color</span></span><br><span class="line"><span class="language-javascript">    text.<span class="property">style</span>.<span class="property">borderColor</span> = color</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;span&#x27;</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      item.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">    event.<span class="property">target</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">* &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#1dd1a1</span>;</span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">25px</span> <span class="number">25px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.input</span> <span class="selector-tag">input</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">20px</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.login</span> <span class="selector-id">#text</span> &#123;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">15px</span> solid <span class="number">#1dd1a1</span>;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.input</span> <span class="selector-tag">input</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">outline</span>: none;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1em</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#555</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.input</span> <span class="selector-id">#btn</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#1dd1a1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.group</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.group</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">text-decoration</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span> <span class="selector-class">.group</span> <span class="selector-tag">a</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: underline;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.colors</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.colors</span> <span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">width</span>:<span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--clr);</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.colors</span> <span class="selector-class">.active</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">2px</span> solid <span class="number">#333</span>;</span><br><span class="line">  scale: <span class="number">1.5</span>;</span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">5s</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.loli.net/2022/10/27/6gforWCOtsTKGAd.png" alt="image-20221027215159464.png"></p><p><strong>在中途发现。通过<code>document.getDocumentByClassName()</code>拿到的元素，无法<code>.style.borderColor</code>拿到修改的 <code>border-color</code> 属性，控制台会输出 <code>borderColor id undefined</code> 只有通过 <code>document.getDocumentById()</code> 才能修改</strong></p><p>通过上网搜索发现：</p><p>getElementsByClassName与ID获取的不一样，打印getElementsByClassName得到的是一个HTMLCollection，要用<code>getElementsByClassName(“content”)[0]</code>的形式。</p>]]></content>
      
      
      
        <tags>
            
            <tag> 小Demo </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>面试题-前端基础篇</title>
      <link href="/2022/10/27/%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%AF%87/"/>
      <url>/2022/10/27/%E9%9D%A2%E8%AF%95%E9%A2%98-%E5%89%8D%E7%AB%AF%E5%9F%BA%E7%A1%80%E7%AF%87/</url>
      
        <content type="html"><![CDATA[<h2 id="HTML"><a href="#HTML" class="headerlink" title="HTML"></a>HTML</h2><h3 id="网站开发中，如何实现图片的懒加载"><a href="#网站开发中，如何实现图片的懒加载" class="headerlink" title="网站开发中，如何实现图片的懒加载"></a>网站开发中，如何实现图片的懒加载</h3><p>懒加载，顾名思义，在当前网页，滑动页面到能看到图片的时候再加载图片</p><p>故问题拆分成两个：</p><ol><li>如何判断图片出现在了当前视口 （即如何判断我们能够看到图片）</li><li>如何控制图片的加载</li></ol><h4 id="方案一-位置计算-滚动事件-Scroll-DataSet-API"><a href="#方案一-位置计算-滚动事件-Scroll-DataSet-API" class="headerlink" title="方案一: 位置计算 + 滚动事件 (Scroll) + DataSet API"></a>方案一: 位置计算 + 滚动事件 (Scroll) + DataSet API</h4><p><strong>如何判断图片出现在了当前视口</strong></p><p><code>clientTop</code>，<code>offsetTop</code>，<code>clientHeight</code> 以及 <code>scrollTop</code> 各种关于图片的高度作比对</p><p>这些高度都代表了什么意思？</p><p>这我以前有可能是知道的，那时候我比较单纯，喜欢死磕。我现在想通了，背不过的东西就不要背了</p><p><u>所以它有一个问题：复杂琐碎不好理解！</u></p><p>仅仅知道它静态的高度还不够，我们还需要知道动态的</p><p><u>如何动态？监听 <code>window.scroll</code> 事件</u></p><p><strong>如何控制图片的加载</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;shanyue.jpg&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>首先设置一个临时 Data 属性 <code>data-src</code>，控制加载时使用 <code>src</code> 代替 <code>data-src</code>，可利用 DataSet API 实现</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">img.src = img.datset.src</span><br></pre></td></tr></table></figure><h4 id="方案二-getBoundingClientRect-API-Scroll-with-Throttle-DataSet-API"><a href="#方案二-getBoundingClientRect-API-Scroll-with-Throttle-DataSet-API" class="headerlink" title="方案二: getBoundingClientRect API + Scroll with Throttle + DataSet API"></a>方案二: getBoundingClientRect API + Scroll with Throttle + DataSet API</h4><p>改进一下</p><p><strong>如何判断图片出现在了当前视口</strong></p><p>引入一个新的 API， <strong><code>Element.getBoundingClientRect()</code> 方法返回元素的大小及其相对于视口的位置。</strong></p><p>那如何判断图片出现在了当前视口呢，代码如下，这个就比较好理解了。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// clientHeight 代表当前视口的高度</span></span><br><span class="line">img.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span> &lt; <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br></pre></td></tr></table></figure><p><strong>监听 <code>window.scroll</code> 事件也优化一下</strong></p><p>加个节流器，提高性能。工作中一般使用 <code>lodash.throttle</code> 就可以了，万能的 <code>lodash</code> 啊！</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_.<span class="title function_">throttle</span>(func, [(wait = <span class="number">0</span>)], [(options = &#123;&#125;)]);</span><br></pre></td></tr></table></figure><h4 id="方案三-IntersectionObserver-API-DataSet-API"><a href="#方案三-IntersectionObserver-API-DataSet-API" class="headerlink" title="方案三: IntersectionObserver API + DataSet API"></a>方案三: IntersectionObserver API + DataSet API</h4><p>再改进一下</p><p><strong>如何判断图片出现在了当前视口</strong></p><p><strong>方案二使用的方法是: <code>window.scroll</code> 监听 <code>Element.getBoundingClientRect()</code> 并使用 <code>_.throttle</code> 节流</strong></p><p><strong>一系列组合动作太复杂了，于是浏览器出了一个三合一事件: <code>IntersectionObserver</code> API，一个能够监听元素是否到了当前视口的事件，一步到位！</strong></p><p>事件回调的参数是 IntersectionObserverEntry (opens new window) 的集合，代表关于是否在可见视口的一系列值</p><p>其中，<code>entry.isIntersecting</code> 代表目标元素可见</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function">(<span class="params">changes</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// changes: 目标元素集合</span></span><br><span class="line">  changes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">change</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// intersectionRatio</span></span><br><span class="line">    <span class="keyword">if</span> (change.<span class="property">isIntersecting</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> img = change.<span class="property">target</span>;</span><br><span class="line">      img.<span class="property">src</span> = img.<span class="property">dataset</span>.<span class="property">src</span>;</span><br><span class="line">      observer.<span class="title function_">unobserve</span>(img);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">observer.<span class="title function_">observe</span>(img);</span><br></pre></td></tr></table></figure><p><strong>当然，<code>IntersectionObserver</code> 除了给图片做懒加载外，还可以对单页应用资源做预加载。</strong></p><h4 id="方案四-LazyLoading-属性"><a href="#方案四-LazyLoading-属性" class="headerlink" title="方案四: LazyLoading 属性"></a>方案四: LazyLoading 属性</h4><p>浏览器觉得懒加载这事可以交给自己做，你们开发者加个属性就好了。实在是…！</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;shanyue.jpg&quot;</span> <span class="attr">loading</span>=<span class="string">&quot;lazy&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><p>不过目前浏览器兼容性不太好。</p><p><strong>方案二的简单Demo</strong> :</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>图片懒加载<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2021/08/24/15/38/sand-6570980_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/02/21/19/06/drink-84533_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2014/12/15/17/16/boardwalk-569314_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/07/18/20/26/sea-164989_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2017/03/26/21/54/yoga-2176668_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;6&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">      <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2015/03/17/14/05/sparkler-677774_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">alt</span>=<span class="string">&quot;7&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.bootcdn.net/ajax/libs/lodash.js/4.17.20/lodash.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> images = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;img&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> <span class="title function_">lazyLoad</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">        images.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 触发条件为img元素的CSSOM对象到视口顶部的距离 &lt; 100px + 视口高度，+100px为了提前触发图片加载</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (</span></span><br><span class="line"><span class="language-javascript">            item.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span> &lt;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span> + <span class="number">100</span></span></span><br><span class="line"><span class="language-javascript">          ) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (<span class="string">&quot;src&quot;</span> <span class="keyword">in</span> item.<span class="property">dataset</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              item.<span class="property">src</span> = item.<span class="property">dataset</span>.<span class="property">src</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, _.<span class="title function_">throttle</span>(lazyLoad, <span class="number">200</span>));</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方案一的实现</strong>，ScrollListener 类用于监听和处理滚动，在 Controller（实现 onEnterViewport 方法）元素出现在视窗内时调用 controller.onEnterViewport()，最后移除 controller。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;zh-CN&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;ie=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>offsetTop计算实现图片懒加载<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">object-fit</span>: cover;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">object-position</span>: center;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">10px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: inline-block;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">480px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">270px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100vw</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">overflow</span>: auto;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-class">.main</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">2000px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>请滚动页面查看效果<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;main&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span>&gt;</span><span class="language-javascript"><span class="meta"></span></span></span><br><span class="line"><span class="meta"><span class="language-javascript">    &quot;use strict&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 图片url列表</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> images = [</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/Latern2022_ZH-CN0112710917_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/MaldivesHeart_ZH-CN0032539727_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/FaceOff_ZH-CN9969100257_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/DarwinsArch_ZH-CN9740478501_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/TeaGardensMunnar_ZH-CN9587720369_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/SnowyBern_ZH-CN5472524801_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/SevenSistersCliffs_ZH-CN5362127173_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/SpeloncatoSnow_ZH-CN8115437163_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/WinterludeIce_ZH-CN7868524911_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/Oymyakon_ZH-CN7758768574_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/MexicoMonarchs_ZH-CN7526758236_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;https://h2.ioliu.cn/bing/WinterOlymics_ZH-CN7384614076_640x480.jpg?imageslim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;233&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    ];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 未加载时默认url</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> defaultUrl =</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;data:image/svg+xml;base64,PHN2ZyB0PSIxNjQ0ODk5MzI0NDgwIiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjIwOTMiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNODc0LjEgODEzLjc1SDE0OS45Yy0yMi4yMiAwLTQwLjIzLTE4LjAxLTQwLjIzLTQwLjIzVjI1MC40OWMwLTIyLjIyIDE4LjAxLTQwLjIzIDQwLjIzLTQwLjIzaDcyNC4yYzIyLjIyIDAgNDAuMjMgMTguMDEgNDAuMjMgNDAuMjN2NTIzLjAzYzAgMjIuMjEtMTguMDIgNDAuMjMtNDAuMjMgNDAuMjN6TTI4MC42NiAzMTAuODRjLTM4Ljg5IDAtNzAuNDEgMzEuNTItNzAuNDEgNzAuNDFzMzEuNTIgNzAuNDEgNzAuNDEgNzAuNDEgNzAuNDEtMzEuNTIgNzAuNDEtNzAuNDEtMzEuNTItNzAuNDEtNzAuNDEtNzAuNDF6IG01MTIuOTcgMTAwLjU4YzAtMjIuMjItMTguMDEtNDAuMjMtNDAuMjMtNDAuMjNoLTQwLjIzYy02Ni42NiAwLTEyMC43IDU0LjA0LTEyMC43IDEyMC43djQwLjIzYzAgMzMuMzMtMjcuMDIgNjAuMzUtNjAuMzUgNjAuMzUtMTguMjkgMC0zNC40Ny04LjMxLTQ1LjU0LTIxLjE1LTAuMDUtMC4wNi0wLjI1LTAuMjgtMC4yOS0wLjMzLTIyLjA5LTI0LjA1LTU5Ljc3LTM4Ljg2LTk0Ljk4LTM4Ljg2LTAuNDQgMC0wLjg0IDAuMTItMS4yOCAwLjEzbC0wLjA2LTAuMDZjLTg4LjI2IDAuNzMtMTU5LjU5IDcyLjQ0LTE1OS41OSAxNjAuODYgMCAyMi4yMiAxOC4wMSA0MC4yMyA0MC4yMyA0MC4yM0g3NTMuNGMyMi4yMiAwIDQwLjIzLTE4LjAxIDQwLjIzLTQwLjIzVjQxMS40MnoiIHAtaWQ9IjIwOTQiIGZpbGw9IiNjZGNkY2QiPjwvcGF0aD48L3N2Zz4=&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 加载错误时代替</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> errorUrl =</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;data:image/svg+xml;base64,PHN2ZyB0PSIxNjQ0ODk5ODEzMDQ1IiBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHAtaWQ9IjQ0OTEiIHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIj48cGF0aCBkPSJNNjQuMzgzMjM0IDUxMkM2NC4zODMyMzQgMjY0Ljc4NzgyOSAyNjQuNzg3ODI5IDY0LjM4MzIzNCA1MTIgNjQuMzgzMjM0IDc1OS4yMTIxNzEgNjQuMzgzMjM0IDk1OS42MTY3NjYgMjY0Ljc4NzgyOSA5NTkuNjE2NzY2IDUxMiA5NTkuNjE2NzY2IDc1OS4yMTIxNzEgNzU5LjIxMjE3MSA5NTkuNjE2NzY2IDUxMiA5NTkuNjE2NzY2IDI2NC43ODc4MjkgOTU5LjYxNjc2NiA2NC4zODMyMzQgNzU5LjIxMjE3MSA2NC4zODMyMzQgNTEyWk00NzQuMjMyMzc5IDc3MS4yNDUxMjRDNDc2LjQwODcxOCA3OTcuMzU1NTEyIDQ5MC41NTEzNzIgODEwLjQxMjEyMyA1MTYuNjYzMTc2IDgxMC40MTIxMjMgNTQyLjc3MzU2NCA4MTAuNDEyMTIzIDU1Ni45MTc2MzUgNzk3LjM1NTUxMiA1NTkuMDkyNTU2IDc3MS4yNDUxMjQgNTU2LjkxNzYzNSA3NDUuMTMzMzE5IDU0Mi43NzM1NjQgNzMwLjk5MDY2NiA1MTYuNjYzMTc2IDcyOC44MTQzMjcgNDkwLjU1MTM3MiA3MzAuOTkwNjY2IDQ3Ni40MDg3MTggNzQ1LjEzMzMxOSA0NzQuMjMyMzc5IDc3MS4yNDUxMjRaTTQ4MC43NTk5NzcgNjExLjMxNDc0OEM0ODAuNzU5OTc3IDYzNy40MjY1NTQgNDkyLjcyNzcxIDY1MC40ODE3NDcgNTE2LjY2MzE3NiA2NTAuNDgxNzQ3IDU0MC41OTcyMjYgNjUwLjQ4MTc0NyA1NTIuNTY0OTYgNjM3LjQyNjU1NCA1NTIuNTY0OTYgNjExLjMxNDc0OEw1NTIuNTY0OTYgMjQ5LjAyNDYxOEM1NTIuNTY0OTYgMjIyLjkxNDIzMSA1NDAuNTk3MjI2IDIwOS44NTc2MTkgNTE2LjY2MzE3NiAyMDkuODU3NjE5IDQ5Mi43Mjc3MSAyMDkuODU3NjE5IDQ4MC43NTk5NzcgMjIyLjkxNDIzMSA0ODAuNzU5OTc3IDI0OS4wMjQ2MThMNDgwLjc1OTk3NyA2MTEuMzE0NzQ4WiIgcC1pZD0iNDQ5MiIgZmlsbD0iI2NkY2RjZCI+PC9wYXRoPjwvc3ZnPg==&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 滚动监听和防抖</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">ScrollListener</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      entries = [];</span></span><br><span class="line"><span class="language-javascript">      taskId = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">constructor</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, <span class="variable language_">this</span>.<span class="property">scrollDebounce</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>), &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">capture</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">passive</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">isInViewport</span>(<span class="params">controller</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> offsetTop = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          offsetLeft = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          el = controller.<span class="property">el</span>,</span></span><br><span class="line"><span class="language-javascript">          scrollTop = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          scrollLeft = <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          html = <span class="variable language_">document</span>.<span class="property">documentElement</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">while</span> (el &amp;&amp; el !== html) &#123;</span></span><br><span class="line"><span class="language-javascript">          offsetTop = offsetTop + el.<span class="property">offsetTop</span>;</span></span><br><span class="line"><span class="language-javascript">          offsetLeft = offsetLeft + el.<span class="property">offsetLeft</span>;</span></span><br><span class="line"><span class="language-javascript">          el = el.<span class="property">offsetParent</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        el = controller.<span class="property">el</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">while</span> (el) &#123;</span></span><br><span class="line"><span class="language-javascript">          scrollTop += el.<span class="property">scrollTop</span>;</span></span><br><span class="line"><span class="language-javascript">          scrollLeft += el.<span class="property">scrollLeft</span>;</span></span><br><span class="line"><span class="language-javascript">          el = el.<span class="property">parentElement</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        offsetTop -= scrollTop;</span></span><br><span class="line"><span class="language-javascript">        offsetLeft -= scrollLeft;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        el = controller.<span class="property">el</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> (</span></span><br><span class="line"><span class="language-javascript">          offsetTop &lt; html.<span class="property">scrollTop</span> + innerHeight &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">          offsetTop + el.<span class="property">clientHeight</span> &gt; html.<span class="property">scrollTop</span> &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">          offsetLeft &lt; html.<span class="property">scrollLeft</span> + innerWidth &amp;&amp;</span></span><br><span class="line"><span class="language-javascript">          offsetLeft + el.<span class="property">clientWidth</span> &gt; html.<span class="property">scrollLeft</span></span></span><br><span class="line"><span class="language-javascript">        );</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">scrollDebounce</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">taskId</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="built_in">clearTimeout</span>(<span class="variable language_">this</span>.<span class="property">taskId</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">taskId</span> = <span class="built_in">setTimeout</span>(<span class="variable language_">this</span>.<span class="property">handleScroll</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>), <span class="number">200</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">addController</span>(<span class="params">controller</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">entries</span>.<span class="title function_">push</span>(controller);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">scrollDebounce</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">handleScroll</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">entries</span> = <span class="variable language_">this</span>.<span class="property">entries</span>.<span class="title function_">filter</span>(<span class="function">(<span class="params">controller</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> !controller.<span class="property">blob</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">entries</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">controller</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="title function_">isInViewport</span>(controller)) &#123;</span></span><br><span class="line"><span class="language-javascript">            controller.<span class="title function_">onEnterViewport</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 图片控制对象</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">ImageController</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      img = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      blob = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      el = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      wrap = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">constructor</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="language-javascript">        url = <span class="string">&quot;&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">        parent = <span class="variable language_">document</span>.body,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">        className = <span class="string">&quot;wrap&quot;</span>,</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">        el = <span class="variable language_">document</span>.createElement(<span class="string">&quot;img&quot;</span>)</span></span></span><br><span class="line"><span class="params"><span class="language-javascript">      </span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        el.<span class="property">src</span> = defaultUrl;</span></span><br><span class="line"><span class="language-javascript">        el.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;img&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">el</span> = el;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">img</span> = url;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wrap</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wrap</span>.<span class="property">classList</span>.<span class="title function_">add</span>(className);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">wrap</span>.<span class="title function_">append</span>(el);</span></span><br><span class="line"><span class="language-javascript">        parent.<span class="title function_">append</span>(<span class="variable language_">this</span>.<span class="property">wrap</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">showImage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> target = <span class="variable language_">this</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">fetchImage</span>().<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          target.<span class="property">el</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">blob</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">showLoading</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">el</span>.<span class="property">src</span> = defaultUrl;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">showError</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="property">el</span>.<span class="property">src</span> = errorUrl;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">onEnterViewport</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">this</span>.<span class="title function_">showImage</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">async</span> <span class="title function_">fetchImage</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (<span class="keyword">typeof</span> fetch !== <span class="string">&quot;function&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">this</span>.<span class="title function_">thowError</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;浏览器不支持fetch接口&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 如果已经加载过，直接返回</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!<span class="variable language_">this</span>.<span class="property">blob</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">const</span> target = <span class="variable language_">this</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="title function_">fetch</span>(<span class="variable language_">this</span>.<span class="property">img</span>)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (res.<span class="property">status</span> &gt; <span class="number">199</span> &amp;&amp; res.<span class="property">status</span> &lt; <span class="number">300</span>) <span class="keyword">return</span> res.<span class="title function_">blob</span>();</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">else</span> <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="function">(<span class="params">blob</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">if</span> (<span class="regexp">/image/</span>.<span class="title function_">test</span>(blob.<span class="property">type</span>)) <span class="keyword">return</span> <span class="variable constant_">URL</span>.<span class="title function_">createObjectURL</span>(blob);</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">else</span> <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">then</span>(<span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              target.<span class="property">blob</span> = url;</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">            .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              target.<span class="title function_">showError</span>();</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;URL不正确或MIME类型不正确&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> scrollListener = <span class="keyword">new</span> <span class="title class_">ScrollListener</span>(),</span></span><br><span class="line"><span class="language-javascript">      main = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;main&quot;</span>)[<span class="number">0</span>],</span></span><br><span class="line"><span class="language-javascript">      imageControllers = images.<span class="title function_">map</span>(<span class="function">(<span class="params">url</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> controller = <span class="keyword">new</span> <span class="title class_">ImageController</span>(url, main);</span></span><br><span class="line"><span class="language-javascript">        scrollListener.<span class="title function_">addController</span>(controller);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方案二有那么一点点抖动，这里重新实现了一下</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;demo&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2021/08/24/15/38/sand-6570980_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/02/21/19/06/drink-84533_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;2&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/07/18/20/26/sea-164989_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;4&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">img</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2017/03/26/21/54/yoga-2176668_960_720.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">alt</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> demo = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;img&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">lazy</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">for</span> (<span class="keyword">let</span> elem <span class="keyword">of</span> demo) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (</span></span><br><span class="line"><span class="language-javascript">          elem.<span class="title function_">getBoundingClientRect</span>().<span class="property">top</span> &lt;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span></span></span><br><span class="line"><span class="language-javascript">        ) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (elem.<span class="property">dataset</span>.<span class="property">src</span> &amp;&amp; elem.<span class="property">src</span> == <span class="string">&quot;&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            elem.<span class="property">src</span> = elem.<span class="property">dataset</span>.<span class="property">src</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">t, fn</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> time;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!time) &#123;</span></span><br><span class="line"><span class="language-javascript">          time = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            time = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">fn</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;, t);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">lazy</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, <span class="title function_">throttle</span>(<span class="number">500</span>, lazy));</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>方法三的简单 demo</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>3.IntersectionObserver API + DataSet API<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      * &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">body</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">margin</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">padding</span>: <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">      <span class="selector-tag">img</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">      &#125;</span></span><br><span class="line"><span class="language-css">    </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2021/08/24/15/38/sand-6570980_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/02/21/19/06/drink-84533_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2014/12/15/17/16/boardwalk-569314_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2013/07/18/20/26/sea-164989_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2015/04/23/22/00/tree-736885_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;5&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2017/03/26/21/54/yoga-2176668_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;6&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">data-src</span>=<span class="string">&quot;https://cdn.pixabay.com/photo/2015/03/17/14/05/sparkler-677774_960_720.jpg&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;7&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> images = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;img&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 新的 api  IntersectionObserver</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> observer = <span class="keyword">new</span> <span class="title class_">IntersectionObserver</span>(<span class="function">(<span class="params">changes</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        changes.<span class="title function_">forEach</span>(<span class="function"><span class="params">change</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (change.<span class="property">isIntersecting</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> img = change.<span class="property">target</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// if (img.dataset.src &amp;&amp; img.src == &quot;&quot;) &#123;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//   img.src = img.dataset.src</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// &#125;</span></span></span><br><span class="line"><span class="language-javascript">            img.<span class="property">dataset</span>.<span class="property">src</span> &amp;&amp; img.<span class="property">src</span> == <span class="string">&quot;&quot;</span> &amp;&amp; (img.<span class="property">src</span> = img.<span class="property">dataset</span>.<span class="property">src</span>)</span></span><br><span class="line"><span class="language-javascript">            observer.<span class="title function_">unobserve</span>(img)</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      images.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> observer.<span class="title function_">observe</span>(img))</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="浏览器中如何实现剪切板复制内容的功能"><a href="#浏览器中如何实现剪切板复制内容的功能" class="headerlink" title="浏览器中如何实现剪切板复制内容的功能"></a>浏览器中如何实现剪切板复制内容的功能</h3><p>它一般可以使用第三方库 <a href="https://github.com/feross/clipboard-copy/blob/master/index.js">clipboard-copy (opens new window)</a>来实现，源码很简单，可以读一读</p><p>目前最为推荐的方式是使用 <code>Clipboard API</code> 进行实现</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">navigator.<span class="property">clipboard</span>.<span class="title function_">writeText</span>(text);</span><br></pre></td></tr></table></figure><p>而对于一些不支持 <code>Clipboard API</code> 的浏览器，使用以下 API 进行复制</p><ol><li>选中: <code>Selection API</code></li><li>复制: <code>document.execCommand</code> (已被废弃)</li></ol><h4 id="选中-Selection-API-Range-API"><a href="#选中-Selection-API-Range-API" class="headerlink" title="选中: Selection API/Range API"></a>选中: Selection API/Range API</h4><p>选中主要利用了 <a href="https://developer.mozilla.org/en-US/docs/Web/API/Selection">Selection API (opens new window)</a>与 Range API</p><p>选中的代码如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> selection = <span class="variable language_">window</span>.<span class="title function_">getSelection</span>();</span><br><span class="line"><span class="keyword">const</span> range = <span class="variable language_">document</span>.<span class="title function_">createRange</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// RangeAPI: 制造区域</span></span><br><span class="line">range.<span class="title function_">selectNodeContents</span>(element);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Selection: 选中区域</span></span><br><span class="line">selection.<span class="title function_">addRange</span>(range);</span><br><span class="line"></span><br><span class="line">selectedText = selection.<span class="title function_">toString</span>();</span><br></pre></td></tr></table></figure><p>取消选中的代码如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="title function_">getSelection</span>().<span class="title function_">removeAllRanges</span>();</span><br></pre></td></tr></table></figure><p>它有现成的第三方库可以使用: <a href="https://github.com/zenorocha/select">select.js(opens new window)</a></p><h4 id="复制-execCommand"><a href="#复制-execCommand" class="headerlink" title="复制: execCommand"></a>复制: execCommand</h4><p>复制就比较简单了，<code>execCommand</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">execCommand</span>(<span class="string">&quot;copy&quot;</span>);</span><br></pre></td></tr></table></figure><h3 id="什么是-CSRF-攻击"><a href="#什么是-CSRF-攻击" class="headerlink" title="什么是 CSRF 攻击"></a>什么是 CSRF 攻击</h3><p>跨站请求伪造（英语：Cross-site request forgery），也被称为 one-click attack 或者 session riding，通常缩写为 CSRF 或者 XSRF， 是一种挟制用户在当前已登录的 Web 应用程序上执行非本意的操作的攻击方法。跟跨网站脚本（XSS）相比，XSS 利用的是用户对指定网站的信任，CSRF 利用的是网站对用户网页浏览器的信任。</p><p>CSRF (Cross-site request forgery)，跨站请求伪造，又称为 <code>one-click attack</code>，顾名思义，通过恶意引导用户一次点击劫持 cookie 进行攻击。</p><ol><li>使用 JSON API。当进行 CSRF 攻击时，请求体通过 <code>&lt;form&gt;</code> 构建，请求头为 <code>application/www-form-urlencoded</code>。它难以发送 JSON 数据被服务器所理解。</li><li>CSRF Token。生成一个随机的 token，切勿放在 cookie 中，每次请求手动携带该 token 进行校验。</li><li>SameSite Cookie。设置为 Lax 或者 Strict，禁止发送第三方 Cookie。</li></ol><h3 id="在浏览器中如何监听剪切板中内容"><a href="#在浏览器中如何监听剪切板中内容" class="headerlink" title="在浏览器中如何监听剪切板中内容"></a>在浏览器中如何监听剪切板中内容</h3><p>通过 <code>Clipboard API</code> 可以获取剪切板中内容，但需要获取到 <code>clipboard-read</code> 的权限，以下是关于读取剪贴板内容的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否能够有读取剪贴板的权限</span></span><br><span class="line"><span class="comment">// result.state == &quot;granted&quot; || result.state == &quot;prompt&quot;</span></span><br><span class="line"><span class="keyword">const</span> result = <span class="keyword">await</span> navigator.<span class="property">permissions</span>.<span class="title function_">query</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;clipboard-read&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取剪贴板内容</span></span><br><span class="line"><span class="keyword">const</span> text = <span class="keyword">await</span> navigator.<span class="property">clipboard</span>.<span class="title function_">readText</span>();</span><br></pre></td></tr></table></figure><blockquote><p>注: 该方法在 <code>devtools</code> 中不生效</p></blockquote><h3 id="什么是重排重绘，如何减少重拍重绘"><a href="#什么是重排重绘，如何减少重拍重绘" class="headerlink" title="什么是重排重绘，如何减少重拍重绘"></a>什么是重排重绘，如何减少重拍重绘</h3><p>重排和重绘是关键渲染路径中的两步。</p><ul><li>重排(Reflow)：元素的位置发生变动时发生重排，也叫回流。此时在关键渲染路径中的 Layout 阶段，计算每一个元素在设备视口内的确切位置和大小。当一个元素位置发生变化时，其父元素及其后边的元素位置都可能发生变化，代价极高 <img src="https://q.shanyue.tech/assets/layout.png" alt="img"></li><li>重绘(Repaint): 元素的样式发生变动，但是位置没有改变。此时在关键渲染路径中的 Paint 阶段，将渲染树中的每个节点转换成屏幕上的实际像素，这一步通常称为绘制或栅格化 <img src="https://q.shanyue.tech/assets/paint.png" alt="img"></li></ul><p>另外，重排必定会造成重绘。以下是避免过多重拍重绘的方法</p><ol><li>使用 <code>DocumentFragment</code> 进行 DOM 操作，不过现在原生操作很少也基本上用不到</li><li>CSS 样式尽量批量修改</li><li>避免使用 table 布局</li><li>为元素提前设置好高宽，不因多次渲染改变位置</li></ol><h3 id="HTML-中的-input-标签有哪些-type"><a href="#HTML-中的-input-标签有哪些-type" class="headerlink" title="HTML 中的 input 标签有哪些 type"></a>HTML 中的 input 标签有哪些 type</h3><h4 id="button"><a href="#button" class="headerlink" title="button"></a>button</h4><p>没有默认行为的按钮，上面显示 value 属性的值，默认为空。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">name</span>=<span class="string">&quot;button&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="checkbox"><a href="#checkbox" class="headerlink" title="checkbox"></a>checkbox</h4><p>复选框，可设为选中或未选中。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">name</span>=<span class="string">&quot;checkbox&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="color"><a href="#color" class="headerlink" title="color"></a>color</h4><p>用于指定颜色的控件；在支持的浏览器中，激活时会打开取色器。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;color&quot;</span> <span class="attr">name</span>=<span class="string">&quot;color&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="date"><a href="#date" class="headerlink" title="date"></a>date</h4><p>输入日期的控件（年、月、日，不包括时间）。在支持的浏览器激活时打开日期选择器或年月日的数字滚轮。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;date&quot;</span> <span class="attr">name</span>=<span class="string">&quot;date&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="datetime-local"><a href="#datetime-local" class="headerlink" title="datetime-local"></a>datetime-local</h4><p>输入日期和时间的控件，不包括时区。在支持的浏览器激活时打开日期选择器或年月日的数字滚轮。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;datetime-local&quot;</span> <span class="attr">name</span>=<span class="string">&quot;datetime-local&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="email"><a href="#email" class="headerlink" title="email"></a>email</h4><p>编辑邮箱地址的区域。类似  text 输入，但在支持的浏览器和带有动态键盘的设备上会有确认参数和相应的键盘。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;email&quot;</span> <span class="attr">name</span>=<span class="string">&quot;email&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="file"><a href="#file" class="headerlink" title="file"></a>file</h4><p>让用户选择文件的控件。使用 accept 属性规定控件能选择的文件类型。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">accept</span>=<span class="string">&quot;image/*, text/*&quot;</span> <span class="attr">name</span>=<span class="string">&quot;file&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="hidden"><a href="#hidden" class="headerlink" title="hidden"></a>hidden</h4><p>不显示的控件，其值仍会提交到服务器。</p><h4 id="image"><a href="#image" class="headerlink" title="image"></a>image</h4><p>带图像的  submit 按钮。显示的图像由 src 属性规定。如果 src 缺失，alt 属性就会显示。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;image&quot;</span> <span class="attr">name</span>=<span class="string">&quot;image&quot;</span> <span class="attr">src</span>=<span class="string">&quot;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;image input&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="month"><a href="#month" class="headerlink" title="month"></a>month</h4><p>输入年和月的控件，没有时区。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;month&quot;</span> <span class="attr">name</span>=<span class="string">&quot;month&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="number"><a href="#number" class="headerlink" title="number"></a>number</h4><p>用于输入数字的控件。如果支持的话，会显示滚动按钮并提供缺省验证（即只能输入数字）。拥有动态键盘的设备上会显示数字键盘。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">name</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="password"><a href="#password" class="headerlink" title="password"></a>password</h4><p>单行的文本区域，其值会被遮盖。如果站点不安全，会警告用户。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;password&quot;</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="radio"><a href="#radio" class="headerlink" title="radio"></a>radio</h4><p>单选按钮，允许在多个拥有相同 name 值的选项中选中其中一个。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;radio&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="range"><a href="#range" class="headerlink" title="range"></a>range</h4><p>此控件用于输入不需要精确的数字。控件是一个范围组件，默认值为正中间的值。同时使用 htmlattrdefmin  和 htmlattrdefmax 来规定值的范围。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;range&quot;</span> <span class="attr">name</span>=<span class="string">&quot;range&quot;</span> <span class="attr">min</span>=<span class="string">&quot;0&quot;</span> <span class="attr">max</span>=<span class="string">&quot;25&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="reset"><a href="#reset" class="headerlink" title="reset"></a>reset</h4><p>此按钮将表单的所有内容重置为默认值。不推荐。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;reset&quot;</span> <span class="attr">name</span>=<span class="string">&quot;reset&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="search"><a href="#search" class="headerlink" title="search"></a>search</h4><p>用于搜索字符串的单行文字区域。输入文本中的换行会被自动去除。在支持的浏览器中可能有一个删除按钮，用于清除整个区域。拥有动态键盘的设备上的回车图标会变成搜索图标。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;search&quot;</span> <span class="attr">name</span>=<span class="string">&quot;search&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="submit"><a href="#submit" class="headerlink" title="submit"></a>submit</h4><p>用于提交表单的按钮。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">name</span>=<span class="string">&quot;submit&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="tel"><a href="#tel" class="headerlink" title="tel"></a>tel</h4><p>用于输入电话号码的控件。拥有动态键盘的设备上会显示电话数字键盘。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;tel&quot;</span> <span class="attr">name</span>=<span class="string">&quot;tel&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="text"><a href="#text" class="headerlink" title="text"></a>text</h4><p>默认值。单行的文本区域，输入中的换行会被自动去除。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;text&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="time"><a href="#time" class="headerlink" title="time"></a>time</h4><p>用于输入时间的控件，不包括时区。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;time&quot;</span> <span class="attr">name</span>=<span class="string">&quot;time&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="url"><a href="#url" class="headerlink" title="url"></a>url</h4><p>用于输入 URL 的控件。类似 text 输入，但有验证参数，在支持动态键盘的设备上有相应的键盘。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;url&quot;</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h4 id="week"><a href="#week" class="headerlink" title="week"></a>week</h4><p>用于输入以年和周数组成的日期，不带时区。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;week&quot;</span> <span class="attr">name</span>=<span class="string">&quot;week&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="什么是-Data-URL"><a href="#什么是-Data-URL" class="headerlink" title="什么是 Data URL"></a>什么是 Data URL</h3><p>Data URL 是将图片转换为 base64 直接嵌入到了网页中，使用<code>&lt;img src=&quot;data:[MIME type];base64&quot;/&gt;</code>这种方式引用图片，不需要再发请求获取图片。 使用 Data URL 也有一些缺点：</p><ul><li>base64 编码后的图片会比原来的体积大三分之一左右。</li><li>Data URL 形式的图片不会缓存下来，每次访问页面都要被下载一次。可以将 Data URL 写入到 CSS 文件中随着 CSS 被缓存下来。</li></ul><p>Data URL 是前缀为<code>data:</code>协议的 URL； 它允许内容创建者向文档中嵌入小文件，比如图片等。 Data URL 由四部分组成：</p><ul><li>前缀<code>data:</code></li><li>指示数据类型的 MIME 类型。例如<code>image/jpeg</code>表示 JPEG 图像文件；如果此部分被省略，则默认值为<code>text/plain;charset=US-SACII</code></li><li>如果为非文本数据，则可选 base64 做标记</li><li>数据</li></ul><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data:[mediatype][;base63], data</span><br></pre></td></tr></table></figure><h3 id="什么是-HTML-的实体编码-HTML-Entity-Encode"><a href="#什么是-HTML-的实体编码-HTML-Entity-Encode" class="headerlink" title="什么是 HTML 的实体编码 (HTML Entity Encode)"></a>什么是 HTML 的实体编码 (HTML Entity Encode)</h3><ul><li>不可分的空格:＆nbsp;</li><li>&lt;(小于符号):＆lt;</li><li>(大于符号):＆gt;</li><li>＆(与符号):＆amp;</li><li>″(双引号):＆quot;</li><li>‘(单引号):’＆apos;</li><li>……</li></ul><p>HTML 实体是一段以连字号（&amp;）开头、以分号（;）结尾的字符串。用以显示不可见字符及保留字符 (如 HTML 标签)</p><p>在前端，一般为了避免 XSS 攻击，会将 <code>&lt;&gt;</code> 编码为 <code>&lt;</code> 与 <code>&gt;</code>，这些就是 HTML 实体编码。</p><p>在 <a href="https://html.spec.whatwg.org/multipage/named-characters.html#named-character-references">whatwg (opens new window)</a>中可查看实体编码数据。</p><p>在 HTML 转义时，仅仅只需要对六个字符进行编码: <code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&quot;</code>, <code>&#39;</code>, ```。可使用 <a href="https://npm.devtool.tech/he">he (opens new window)</a>这个库进行编码及转义</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实体编码</span></span><br><span class="line">&gt; he.<span class="title function_">encode</span>(<span class="string">&#x27;&lt;img src=&quot;&quot;&gt;&lt;/img&gt;&#x27;</span>)</span><br><span class="line">&lt; <span class="string">&quot;&amp;#x3C;img src=&amp;#x22;&amp;#x22;&amp;#x3E;&amp;#x3C;/img&amp;#x3E;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转义</span></span><br><span class="line">&gt; he.<span class="built_in">escape</span>(<span class="string">&#x27;&lt;img src=&quot;&quot;&gt;&lt;/img&gt;&#x27;</span>)</span><br><span class="line">&lt; <span class="string">&quot;&amp;lt;img src=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/img&amp;gt;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="HTML-标签有哪些行内元素"><a href="#HTML-标签有哪些行内元素" class="headerlink" title="HTML 标签有哪些行内元素"></a>HTML 标签有哪些行内元素</h3><p>常见的标签有以下几种，可参考 <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Inline_elements">inline element(opens new window)</a></p><ul><li>a</li><li>img</li><li>picture</li><li>span</li><li>input</li><li>textarea</li><li>select</li><li>label</li></ul><h3 id="HTML-中有哪些语义化标签"><a href="#HTML-中有哪些语义化标签" class="headerlink" title="HTML 中有哪些语义化标签"></a>HTML 中有哪些语义化标签</h3><blockquote><p>见文档 <a href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element">HTML Elements - MDN(opens new window)</a></p></blockquote><ul><li>header</li><li>footer</li><li>main</li><li>aside</li><li>article</li><li>section</li><li>address</li><li>summary/details</li><li>menu</li><li>h1/h2/h3/h4/h5/h6</li><li>img</li><li>p</li><li>strong/italic</li></ul><h3 id="什么是-URL-编码"><a href="#什么是-URL-编码" class="headerlink" title="什么是 URL 编码"></a>什么是 URL 编码</h3><h4 id="为什么要URLEncode"><a href="#为什么要URLEncode" class="headerlink" title="为什么要URLEncode"></a>为什么要URLEncode</h4><p>URL在定义时，定义为只支持ASCII字符，所以URL的发送方与接收方都只能处理ASCII字符。所以当你的URL中有非ASCII字符时就需要编码转换。</p><p>在Web程序中进行URL请求时，常会遇到URL中含有特殊字符的问题，常见的特殊字符有 ?$&amp;*@等字符，或者是中文。</p><p>遇到这种情况时，就要对URL进行编码，用一种规则替换掉这些特殊字符，这就是URLEncode</p><h4 id="URLEncode-规则"><a href="#URLEncode-规则" class="headerlink" title="URLEncode 规则"></a>URLEncode 规则</h4><ol><li><p>将空格转换为加号（+）</p></li><li><p>对0-9、a-z、A-Z之间的字符保持不变</p></li><li><p>对于所有其他的字符，用这个字符的当前当前字符集编码在内存中的十六进制格式表示，并在每一个字节前加上一个百分号（%），如字符“+”是用%2B表示，字符“=”用%3D表示，字符“&amp;”用%26表示，每个中文字符在内存中占两个字节，字符“中”用%D6%D0表示，字符“国”用%B9%FA表示。</p></li><li><p>空格也可以直接用其十六进制编码方式，即用%20表示，而不是将它转换为加号（+）。</p></li></ol><h2 id="CSS"><a href="#CSS" class="headerlink" title="CSS"></a>CSS</h2><h3 id="如何实现一个元素的水平垂直居中"><a href="#如何实现一个元素的水平垂直居中" class="headerlink" title="如何实现一个元素的水平垂直居中"></a>如何实现一个元素的水平垂直居中</h3><h4 id="方法一-使用flex布局并margin自适应进行居中"><a href="#方法一-使用flex布局并margin自适应进行居中" class="headerlink" title="方法一 使用flex布局并margin自适应进行居中"></a>方法一 使用flex布局并margin自适应进行居中</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>快速剧中对齐<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="comment">/* 样式代码省略 */</span></span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: auto</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法二-使用弹性盒子来实现居中"><a href="#方法二-使用弹性盒子来实现居中" class="headerlink" title="方法二 使用弹性盒子来实现居中"></a>方法二 使用弹性盒子来实现居中</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="selector-class">.father</span>&#123;</span><br><span class="line">     <span class="attribute">display</span>: flex;</span><br><span class="line">     <span class="attribute">justify-content</span>: center;</span><br><span class="line">     <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="方法三-使用绝对定位并进行偏移"><a href="#方法三-使用绝对定位并进行偏移" class="headerlink" title="方法三 使用绝对定位并进行偏移"></a>方法三 使用绝对定位并进行偏移</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>:<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="css-如何实现左侧固定-300px，右侧自适应的布局"><a href="#css-如何实现左侧固定-300px，右侧自适应的布局" class="headerlink" title="css 如何实现左侧固定 300px，右侧自适应的布局"></a>css 如何实现左侧固定 300px，右侧自适应的布局</h3><p>使用 <code>flex</code> 布局，左侧 <code>300px</code>，右侧 <code>flex-grow: 1</code>。<code>css</code> 代码示例如下</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">flex-basis</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何实现一个-loading-动画"><a href="#如何实现一个-loading-动画" class="headerlink" title="如何实现一个 loading 动画"></a>如何实现一个 loading 动画</h3><p>如何实现一个 loading 动画，可用 css 或 svg</p><h4 id="svg-实现方案"><a href="#svg-实现方案" class="headerlink" title="svg 实现方案"></a>svg 实现方案</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;svg class=&quot;loading&quot; viewbox=&quot;<span class="number">25</span> <span class="number">25</span> <span class="number">50</span> <span class="number">50</span>&quot;&gt;</span><br><span class="line">  &lt;circle cx=&quot;<span class="number">50</span>&quot; cy=&quot;<span class="number">50</span>&quot; r=&quot;<span class="number">25</span>&quot; class=&quot;path&quot; fill=&quot;<span class="attribute">none</span>&quot; /&gt;</span><br><span class="line">&lt;/svg&gt;</span><br><span class="line"><span class="selector-class">.loading</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">animation</span>: rotate <span class="number">2s</span> linear <span class="number">0s</span> infinite;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.path</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: dash <span class="number">2s</span> ease-in-out infinite;</span><br><span class="line">  stroke: <span class="number">#00b390</span>;</span><br><span class="line">  stroke-<span class="attribute">width</span>: <span class="number">2</span>;</span><br><span class="line">  stroke-dasharray: <span class="number">90</span> <span class="number">150</span>;</span><br><span class="line">  stroke-dashoffset: <span class="number">0</span>;</span><br><span class="line">  stroke-linecap: round;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> rotate &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> dash &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    stroke-dasharray: <span class="number">1</span> <span class="number">150</span>;</span><br><span class="line">    stroke-dashoffset: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    stroke-dasharray: <span class="number">90</span> <span class="number">150</span>;</span><br><span class="line">    stroke-dashoffset: -<span class="number">40px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    stroke-dasharray: <span class="number">90</span> <span class="number">150</span>;</span><br><span class="line">    stroke-dashoffset: -<span class="number">120px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何使用-css-写一个魔方"><a href="#如何使用-css-写一个魔方" class="headerlink" title="如何使用 css 写一个魔方"></a>如何使用 css 写一个魔方</h3><h4 id="demo-1"><a href="#demo-1" class="headerlink" title="demo 1"></a>demo 1</h4><p><a href="https://jsbin.com/xemaxovisa/edit?css,output">源码地址</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>JS Bin<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;control-box&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-r&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-g&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-b&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-p&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-w&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">name</span>=<span class="string">&quot;cf&quot;</span> <span class="attr">id</span>=<span class="string">&quot;confront-y&quot;</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-r&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-g&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-b&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-p&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-w&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">&quot;confront-y&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-r9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-g9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-w9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-y9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-b9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;outer color-p9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner top9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner btm9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner left9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner right9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner back9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front2&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front4&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front5&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front6&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front7&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front8&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;inner front9&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span>,<span class="selector-tag">body</span>&#123;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">min-width</span>: <span class="number">480px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.control-box</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">34px</span>; </span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[type=<span class="string">&quot;radio&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">left</span> : <span class="number">0px</span>;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">visibility</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-r</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-r&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-g</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-g&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: green;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-b</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-b&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-p</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-p&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: purple;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-w</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-w&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#aaa</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-y</span><span class="selector-pseudo">:checked</span> ~<span class="selector-attr">[for=<span class="string">&quot;confront-y&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#aaa</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-r</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">30deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-g</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">150deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-b</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">30deg</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-p</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">150deg</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-w</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,<span class="number">150deg</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#confront-y</span><span class="selector-pseudo">:checked</span> ~ <span class="selector-class">.container</span> &gt;<span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">30deg</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for^=<span class="string">&quot;confront&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">float</span>: left;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">2px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#eee</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">18px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-r&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;正面朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-g&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;背面朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-b&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;左侧朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-p&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;右侧朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-w&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;顶面朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[for=<span class="string">&quot;confront-y&quot;</span>]</span><span class="selector-pseudo">::before</span>&#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&quot;底面朝前&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.container</span>&#123;</span><br><span class="line">  <span class="attribute">perspective</span>: <span class="number">1200</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">45%</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attr">--redZ</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--greenZ</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--blueX</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--purpleX</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--whiteY</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--yellowY</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--frontZ</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--backZ</span>: -<span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--leftX</span>: -<span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--rightX</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--topY</span>: -<span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--btmY</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="attr">--YU</span>: -<span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--YD</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--XL</span>: -<span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--XR</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--ZB</span>: -<span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--ZF</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attr">--redZ</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--greenZ</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--blueX</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--purpleX</span>: <span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--whiteY</span>: -<span class="number">75px</span>;</span><br><span class="line">  <span class="attr">--yellowY</span>: <span class="number">75px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span>&#123;</span><br><span class="line">  <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>,<span class="number">1</span>,<span class="number">0</span>,-<span class="number">30deg</span>);</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">3s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.box</span> &gt; *&#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">rgba</span>(<span class="number">200</span>,<span class="number">200</span>,<span class="number">200</span>,<span class="number">0.8</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-r&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f00c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-g&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#0f0c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-b&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#00fc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-y&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#ff0c</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-p&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f0fc</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class*=<span class="string">&quot;color-w&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fffd</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[class^=<span class="string">&quot;inner&quot;</span>]</span>&#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#999f</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* outer start */</span></span><br><span class="line"><span class="selector-class">.color-r1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="number">0</span>,<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="number">0</span>,<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-r9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--redZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="number">0</span>,<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="number">0</span>,<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-g9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--greenZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YU),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="number">0</span>,<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="number">0</span>,<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YD),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-b9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--blueX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YU),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="number">0</span>,<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="number">0</span>,<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YD),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-p9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--purpleX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--whiteY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--whiteY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--whiteY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-w9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--whiteY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--yellowY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--yellowY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--yellowY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.color-y9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--yellowY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* outer end */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/* innner start */</span></span><br><span class="line"><span class="selector-class">.front1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="number">0</span>,<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="number">0</span>,<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.front9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--frontZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="number">0</span>,<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="number">0</span>,<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.back9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--backZ));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YU),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="number">0</span>,<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="number">0</span>,<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YD),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.left9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--leftX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YU),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YU),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="number">0</span>,<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="number">0</span>,<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="number">0</span>,<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YD),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.right9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--rightX),<span class="built_in">var</span>(--YD),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateY</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--topY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--topY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--topY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.top9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--topY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm1</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm2</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--btmY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm3</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XL),<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm4</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm5</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--btmY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm6</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="number">0</span>,<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm7</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZF))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm8</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--btmY),<span class="number">0</span>)</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.btm9</span>&#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translate3d</span>(<span class="built_in">var</span>(--XR),<span class="built_in">var</span>(--btmY),<span class="built_in">var</span>(--ZB))</span><br><span class="line">    <span class="built_in">rotateX</span>(<span class="number">90deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="demo-2"><a href="#demo-2" class="headerlink" title="demo 2"></a>demo 2</h4><p><a href="https://codepen.io/indusy/pen/YzeEzzb">源码地址</a></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;cube&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;layer&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.cube</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">perspective</span>: <span class="number">10000px</span>;</span><br><span class="line">  <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d;</span><br><span class="line">  <span class="attribute">transform-origin</span>: center;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate3d</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(<span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>) <span class="number">2px</span>, transparent <span class="number">0</span>),</span><br><span class="line">  <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.5</span>) <span class="number">2px</span>, transparent <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">33.3%</span> <span class="number">33.3%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#2222aadd</span>;</span><br><span class="line">  <span class="attribute">transform-origin</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#8822a1dd</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">90deg</span>) <span class="built_in">translate3d</span>(<span class="number">75px</span>, <span class="number">0px</span>, -<span class="number">75px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#458631dd</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(-<span class="number">90deg</span>) <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">75px</span>, <span class="number">75px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">4</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#b3b667dd</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">90deg</span>) <span class="built_in">translate3d</span>(<span class="number">75px</span>, <span class="number">0</span>, <span class="number">75px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">5</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#f99000dd</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(<span class="number">90deg</span>) <span class="built_in">translate3d</span>(<span class="number">0</span>, -<span class="number">75px</span>, <span class="number">75px</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.layer</span><span class="selector-pseudo">:nth-child</span>(<span class="number">6</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#49ff9fdd</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateX</span>(-<span class="number">180deg</span>) <span class="built_in">translate3d</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">150px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="有没有使用过-css-variable，它解决了哪些问题"><a href="#有没有使用过-css-variable，它解决了哪些问题" class="headerlink" title="有没有使用过 css variable，它解决了哪些问题"></a>有没有使用过 css variable，它解决了哪些问题</h3><p>css 变量减少样式重复定义，比如同一个颜色值要在多个地方重复使用，以前通过 less 和 sass 预处理做到，现在 css 变量也可以做到，方便维护，提高可读性</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:root&#123;</span><br><span class="line">  --bgcolor: blue;</span><br><span class="line">  --color: red;</span><br><span class="line">&#125;</span><br><span class="line">p &#123;</span><br><span class="line">  color: var(--color);</span><br><span class="line">&#125;</span><br><span class="line">div &#123;</span><br><span class="line">  backgroung-color: var(--bgcolor);</span><br><span class="line">  color: var(--color)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在媒体查询中使用，精简代码，减少冗余</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">.box &#123;</span><br><span class="line">  --base-size: 10;</span><br><span class="line">  width: calc(var(--base-size)* 10px);</span><br><span class="line">  height: clac(var(--base-size)* 5px);</span><br><span class="line">  padding:calc(var(--base-size) * 1px);</span><br><span class="line">&#125;</span><br><span class="line">@media screen and (min-width: 1480px) &#123;</span><br><span class="line">  .box&#123;</span><br><span class="line">    --base-size: 8;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>方便在 js 中使用</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// 设置变量</span><br><span class="line">document.getElementById(&quot;box&quot;).style.setPropertyValue(&#x27;--color&#x27;, &#x27;pink&#x27;)</span><br><span class="line">// 读取变量</span><br><span class="line">doucment.getElementById(&#x27;box&#x27;).style.getPropertyValue(&#x27;--color&#x27;).trim()    //pink</span><br><span class="line">// 删除变量</span><br><span class="line">document.getElementById(&#x27;box&#x27;).style.removeProperty(&#x27;--color&#x27;)</span><br></pre></td></tr></table></figure><h3 id="使用-CSS-如何画一个三角形"><a href="#使用-CSS-如何画一个三角形" class="headerlink" title="使用 CSS 如何画一个三角形"></a>使用 CSS 如何画一个三角形</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.triangle</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">100px</span> solid transparent;</span><br><span class="line">    <span class="attribute">border-bottom</span>: <span class="number">100px</span> solid <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何实现左右固定，中间自适应布局"><a href="#如何实现左右固定，中间自适应布局" class="headerlink" title="如何实现左右固定，中间自适应布局"></a>如何实现左右固定，中间自适应布局</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">.container</span><br><span class="line">  .left</span><br><span class="line">  .main</span><br><span class="line">  .right</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.left</span> &#123;</span><br><span class="line">  <span class="attribute">flex-basis</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.right</span> &#123;</span><br><span class="line">  <span class="attribute">flex-basis</span>: <span class="number">300px</span>;</span><br><span class="line">  <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.main</span> &#123;</span><br><span class="line">  <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何实现表格单双行条纹样式"><a href="#如何实现表格单双行条纹样式" class="headerlink" title="如何实现表格单双行条纹样式"></a>如何实现表格单双行条纹样式</h3><p>通过 <code>css3</code> 中伪类 <code>:nth-child</code> 来实现。其中 <code>:nth-child(an+b)</code> 匹配下标 <code>&#123; an + b; n = 0, 1, 2, ...&#125;</code> 且结果为整数的子元素</p><ul><li><code>nth-child(2n)</code>/<code>nth-child(even)</code>: 双行样式</li><li><code>nth-child(2n+1)</code>/<code>nth-child(odd)</code>: 单行样式</li></ul><p>其中 <code>tr</code> 在表格中代表行，实现表格中单双行样式就很简单了：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">tr</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>n) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">tr</span><span class="selector-pseudo">:nth-child</span>(<span class="number">2</span>n + <span class="number">1</span>) &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: blue;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="简述下-css-specificity"><a href="#简述下-css-specificity" class="headerlink" title="简述下 css specificity"></a>简述下 css specificity</h3><p><code>css specificity</code> 即 css 中关于选择器的权重，以下三种类型的选择器依次下降</p><ol><li><code>id</code> 选择器，如 <code>#app</code></li><li><code>class</code>、<code>attribute</code> 与 <code>pseudo-classes</code> 选择器，如 <code>.header</code>、<code>[type=&quot;radio&quot;]</code> 与 <code>:hover</code></li><li><code>type</code> 标签选择器和伪元素选择器，如 <code>h1</code>、<code>p</code> 和 <code>::before</code></li></ol><p>其中通配符选择器 <code>*</code>，组合选择器 <code>+ ~ &gt;</code>，否定伪类选择器 <code>:not()</code> 对优先级无影响</p><p>另有内联样式 <code>&lt;div class=&quot;foo&quot; style=&quot;color: red;&quot;&gt;&lt;/div&gt;</code> 及 <code>!important</code>(最高) 具有更高的权重</p><blockquote><p><a href="https://codepen.io/shanyue/pen/dyGQqBe"><code>:not</code> 的优先级影响 - codepen (opens new window)</a>可以看出 <code>:not</code> 对选择器的优先级无任何影响</p></blockquote><blockquote><p><a href="https://codepen.io/shanyue/pen/XWMRQOw">CSS Specificity - codepen (opens new window)</a>可以看出十几个 class 选择器也没有一个 id 选择器权重高</p></blockquote><h3 id="‘-’-与-‘-’-选择器有什么不同"><a href="#‘-’-与-‘-’-选择器有什么不同" class="headerlink" title="‘+’ 与 ‘~’ 选择器有什么不同"></a>‘+’ 与 ‘~’ 选择器有什么不同</h3><p><code>~</code> 是匹配元素之后的选择器</p><p><code>+</code> 是匹配相邻元素选择器</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我是p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我是p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>我是div<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>我是p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是div下面的p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>我是div下面的p<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>我是span<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">div</span>+<span class="selector-tag">p</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 第一个p标签变红色了 */</span></span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">div</span>~<span class="selector-tag">p</span>&#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>:red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* div后面的p标签都变成红色了 */</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="有哪些-css-属性不能展示动画效果"><a href="#有哪些-css-属性不能展示动画效果" class="headerlink" title="有哪些 css 属性不能展示动画效果"></a>有哪些 css 属性不能展示动画效果</h3><p>display,height</p><p>css 不能在 display:none 和 display:block 之间进行动画，也不能在 height:0 和 height:auto 之间进行动画</p><h3 id="css-动画与-js-动画哪个性能更好"><a href="#css-动画与-js-动画哪个性能更好" class="headerlink" title="css 动画与 js 动画哪个性能更好"></a>css 动画与 js 动画哪个性能更好</h3><p>CSS3 的动画：</p><ol><li><p>在性能上会稍微好一些，浏览器会对 CSS3 的动画做一些优化（比如专门新建一个图层用来跑动画）</p></li><li><p>代码相对简单 </p></li><li><p>在动画控制上不够灵活</p></li><li><p>兼容性不好</p></li><li><p>部分动画功能无法实现（如滚动动画，视差滚动等）</p></li></ol><p>JavaScript 的动画： </p><p>正好弥补了 css 缺点，控制能力很强，可以单帧的控制、变换，同时写得好完全可以兼容 IE6，并且功能强大。 总结： 对于一些复杂控制的动画，使用 javascript 会比较好。而在实现一些小的交互动效的时候，可以多考虑 CSS</p><h3 id="为什么会发生样式抖动"><a href="#为什么会发生样式抖动" class="headerlink" title="为什么会发生样式抖动"></a>为什么会发生样式抖动</h3><p>因为没有指定元素具体高度和宽度,比如数据还没有加载进来时元素高度是 100px(假设这里是 100px),数据加载进来后,因为有了数据,然后元素被撑大,所有出现了抖动</p><h3 id="position-sticky-如何工作，适用于哪些场景"><a href="#position-sticky-如何工作，适用于哪些场景" class="headerlink" title="position: sticky 如何工作，适用于哪些场景"></a>position: sticky 如何工作，适用于哪些场景</h3><p><code>position: sticky</code> 可理解为 <code>relative</code> 与 <code>fixed</code> 的结合体</p><p>MDN 的解释：position: sticky 在正常文档流中仍然保有位置，然后会相对于它的最近的滚动祖先和最近的块级祖先根据 top, left, right, bottom 的值进行偏移。元素偏移不会影响其他任何元素的位置，因为会为该元素创建一个新的层叠上下文，从而不会影响到页面上的其他元素</p><p>css-tricks 一篇文章的理解：在窗口的管轮向下滚动没有让该元素完全消失前，该元素的表现就与 postion:relative 的元素相同，之后该元素的表现就类似于 position: fixed 的元素， 只不过该元素是相对于离他最近的滚轮祖先</p><h3 id="伪类与伪元素有什么区别"><a href="#伪类与伪元素有什么区别" class="headerlink" title="伪类与伪元素有什么区别"></a>伪类与伪元素有什么区别</h3><ol><li>伪类使用单冒号，而伪元素使用双冒号。如 <code>:hover</code> 是伪类，<code>::before</code> 是伪元素</li><li>伪元素会在文档流生成一个新的元素，并且可以使用 <code>content</code> 属性设置内容</li></ol><h3 id="css-如何匹配前-N-个子元素及最后-N-个子元素"><a href="#css-如何匹配前-N-个子元素及最后-N-个子元素" class="headerlink" title="css 如何匹配前 N 个子元素及最后 N 个子元素"></a>css 如何匹配前 N 个子元素及最后 N 个子元素</h3><ul><li>如何匹配最前三个子元素: <code>:nth-child(-n+3)</code></li><li>如何匹配最后三个子元素: <code>:nth-last-child(-n+3)</code></li></ul><h3 id="如何使用-CSS-实现网站的暗黑模式-Dark-Mode"><a href="#如何使用-CSS-实现网站的暗黑模式-Dark-Mode" class="headerlink" title="如何使用 CSS 实现网站的暗黑模式 (Dark Mode)"></a>如何使用 CSS 实现网站的暗黑模式 (Dark Mode)</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">prefers-color-scheme</span>: dark) &#123;</span><br><span class="line">  <span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>实现方式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">html</span><span class="selector-attr">[theme=<span class="string">&quot;dark-model&quot;</span>]</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">invert</span>(<span class="number">1</span>) <span class="built_in">hue-rotate</span>(<span class="number">180</span>);</span><br><span class="line">  <span class="attribute">transition</span>: color <span class="number">300ms</span>, background-color <span class="number">300ms</span>; <span class="comment">/*过渡动画*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>解释： css 的 filter 属性 是将用于图片上的过滤，颜色变化等图形效果应用与元素上， 上面所使用到的 invert 可以用来反转应用程序的颜色; hue-rotate 是用来改变图像上的应用色颜色 通过 invert(1)将白色变成黑色，那么为了适配颜色的变化，网页上的图像的颜色应该也做一个改变，这个改变就是通过 hue-rotate(180edg)来实现的 filter 属性 其他著名的应用还有: _ blur() 模糊图像 _ opacity() 图像透明程度 _ drop-shadow() 对图像应用阴影效果 _ …</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/filter">MDN Docs (opens new window)</a><a href="https://segmentfault.com/a/1190000023598551">如何实现网页 dark-model</a></p><h3 id="介绍-CSS-隐藏页面中某个元素的几种方法"><a href="#介绍-CSS-隐藏页面中某个元素的几种方法" class="headerlink" title="介绍 CSS 隐藏页面中某个元素的几种方法"></a>介绍 CSS 隐藏页面中某个元素的几种方法</h3><h4 id="01-display-none"><a href="#01-display-none" class="headerlink" title="01 display: none"></a>01 display: none</h4><p>通过 CSS 操控 display，移出文档流</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">display</span>: none;</span><br></pre></td></tr></table></figure><h4 id="02-opacity-0"><a href="#02-opacity-0" class="headerlink" title="02 opacity: 0"></a>02 opacity: 0</h4><p>透明度为 0，仍在文档流中，当作用于其上的事件(如点击)仍有效</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">opacity</span>: <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h4 id="03-visibility-hidden"><a href="#03-visibility-hidden" class="headerlink" title="03 visibility: hidden"></a>03 visibility: hidden</h4><p>透明度为 0，仍在文档流中，<strong>但作用于其上的事件(如点击)无效</strong>，这也是 <code>visibility:hidden</code> 与 <code>opacity: 0</code> 的区别</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">visibility</span>: hidden;</span><br></pre></td></tr></table></figure><h4 id="04-content-visibility"><a href="#04-content-visibility" class="headerlink" title="04 content-visibility"></a>04 content-visibility</h4><p>移出文档流，但是再次显示时消耗性能低</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">content-visibility</span>: hidden;</span><br></pre></td></tr></table></figure><h4 id="05-绝对定位于当前页面的不可见位置"><a href="#05-绝对定位于当前页面的不可见位置" class="headerlink" title="05 绝对定位于当前页面的不可见位置"></a>05 绝对定位于当前页面的不可见位置</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: -<span class="number">9000px</span>;</span><br><span class="line"><span class="attribute">left</span>: -<span class="number">9000px</span>;</span><br></pre></td></tr></table></figure><h4 id="06-字体大小设置为-0"><a href="#06-字体大小设置为-0" class="headerlink" title="06 字体大小设置为 0"></a>06 字体大小设置为 0</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">font-size</span>: <span class="number">0</span>;</span><br></pre></td></tr></table></figure><h3 id="如何自定义滚动条的样式"><a href="#如何自定义滚动条的样式" class="headerlink" title="如何自定义滚动条的样式"></a>如何自定义滚动条的样式</h3><p>滚动条相关样式都是伪元素，以 <code>scrollbar</code> 打头，有以下伪元素，从 <code>-webkit</code> 中可见兼容性一般，不过无所谓，现在 Chrome 浏览器占大头</p><ul><li><code>::-webkit-scrollbar</code> — 整个滚动条.</li><li><code>::-webkit-scrollbar-button</code> — 滚动条上的按钮 (上下箭头).</li><li><code>::-webkit-scrollbar-thumb</code> — 滚动条上的滚动滑块.</li><li><code>::-webkit-scrollbar-track</code> — 滚动条轨道.</li><li><code>::-webkit-scrollbar-track-piece</code> — 滚动条没有滑块的轨道部分.</li><li><code>::-webkit-scrollbar-corner</code> — 当同时有垂直滚动条和水平滚动条时交汇的部分.</li><li><code>::-webkit-resizer</code> — 某些元素的 corner 部分的部分样式(例:textarea 的可拖动按钮).</li></ul><p>但其实最常用的是以下几个伪元素：<strong>滚动条、滑块、轨道</strong>，如下滚动条设置成功</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">6px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">::-webkit-scrollbar-track &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.08</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">::-webkit-scrollbar-thumb &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">3px</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="attribute">box-shadow</span>: inset <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="如何实现容器中子元素三个三列布局，子元素两个则两列布局"><a href="#如何实现容器中子元素三个三列布局，子元素两个则两列布局" class="headerlink" title="如何实现容器中子元素三个三列布局，子元素两个则两列布局"></a>如何实现容器中子元素三个三列布局，子元素两个则两列布局</h3><p>容器中有三个及以上元素，则三列布局 容器只有两个元素，两列布局平分 容器只有一个元素，一列布局全占</p><p>css 布局阔以使用<code>flex</code>，<code>grid</code>.</p><p>关健在于如何判断有多少元素。我们只需要判断有 1 个，有 2 个的情况，其他都是三列布局</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 有1个元素 */</span></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">1</span>)<span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">1</span>)<span class="selector-pseudo">:first</span>-child ~ <span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 有2个元素 */</span></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">2</span>)<span class="selector-pseudo">:first</span>-child &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">2</span>)<span class="selector-pseudo">:first</span>-child ~ <span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>反过来，前 3 个设置<code>flex:1</code>，超过 3 个就重置为<code>none</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*前3个flex：1*/</span></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-child</span>(-n + <span class="number">3</span>) &#123;</span><br><span class="line">  <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*超过3个则none*/</span></span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">4</span>),</span><br><span class="line"><span class="selector-class">.item</span><span class="selector-pseudo">:nth-last-child</span>(<span class="number">4</span>) ~ <span class="selector-class">.item</span> &#123;</span><br><span class="line">  <span class="attribute">flex</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="画一个-100x100-的方框，其中文字可以正常换行，文字过多超过方框显示滚动条"><a href="#画一个-100x100-的方框，其中文字可以正常换行，文字过多超过方框显示滚动条" class="headerlink" title="画一个 100x100 的方框，其中文字可以正常换行，文字过多超过方框显示滚动条"></a>画一个 100x100 的方框，其中文字可以正常换行，文字过多超过方框显示滚动条</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span>aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.box</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">  <span class="attribute">overflow</span>: scroll;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CSS-如何设置一行超出显示省略号"><a href="#CSS-如何设置一行超出显示省略号" class="headerlink" title="CSS 如何设置一行超出显示省略号"></a>CSS 如何设置一行超出显示省略号</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">text-overflow</span>: ellipsis;</span><br><span class="line"><span class="attribute">white-space</span>: nowrap;</span><br></pre></td></tr></table></figure><h3 id="CSS-如何设置多行超出显示省略号"><a href="#CSS-如何设置多行超出显示省略号" class="headerlink" title="CSS 如何设置多行超出显示省略号"></a>CSS 如何设置多行超出显示省略号</h3><p>使用 <code>-webkit-line-clamp</code> 来设置多行超出显示省略号</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">overflow</span>: hidden;</span><br><span class="line"><span class="attribute">display</span>: -webkit-box;</span><br><span class="line">-webkit-box-orient: vertical;</span><br><span class="line">-webkit-line-clamp: <span class="number">2</span>;</span><br></pre></td></tr></table></figure><h3 id="flex-布局中-order-有何作用"><a href="#flex-布局中-order-有何作用" class="headerlink" title="flex 布局中 order 有何作用"></a>flex 布局中 order 有何作用</h3><p><code>order</code> 属性定义 Flex 布局中子元素的排列顺序，数值越小，排列越靠前，默认为 0。</p><h3 id="flex-布局中-align-content-与-align-items-有何区别"><a href="#flex-布局中-align-content-与-align-items-有何区别" class="headerlink" title="flex 布局中 align-content 与 align-items 有何区别"></a>flex 布局中 align-content 与 align-items 有何区别</h3><blockquote><p>示例代码见: <a href="https://codepen.io/shanyue/pen/abJwoRp?editors=1100">align-content 与 align-items(opens new window)</a></p></blockquote><ul><li><code>align-content</code> 作用于纵轴多行元素，一行元素不起作用</li><li><code>align-items</code> 作用于纵轴单行元素</li></ul><h3 id="简述-css-中-position-的值"><a href="#简述-css-中-position-的值" class="headerlink" title="简述 css 中 position 的值"></a>简述 css 中 position 的值</h3><ul><li><code>static</code>: 默认值，无定位，<code>top</code>、<code>right</code>、<code>bottom</code>、<code>left</code> 不起任何作用</li><li><code>relative</code>: 相对定位</li><li><code>absolute</code>: 绝对定位，脱离文档流，上下左右以最近的定位父元素为参照系</li><li><code>fixed</code>: 脱离文档流，上下左右以浏览器视口为参照系</li><li><code>sticky</code>: <code>relative</code> 与 <code>fixed</code> 的结合体</li></ul><h3 id="CSS-如何实现固定长宽比的元素"><a href="#CSS-如何实现固定长宽比的元素" class="headerlink" title="CSS 如何实现固定长宽比的元素"></a>CSS 如何实现固定长宽比的元素</h3><p>过去的解决方案是使用 <code>padding</code>。一个元素的 <code>padding</code> 如若设置为百分比，则代表的是以父元素宽度为基准，根据这个原理，可设置长宽比。但实际上意义有限，毕竟你把 padding 给占了，content 无任何区域。</p><p>现代化的解决方案是使用长宽比的 CSS 属性: <code>aspect-ratio</code></p><p><a href="https://codepen.io/hwb2017/pen/qBXbmpq">codepen demo</a></p><h3 id="rem、em、vw、vh-的值各是什么意思"><a href="#rem、em、vw、vh-的值各是什么意思" class="headerlink" title="rem、em、vw、vh 的值各是什么意思"></a>rem、em、vw、vh 的值各是什么意思</h3><p>他们同属于 CSS Data Type 中的 <code>[length]</code>，见文档 <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/length">length - MDN(opens new window)</a></p><ul><li><code>rem</code>: 根据根元素(即 <code>html</code>)的 <code>font-size</code></li><li><code>em</code>: 根据<strong>自身元素</strong>的 <code>font-size</code></li><li><code>vw</code>: viewport width</li><li><code>vh</code>: viewport height</li></ul><h3 id="line-height-的值分别取-2-2em-200-有什么区别"><a href="#line-height-的值分别取-2-2em-200-有什么区别" class="headerlink" title="line-height 的值分别取 [2, 2em, 200%] 有什么区别?"></a>line-height 的值分别取 [2, 2em, 200%] 有什么区别?</h3><blockquote><p>代码见: <a href="https://codepen.io/shanyue/pen/bGqRLxQ?editors=1100">lineHeight - codepen(opens new window)</a></p></blockquote><p><code>line-height</code> 是相对于元素自身的字体大小来取值，但同时会被继承。在实际工作中，取值 <code>2em</code> 或者 <code>200%</code> 有可能遇到未预测的内容。</p><p>比如:</p><ul><li>父元素: <code>fontSize: 18px; lineHeight: 1.5em(27px，150% 同理);</code> ，它的 lineHeight 计算下来为 27px，会被子元素继承</li><li>子元素: <code>fontSize: 30px</code>，子元素的 lineHeight 被继承为 27px，出现问题</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box green&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>lineHeight: 1.5; 这是没有问题的框框<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  lineHeight: 1.5; 这是没有问题的框框 lineHeight: 1.5; 这是没有问题的框框</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box red&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>lineHeight: 1.5em; 这是有问题的框框<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  lineHeight: 1.5em; 这是有问题的框框 lineHeight: 1.5em; 这是有问题的框框</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;box orange&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>lineHeight: 150%; 这是有问题的框框<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  lineHeight: 150%; 这是有问题的框框 lineHeight: 150%; 这是有问题的框框</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">.green &#123;</span><br><span class="line">  line-height: 1.5;</span><br><span class="line">  border: solid limegreen;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.red &#123;</span><br><span class="line">  line-height: 1.5em;</span><br><span class="line">  border: solid red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.orange &#123;</span><br><span class="line">  line-height: 150%;</span><br><span class="line">  border: solid orange;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">h1 &#123;</span><br><span class="line">  font-size: 30px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box &#123;</span><br><span class="line">  width: 18em;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  vertical-align: top;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Grid-布局的优势在哪里"><a href="#Grid-布局的优势在哪里" class="headerlink" title="Grid 布局的优势在哪里"></a>Grid 布局的优势在哪里</h3><p>Flex 布局是轴线布局，只能指定”项目”针对轴线的位置，可以看作是一维布局。 Grid 布局则是将容器划分成”行”和”列”，产生单元格，然后指定”项目所在”的单元格，可以看作是二维布局。 Grid 布局远比 Flex 布局强大</p><h3 id="如何实现三列均分布局"><a href="#如何实现三列均分布局" class="headerlink" title="如何实现三列均分布局"></a>如何实现三列均分布局</h3><p>更多描述</p><p>布局代码如下所示，可见 <a href="https://codepen.io/shanyue/pen/yLMzxqX">三列均分布局 - codepen(opens new window)</a></p><blockquote><p>注: 在第一个元素中设置文字，子元素不能因文字过长而挤压。</p></blockquote><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>白日依山尽，黄河入海流。欲穷千里目，更上一层楼。<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">// 以下为样式代码，非核心功能代码</span><br><span class="line">* &#123;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.container &#123;</span><br><span class="line">  background-color: #eee;</span><br><span class="line">  height: 10rem;</span><br><span class="line">  width: 40rem;</span><br><span class="line">  margin: 1rem;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.item &#123;</span><br><span class="line">  border: 1px solid #888;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="使用-Flex"><a href="#使用-Flex" class="headerlink" title="使用 Flex"></a>使用 Flex</h4><p>注意使用 <code>calc(100% / 3)</code> 设置 <code>flex-basis</code>，同时它的缺陷是<strong>不能够很好的为子元素设置左右间隙</strong></p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.flex-container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-wrap</span>: wrap;</span><br><span class="line">  <span class="comment">// gap: 1rem;</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.item</span> &#123;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">0</span> <span class="number">0</span> <span class="built_in">calc</span>(<span class="number">100%</span> / <span class="number">3</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意: 如果同时给子元素使用 <code>flex-grow: 1</code> 控制均分，当子元素拥有文字等内容时，会受到挤压，将无法实现均分布局。</p></blockquote><h4 id="使用-Grid"><a href="#使用-Grid" class="headerlink" title="使用 Grid"></a>使用 Grid</h4><p>使用 Grid 直接操作容器即可，对于子元素之间的间隙也可以很好地控制，可看出 Grid 更为简单，更为高效，更为精确</p><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.grid-container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: grid;</span><br><span class="line">  <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">1rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CSS-有哪些选择器"><a href="#CSS-有哪些选择器" class="headerlink" title="CSS 有哪些选择器"></a>CSS 有哪些选择器</h3><ul><li><code>:hover</code></li><li><code>:active</code></li><li><code>:first-child</code></li><li><code>:last-child</code></li><li><code>:nth-child</code></li><li><code>:first-of-type</code></li><li><code>:last-of-type</code></li><li><code>:nth-of-type</code></li><li><code>:empty</code></li><li><code>:check</code></li><li><code>:disable</code></li></ul><p>1.id 选择器 2.类选择器 3.元素选择器 4.分组选择器（并集选择器） 5.复合选择器（交集选择器） 6.通配选择器 7.后代元素选择器 8.子元素选择器 9.伪类选择器 10.属性选择器 11.兄弟元素选择器</p><h3 id="CSS-有哪些伪类与伪元素选择器"><a href="#CSS-有哪些伪类与伪元素选择器" class="headerlink" title="CSS 有哪些伪类与伪元素选择器"></a>CSS 有哪些伪类与伪元素选择器</h3><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/CSS/CSS_Selectors">CSS 选择器 - MDN(opens new window)</a></p><h4 id="伪元素"><a href="#伪元素" class="headerlink" title="伪元素"></a>伪元素</h4><ul><li><code>::before</code></li><li><code>::after</code></li><li><code>::selection</code></li><li><code>::placeholder</code></li><li><code>::marker</code></li></ul><h4 id="伪类"><a href="#伪类" class="headerlink" title="伪类"></a>伪类</h4><ul><li><code>:hover</code></li><li><code>:first-child</code></li><li><code>:last-child</code></li><li><code>:nth-child</code></li></ul><table><thead><tr><th>选择器</th><th>例子</th><th>例子描述</th></tr></thead><tbody><tr><td>:active</td><td>a:active</td><td>选择活动的链接。</td></tr><tr><td>:checked</td><td>input:checked</td><td>选择每个被选中的 元素。</td></tr><tr><td>:disabled</td><td>input:disabled</td><td>选择每个被禁用的 元素。</td></tr><tr><td>:empty</td><td>p:empty</td><td>选择没有子元素的每个元素。</td></tr><tr><td>:enabled</td><td>input:enabled</td><td>选择每个已启用的 元素。</td></tr><tr><td>:first-child</td><td>p:first-child</td><td>选择作为其父的首个子元素的每个元素。</td></tr><tr><td>:first-of-type</td><td>p:first-of-type</td><td>选择作为其父的首个元素的每个元素。</td></tr><tr><td>:focus</td><td>input:focus</td><td>选择获得焦点的 元素。</td></tr><tr><td>:hover</td><td>a:hover</td><td>选择鼠标悬停其上的链接。</td></tr><tr><td>:in-range</td><td>input:in-range</td><td>选择具有指定范围内的值的 元素。</td></tr><tr><td>:invalid</td><td>input:invalid</td><td>选择所有具有无效值的 元素。</td></tr><tr><td>:lang(language)</td><td>p:lang(it)</td><td>选择每个 lang 属性值以 “it” 开头的元素。</td></tr><tr><td>:last-child</td><td>p:last-child</td><td>选择作为其父的最后一个子元素的每个元素。</td></tr><tr><td>:last-of-type</td><td>p:last-of-type</td><td>选择作为其父的最后一个元素的每个元素。</td></tr><tr><td>:link</td><td>a:link</td><td>选择所有未被访问的链接。</td></tr><tr><td>:not(selector)</td><td>:not(p)</td><td>选择每个非元素的元素。</td></tr><tr><td>:nth-child(n)</td><td>p:nth-child(2)</td><td>选择作为其父的第二个子元素的每个元素。</td></tr><tr><td>:nth-last-child(n)</td><td>p:nth-last-child(2)</td><td>选择作为父的第二个子元素的每个元素，从最后一个子元素计数。</td></tr><tr><td>:nth-last-of-type(n)</td><td>p:nth-last-of-type(2)</td><td>选择作为父的第二个元素的每个元素，从最后一个子元素计数</td></tr><tr><td>:nth-of-type(n)</td><td>p:nth-of-type(2)</td><td>选择作为其父的第二个元素的每个元素。</td></tr><tr><td>:only-of-type</td><td>p:only-of-type</td><td>选择作为其父的唯一元素的每个元素。</td></tr><tr><td>:only-child</td><td>p:only-child</td><td>选择作为其父的唯一子元素的元素。</td></tr><tr><td>:optional</td><td>input:optional</td><td>选择不带 “required” 属性的 元素。</td></tr><tr><td>:out-of-range</td><td>input:out-of-range</td><td>选择值在指定范围之外的 元素。</td></tr><tr><td>:read-only</td><td>input:read-only</td><td>选择指定了 “readonly” 属性的 元素。</td></tr><tr><td>:read-write</td><td>input:read-write</td><td>选择不带 “readonly” 属性的 元素。</td></tr><tr><td>:required</td><td>input:required</td><td>选择指定了 “required” 属性的 元素。</td></tr><tr><td>:root</td><td>root</td><td>选择元素的根元素。</td></tr><tr><td>:target</td><td>#news:target</td><td>选择当前活动的 #news 元素（单击包含该锚名称的 URL）。</td></tr><tr><td>:valid</td><td>input:valid</td><td>选择所有具有有效值的 元素。</td></tr><tr><td>:visited</td><td>a:visited</td><td>选择所有已访问的链接。</td></tr></tbody></table><h2 id="浏览器-DOM-API"><a href="#浏览器-DOM-API" class="headerlink" title="浏览器 DOM API"></a>浏览器 DOM API</h2><h3 id="如何设置一个-cookie"><a href="#如何设置一个-cookie" class="headerlink" title="如何设置一个 cookie"></a>如何设置一个 cookie</h3><p>HTTP Cookie（也叫 Web Cookie 或浏览器 Cookie）是服务器发送到用户浏览器并保存在本地的一小块数据，它会在浏览器下次向同一服务器再发起请求时被携带并发送到服务器上。通常，它用于告知服务端两个请求是否来自同一浏览器，如保持用户的登录状态。Cookie 使基于无状态的 HTTP 协议记录稳定的状态信息成为了可能。</p><p>服务端是通过 setCookie 的响应头来设置 cookie 的，要设置多个 cookie 时，得多写几个 setCookie。服务器如果希望在浏览器保存 Cookie，就要在 HTTP 回应的头信息里面，放置一个 Set-Cookie 字段。</p><p>前端使用 document.cookie 属性来读写当前网页的 Cookie。写入的时候，Cookie 的值必须写成 key=value 的形式。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Set</span>-<span class="title class_">Cookie</span>: &lt;cookie-name&gt;=&lt;cookie-value&gt;</span><br></pre></td></tr></table></figure><p>Cookie 曾一度用于客户端数据的存储，因当时并没有其它合适的存储办法而作为唯一的存储手段，但现在随着现代浏览器开始支持各种各样的存储方式，Cookie 渐渐被淘汰。由于服务器指定 Cookie 后，浏览器的每次请求都会携带 Cookie 数据，会带来额外的性能开销（尤其是在移动环境下）。新的浏览器 API 已经允许开发者直接将数据存储到本地，如使用 Web storage API （本地存储和会话存储）或 IndexedDB 。</p><h3 id="如何删除一个-cookie"><a href="#如何删除一个-cookie" class="headerlink" title="如何删除一个 cookie"></a>如何删除一个 cookie</h3><p>通过把该 <code>cookie</code> 的过期时间改为过去时即可删除成功，具体操作的话可以通过操作两个字段来完成</p><ol><li><code>max-age</code>: 将要过期的最大秒数，设置为 <code>-1</code> 即可删除</li><li><code>expires</code>: 将要过期的绝对时间，存储到 <code>cookies</code> 中需要通过 <code>date.toUTCString()</code> 处理，设置为过期时间即可删除</li></ol><p>很明显，<code>max-age</code> 更为简单，以下代码可在命令行控制台中进行测试</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// max-age 设置为 -1 即可成功</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&quot;a=3; max-age=-1&quot;</span>;</span><br><span class="line">&gt; <span class="variable language_">document</span>.<span class="property">cookie</span></span><br><span class="line">&lt; <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&#x27;a=3&#x27;</span></span><br><span class="line">&lt; <span class="string">&quot;a=3&quot;</span></span><br><span class="line"></span><br><span class="line">&gt; <span class="variable language_">document</span>.<span class="property">cookie</span></span><br><span class="line">&lt; <span class="string">&quot;a=3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把该字段的 max-age 设置为 -1</span></span><br><span class="line">&gt; <span class="variable language_">document</span>.<span class="property">cookie</span> = <span class="string">&#x27;a=3; max-age=-1&#x27;</span></span><br><span class="line">&lt; <span class="string">&quot;a=3; max-age=-1&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除成功</span></span><br><span class="line">&gt; <span class="variable language_">document</span>.<span class="property">cookie</span></span><br><span class="line">&lt; <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>同时，也可以使用最新关于 cookie 操作的 API: <a href="https://developer.mozilla.org/en-US/docs/Web/API/CookieStore">CookieStore API (opens new window)</a>其中的 <code>cookieStore.delete(name)</code> 删除某个 cookie</p><h3 id="如何判断当前环境是移动端还是-PC-端"><a href="#如何判断当前环境是移动端还是-PC-端" class="headerlink" title="如何判断当前环境是移动端还是 PC 端"></a>如何判断当前环境是移动端还是 PC 端</h3><p>判断 <code>navigator.userAgent</code>，对于 Android/iPhone 可以匹配以下正则</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> appleIphone = <span class="regexp">/iPhone/i</span>;</span><br><span class="line"><span class="keyword">const</span> appleIpod = <span class="regexp">/iPod/i</span>;</span><br><span class="line"><span class="keyword">const</span> appleTablet = <span class="regexp">/iPad/i</span>;</span><br><span class="line"><span class="keyword">const</span> androidPhone = <span class="regexp">/\bAndroid(?:.+)Mobile\b/i</span>; <span class="comment">// Match &#x27;Android&#x27; AND &#x27;Mobile&#x27;</span></span><br><span class="line"><span class="keyword">const</span> androidTablet = <span class="regexp">/Android/i</span>;</span><br></pre></td></tr></table></figure><p>当然，不要重复造轮子，推荐一个库: <a href="https://github.com/kaimallea/isMobile">https://github.com/kaimallea/isMobile(opens new window)</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> isMobile <span class="keyword">from</span> <span class="string">&quot;ismobilejs&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mobile = <span class="title function_">isMobile</span>();</span><br></pre></td></tr></table></figure><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">isPc() &#123;</span><br><span class="line">    var userAgentInfo = navigator.userAgent</span><br><span class="line">    var Agents = new Array(</span><br><span class="line">      &#x27;Android&#x27;,</span><br><span class="line">      &#x27;iPhone&#x27;,</span><br><span class="line">      &#x27;SymbianOS&#x27;,</span><br><span class="line">      &#x27;Windows Phone&#x27;,</span><br><span class="line">      &#x27;iPad&#x27;,</span><br><span class="line">      &#x27;iPod&#x27;</span><br><span class="line">    )</span><br><span class="line">    var flag = true</span><br><span class="line">    for (var v = 0; v &lt; Agents.length; v++) &#123;</span><br><span class="line">      if (userAgentInfo.indexOf(Agents[v]) &gt; 0) &#123;</span><br><span class="line">        flag = false</span><br><span class="line">        break</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return flag</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h3 id="什么是跨域，如何解决跨域问题"><a href="#什么是跨域，如何解决跨域问题" class="headerlink" title="什么是跨域，如何解决跨域问题"></a>什么是跨域，如何解决跨域问题</h3><h4 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h4><p><strong>协议</strong>，<strong>域名</strong>，<strong>端口</strong>，三者有一不一样，就是跨域</p><p>案例一：<code>www.baidu.com</code> 与 <code>zhidao.baidu.com</code> 是跨域</p><h4 id="如何解决跨域"><a href="#如何解决跨域" class="headerlink" title="如何解决跨域"></a>如何解决跨域</h4><p>目前有两种最常见的解决方案：</p><ol><li>CORS，在服务器端设置几个响应头，如 <code>Access-Control-Allow-Origin: *</code></li><li>Reverse Proxy，在 nginx/traefik/haproxy 等反向代理服务器中设置为同一域名</li><li>JSONP，详解见 <a href="https://github.com/shfshanyue/Daily-Question/issues/447">JSONP 的原理是什么，如何实现(opens new window)</a></li></ol><p>附代码: nginx 关于跨域的配置</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">  listen 80;</span><br><span class="line">  server_name shanyue.tech;</span><br><span class="line"></span><br><span class="line">  location / &#123;</span><br><span class="line">    # 避免非root路径404</span><br><span class="line">    try_files $uri $uri/ /index.html;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  # 解决跨域</span><br><span class="line">  location /api &#123;</span><br><span class="line">    # 或者是 http://localhost:8080</span><br><span class="line">    proxy_pass http://api.shanyue.tech;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="CSP-是什么"><a href="#CSP-是什么" class="headerlink" title="CSP 是什么"></a>CSP 是什么</h3><p><code>CSP</code> <strong>只允许加载指定的脚本及样式</strong>，<strong>最大限度地防止 <code>XSS</code> 攻击</strong>，是解决 XSS 的最优解。CSP 的设置根据加载页面时 http 的响应头 <code>Content Security Policy</code> 在服务器端控制。</p><ol><li>外部脚本可以通过指定域名来限制：**<code>Content-Security-Policy: script-src &#39;self&#39;</code>**，<code>self</code> 代表只加载当前域名</li><li>如果网站必须加载内联脚本 (inline script) ，则可以提供一个 <code>nonce</code> 才能执行脚本，攻击者则无法注入脚本进行攻击。**<code>Content-Security-Policy: script-src &#39;nonce-xxxxxxxxxxxxxxxxxx&#39;</code>**</li></ol><p>通过 <code>devtools -&gt; network</code> 可见 github 的 CSP 配置如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Content-Security-Policy: default-src <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">  base-uri <span class="string">&#x27;self&#x27;</span>;</span><br><span class="line">  block-all-mixed-content;</span><br><span class="line">  connect-src <span class="string">&#x27;self&#x27;</span> uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com www.google-analytics.com github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com cdn.optimizely.com logx.optimizely.com/v1/events wss://alive.github.com;</span><br><span class="line">  font-src github.githubassets.com;</span><br><span class="line">  form-action <span class="string">&#x27;self&#x27;</span> github.com gist.github.com;</span><br><span class="line">  frame-ancestors <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">  frame-src render.githubusercontent.com;</span><br><span class="line">  img-src <span class="string">&#x27;self&#x27;</span> data: github.githubassets.com identicons.github.com collector.githubapp.com github-cloud.s3.amazonaws.com *.githubusercontent.com;</span><br><span class="line">  manifest-src <span class="string">&#x27;self&#x27;</span>;</span><br><span class="line">  media-src <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">  script-src github.githubassets.com;</span><br><span class="line">  style-src <span class="string">&#x27;unsafe-inline&#x27;</span> github.githubassets.com;</span><br><span class="line">  worker-src github.com/socket-worker.js gist.github.com/socket-worker.js</span><br></pre></td></tr></table></figure><h3 id="prefetch-与-preload-的区别是什么"><a href="#prefetch-与-preload-的区别是什么" class="headerlink" title="prefetch 与 preload 的区别是什么"></a>prefetch 与 preload 的区别是什么</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;prefetch&quot;</span> <span class="attr">href</span>=<span class="string">&quot;style.css&quot;</span> <span class="attr">as</span>=<span class="string">&quot;style&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;preload&quot;</span> <span class="attr">href</span>=<span class="string">&quot;main.js&quot;</span> <span class="attr">as</span>=<span class="string">&quot;script&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><ol><li><code>preload</code> 加载当前路由必需资源，优先级高。一般对于 Bundle Spliting 资源与 Code Spliting 资源做 preload</li><li><code>prefetch</code> 优先级低，在浏览器 idle 状态时加载资源。一般用以加载其它路由资源，如当页面出现 Link，可 prefetch 当前 Link 的路由资源。（next.js 默认会对 link 做懒加载+prefetch，即当某条 Link 出现页面中，即自动 prefetch 该 Link 指向的路由资源</li></ol><h3 id="fetch-中-credentials-指什么意思，可以取什么值"><a href="#fetch-中-credentials-指什么意思，可以取什么值" class="headerlink" title="fetch 中 credentials 指什么意思，可以取什么值"></a>fetch 中 credentials 指什么意思，可以取什么值</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">credentials` 指在使用 `fetch` 发送请求时是否应当发送 `cookie</span><br></pre></td></tr></table></figure><ul><li><code>omit</code>: 从不发送 <code>cookie</code>.</li><li><code>same-origin</code>: 同源时发送 <code>cookie</code> (浏览器默认值)</li><li><code>include</code>: 同源与跨域时都发送 <code>cookie</code></li></ul><h3 id="当-cookie-没有设置-maxage-时，cookie-会存在多久"><a href="#当-cookie-没有设置-maxage-时，cookie-会存在多久" class="headerlink" title="当 cookie 没有设置 maxage 时，cookie 会存在多久"></a>当 cookie 没有设置 maxage 时，cookie 会存在多久</h3><p>不设置 max-age 和 expires，此 cookie 就是会话级别的，浏览器关闭就没了</p><h3 id="在浏览器中如何监听剪切板中内容-1"><a href="#在浏览器中如何监听剪切板中内容-1" class="headerlink" title="在浏览器中如何监听剪切板中内容"></a>在浏览器中如何监听剪切板中内容</h3><p>通过 <code>Clipboard API</code> 可以获取剪切板中内容，但需要获取到 <code>clipboard-read</code> 的权限，以下是关于读取剪贴板内容的代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 是否能够有读取剪贴板的权限</span></span><br><span class="line"><span class="comment">// result.state == &quot;granted&quot; || result.state == &quot;prompt&quot;</span></span><br><span class="line"><span class="keyword">const</span> result = <span class="keyword">await</span> navigator.<span class="property">permissions</span>.<span class="title function_">query</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;clipboard-read&quot;</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取剪贴板内容</span></span><br><span class="line"><span class="keyword">const</span> text = <span class="keyword">await</span> navigator.<span class="property">clipboard</span>.<span class="title function_">readText</span>();</span><br></pre></td></tr></table></figure><blockquote><p>注: 该方法在 <code>devtools</code> 中不生效</p></blockquote><h3 id="简单介绍-requestIdleCallback-及使用场景"><a href="#简单介绍-requestIdleCallback-及使用场景" class="headerlink" title="简单介绍 requestIdleCallback 及使用场景"></a>简单介绍 requestIdleCallback 及使用场景</h3><p><code>requestIdleCallback</code> 维护一个队列，将在浏览器空闲时间内执行。它属于 <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Background_Tasks_API">Background Tasks API (opens new window)</a>，你可以使用 <code>setTimeout</code> 来模拟实现</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">requestIdleCallback</span> =</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">requestIdleCallback</span> ||</span><br><span class="line">  <span class="keyword">function</span> (<span class="params">handler</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> startTime = <span class="title class_">Date</span>.<span class="title function_">now</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">handler</span>(&#123;</span><br><span class="line">        <span class="attr">didTimeout</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">timeRemaining</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="number">0</span>, <span class="number">50.0</span> - (<span class="title class_">Date</span>.<span class="title function_">now</span>() - startTime));</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;, <span class="number">1</span>);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><p>以上实现过于复杂以及细节化，也可以像 <a href="https://github.com/vercel/swr">swr (opens new window)</a>一样做一个简单的模拟实现，以下代码见 <a href="https://github.com/vercel/swr/blob/8670be8072b0c223bc1c040deccd2e69e8978aad/src/use-swr.ts#L33">https://github.com/vercel/swr/blob/8670be8072b0c223bc1c040deccd2e69e8978aad/src/use-swr.ts#L33(opens new window)</a></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> rIC = <span class="variable language_">window</span>[<span class="string">&quot;requestIdleCallback&quot;</span>] || (<span class="function">(<span class="params">f</span>) =&gt;</span> <span class="built_in">setTimeout</span>(f, <span class="number">1</span>));</span><br></pre></td></tr></table></figure><p>在 <code>rIC</code> 中执行任务时需要注意以下几点：</p><ol><li>执行重计算而非紧急任务</li><li>空闲回调执行时间应该小于 50ms，最好更少</li><li>空闲回调中不要操作 DOM，因为它本来就是利用的重排重绘后的间隙空闲时间，重新操作 DOM 又会造成重排重绘</li></ol><p>React 的时间分片便是基于类似 <code>rIC</code> 而实现，然而因为 <code>rIC</code> 的兼容性及 50ms 流畅问题，React 自制了一个实现: <a href="https://github.com/facebook/react/tree/master/packages/scheduler">scheduler(opens new window)</a></p><p><a href="https://github.com/vercel/swr">use-swr (opens new window)</a>中进行资源的 <code>revalidate</code> 时，也是通过 <code>rIC</code> 来提高性能</p><h3 id="JSONP-的原理是什么，如何实现"><a href="#JSONP-的原理是什么，如何实现" class="headerlink" title="JSONP 的原理是什么，如何实现"></a>JSONP 的原理是什么，如何实现</h3><h4 id="一个正常的请求-JSON"><a href="#一个正常的请求-JSON" class="headerlink" title="一个正常的请求: JSON"></a>一个正常的请求: JSON</h4><p>正常发请求时，<code>curl</code> 示例:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://shanyue.tech/api/user?<span class="built_in">id</span>=100</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 100,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;shanyue&quot;</span>,</span><br><span class="line">  <span class="string">&quot;wechat&quot;</span>: <span class="string">&quot;xxxxx&quot;</span>,</span><br><span class="line">  <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;183xxxxxxxx&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>使用 <code>fetch</code> 发送请求，示例:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">&quot;https://shanyue.tech/api/user?id=100&quot;</span>, &#123;</span><br><span class="line">  <span class="attr">headers</span>: &#123;</span><br><span class="line">    <span class="string">&quot;content-type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> res.<span class="title function_">json</span>());</span><br></pre></td></tr></table></figure><p>请求数据后，使用一个函数来处理数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">handleData</span>(data);</span><br></pre></td></tr></table></figure><h4 id="一个-JSONP-请求"><a href="#一个-JSONP-请求" class="headerlink" title="一个 JSONP 请求"></a>一个 JSONP 请求</h4><p><code>JSONP</code>，全称 <code>JSON with Padding</code>，为了解决跨域的问题而出现。虽然它只能处理 GET 跨域，虽然现在基本上都使用 CORS 跨域，但仍然要知道它，毕竟<strong>面试会问</strong>。</p><p><code>JSONP</code> 基于两个原理:</p><ol><li>动态创建 <code>script</code>，使用 <code>script.src</code> 加载请求跨过跨域</li><li><code>script.src</code> 加载的脚本内容为 JSONP: 即 <code>PADDING(JSON)</code> 格式</li></ol><p>从上可知，使用 <code>JSONP</code> 跨域同样需要服务端的支持。<code>curl</code> 示例</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://shanyue.tech/api/user?<span class="built_in">id</span>=100&amp;callback=padding</span><br><span class="line"></span><br><span class="line">padding(&#123;</span><br><span class="line">  <span class="string">&quot;id&quot;</span>: 100,</span><br><span class="line">  <span class="string">&quot;name&quot;</span>: <span class="string">&quot;shanyue&quot;</span>,</span><br><span class="line">  <span class="string">&quot;wechat&quot;</span>: <span class="string">&quot;xxxxx&quot;</span>,</span><br><span class="line">  <span class="string">&quot;phone&quot;</span>: <span class="string">&quot;183xxxxxxxx&quot;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>对于正常的请求有何不同一目了然: <strong>多了一个 callback=padding, 并且响应数据被 padding 包围</strong>，这就是 JSONP</p><p><strong>那请求数据后，如何处理数据呢？此时的 padding 就是处理数据的函数</strong>。我们只需要在前端实现定义好 padding 函数即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">padding</span> = handleData;</span><br></pre></td></tr></table></figure><p>基于以上两个原理，这里实现一个简单 jsonp 函数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp_simple</span>(<span class="params">&#123; url, onData, params &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一、默认 callback 函数为 padding</span></span><br><span class="line">  script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?<span class="subst">$&#123;stringify(&#123; callback: <span class="string">&quot;padding&quot;</span>, ...params &#125;)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 二、使用 onData 作为 window.padding 函数，接收数据</span></span><br><span class="line">  <span class="variable language_">window</span>[<span class="string">&quot;padding&quot;</span>] = onData;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 三、动态加载脚本</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送 JSONP 请求</span></span><br><span class="line"><span class="title function_">jsonp_simple</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;http://localhost:10010&quot;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123; <span class="attr">id</span>: <span class="number">10000</span> &#125;,</span><br><span class="line">  <span class="title function_">onData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Data:&quot;</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>此时会有一个问题: <strong>window.padding 函数会污染全局变量，如果有多个 JSONP 请求发送如何处理？</strong></p><p><strong>使 jsonp 的回调函数名作为一个随机变量，避免冲突</strong>，代码如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp</span>(<span class="params">&#123; url, onData, params &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一、为了避免全局污染，使用一个随机函数名</span></span><br><span class="line">  <span class="keyword">const</span> cbFnName = <span class="string">`JSONP_PADDING_<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString().slice(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 二、默认 callback 函数为 cbFnName</span></span><br><span class="line">  script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?<span class="subst">$&#123;stringify(&#123; callback: cbFnName, ...params &#125;)&#125;</span>`</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 三、使用 onData 作为 cbFnName 回调函数，接收数据</span></span><br><span class="line">  <span class="variable language_">window</span>[cbFnName] = onData;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 发送 JSONP 请求</span></span><br><span class="line"><span class="title function_">jsonp</span>(&#123;</span><br><span class="line">  <span class="attr">url</span>: <span class="string">&quot;http://localhost:10010&quot;</span>,</span><br><span class="line">  <span class="attr">params</span>: &#123; <span class="attr">id</span>: <span class="number">10000</span> &#125;,</span><br><span class="line">  <span class="title function_">onData</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Data:&quot;</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="服务器端代码"><a href="#服务器端代码" class="headerlink" title="服务器端代码"></a>服务器端代码</h4><p><code>JSONP</code> 需要服务端进行配合，返回 <code>JSON With Padding</code> 数据，代码如下:</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; pathname, query &#125; = url.<span class="title function_">parse</span>(req.<span class="property">url</span>);</span><br><span class="line">  <span class="keyword">const</span> params = qs.<span class="title function_">parse</span>(query);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = &#123; <span class="attr">name</span>: <span class="string">&quot;shanyue&quot;</span>, <span class="attr">id</span>: params.<span class="property">id</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (params.<span class="property">callback</span>) &#123;</span><br><span class="line">    <span class="comment">// 服务端将要返回的字符串</span></span><br><span class="line">    str = <span class="string">`<span class="subst">$&#123;params.callback&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span>;</span><br><span class="line">    res.<span class="title function_">end</span>(str);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">10010</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Done&quot;</span>));</span><br></pre></td></tr></table></figure><h4 id="完整代码附录"><a href="#完整代码附录" class="headerlink" title="完整代码附录"></a>完整代码附录</h4><p>完整代码可见<a href="https://github.com/shfshanyue/blog/tree/master/code">山月博客的 github 仓库 (opens new window)</a>: <a href="https://github.com/shfshanyue/blog/tree/master/code/jsonp/">https://github.com/shfshanyue/blog/tree/master/code/jsonp/(opens new window)</a></p><p><strong>JSONP 实现完整代码:</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">stringify</span>(<span class="params">data</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> pairs = <span class="title class_">Object</span>.<span class="title function_">entries</span>(data);</span><br><span class="line">  <span class="keyword">const</span> qs = pairs</span><br><span class="line">    .<span class="title function_">map</span>(<span class="function">(<span class="params">[k, v]</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">let</span> noValue = <span class="literal">false</span>;</span><br><span class="line">      <span class="keyword">if</span> (v === <span class="literal">null</span> || v === <span class="literal">undefined</span> || <span class="keyword">typeof</span> v === <span class="string">&quot;object&quot;</span>) &#123;</span><br><span class="line">        noValue = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(k)&#125;</span>=<span class="subst">$&#123;noValue ? <span class="string">&quot;&quot;</span> : <span class="built_in">encodeURIComponent</span>(v)&#125;</span>`</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">join</span>(<span class="string">&quot;&amp;&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> qs;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">jsonp</span>(<span class="params">&#123; url, onData, params &#125;</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一、为了避免全局污染，使用一个随机函数名</span></span><br><span class="line">  <span class="keyword">const</span> cbFnName = <span class="string">`JSONP_PADDING_<span class="subst">$&#123;<span class="built_in">Math</span>.random().toString().slice(<span class="number">2</span>)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// 二、默认 callback 函数为 cbFnName</span></span><br><span class="line">  script.<span class="property">src</span> = <span class="string">`<span class="subst">$&#123;url&#125;</span>?<span class="subst">$&#123;stringify(&#123; callback: cbFnName, ...params &#125;)&#125;</span>`</span>;</span><br><span class="line">  <span class="comment">// 三、使用 onData 作为 cbFnName 回调函数，接收数据</span></span><br><span class="line">  <span class="variable language_">window</span>[cbFnName] = onData;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>JSONP 服务端适配相关代码:</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> http = <span class="built_in">require</span>(<span class="string">&quot;http&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> url = <span class="built_in">require</span>(<span class="string">&quot;url&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> qs = <span class="built_in">require</span>(<span class="string">&quot;querystring&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> server = http.<span class="title function_">createServer</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; pathname, query &#125; = url.<span class="title function_">parse</span>(req.<span class="property">url</span>);</span><br><span class="line">  <span class="keyword">const</span> params = qs.<span class="title function_">parse</span>(query);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = &#123; <span class="attr">name</span>: <span class="string">&quot;shanyue&quot;</span>, <span class="attr">id</span>: params.<span class="property">id</span> &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (params.<span class="property">callback</span>) &#123;</span><br><span class="line">    str = <span class="string">`<span class="subst">$&#123;params.callback&#125;</span>(<span class="subst">$&#123;<span class="built_in">JSON</span>.stringify(data)&#125;</span>)`</span>;</span><br><span class="line">    res.<span class="title function_">end</span>(str);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    res.<span class="title function_">end</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">server.<span class="title function_">listen</span>(<span class="number">10010</span>, <span class="function">() =&gt;</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Done&quot;</span>));</span><br></pre></td></tr></table></figure><p><strong>JSONP 页面调用相关代码</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./index.js&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">jsonp</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">url</span>: <span class="string">&quot;http://localhost:10010&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">params</span>: &#123; <span class="attr">id</span>: <span class="number">10000</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">onData</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Data:&quot;</span>, data);</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="JSONP-实现代码示例演示"><a href="#JSONP-实现代码示例演示" class="headerlink" title="JSONP 实现代码示例演示"></a>JSONP 实现代码示例演示</h4><ul><li>从中克隆代码: <a href="https://github.com/shfshanyue/blog/tree/master/code">山月博客的 github 仓库(opens new window)</a></li><li>从中克隆代码: <a href="https://github.com/shfshanyue/blog/tree/master/code">山月博客的 github 仓库(opens new window)</a></li><li>从中克隆代码: <a href="https://github.com/shfshanyue/blog/tree/master/code">山月博客的 github 仓库(opens new window)</a></li></ul><h5 id="文件结构"><a href="#文件结构" class="headerlink" title="文件结构"></a>文件结构</h5><ul><li><code>index.js</code>: jsonp 的简单与复杂实现</li><li><code>server.js</code>: 服务器接口形式</li><li><code>demo.html</code>: 前端如何调用 JSONP</li></ul><h5 id="快速演示"><a href="#快速演示" class="headerlink" title="快速演示"></a>快速演示</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 开启服务端</span></span><br><span class="line">$ node server.<span class="property">js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对 demo.html 起一个服务，并且按照提示在浏览器中打开地址，应该是 http://localhost:5000</span></span><br><span class="line"><span class="comment">// 观察控制台输出 JSONP 的回调结果</span></span><br><span class="line">$ serve .</span><br></pre></td></tr></table></figure><h3 id="如何实现页面文本不可复制"><a href="#如何实现页面文本不可复制" class="headerlink" title="如何实现页面文本不可复制"></a>如何实现页面文本不可复制</h3><p>有 CSS 和 JS 两种方法，以下任选其一或结合使用</p><p>使用 CSS 如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">user-select: none;</span><br></pre></td></tr></table></figure><p>或使用 JS 如下，监听 <code>selectstart</code> 事件，禁止选中。</p><p>当用户选中一片区域时，将触发 <code>selectstart</code> 事件，Selection API 将会选中一片区域。禁止选中区域即可实现页面文本不可复制。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">onselectstart</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">oncopy</span> = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="异步加载-JS-脚本时，async-与-defer-有何区别"><a href="#异步加载-JS-脚本时，async-与-defer-有何区别" class="headerlink" title="异步加载 JS 脚本时，async 与 defer 有何区别"></a>异步加载 JS 脚本时，async 与 defer 有何区别</h3><blockquote><p>以下图片取自 whatwg 的规范，可以说是最权威的图文解释了，详细参考<a href="https://html.spec.whatwg.org/multipage/scripting.html#the-script-element">原文(opens new window)</a></p></blockquote><p><img src="https://html.spec.whatwg.org/images/asyncdefer.svg" alt="async 与 defer 区别"></p><p>在<em>正常情况下</em>，即 <code>&lt;script&gt;</code> 没有任何额外属性标记的情况下，有几点共识</p><ol><li>JS 的脚本分为<strong>加载、解析、执行</strong>几个步骤，简单对应到图中就是 <code>fetch</code> (加载) 和 <code>execution</code> (解析并执行)</li><li><strong>JS 的脚本加载(fetch)且执行(execution)会阻塞 DOM 的渲染</strong>，因此 JS 一般放到最后头</li></ol><p>而 <code>defer</code> 与 <code>async</code> 的区别如下:</p><ul><li>相同点: <strong>异步加载 (fetch)</strong></li><li>不同点:<ul><li>async 加载(fetch)完成后立即执行 (execution)，因此可能会阻塞 DOM 解析；</li><li>defer 加载(fetch)完成后延迟到 DOM 解析完成后才会执行(execution)**，但会在事件 <code>DomContentLoaded</code> 之前</li></ul></li></ul><h4 id="拓展"><a href="#拓展" class="headerlink" title="拓展"></a>拓展</h4><p>当以下 <code>index.js</code> 加载时，属性是 <code>async</code> 与 <code>defer</code> 时，输出有何不同？</p><p><strong>index.html</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./defer.js&quot;</span> <span class="attr">defer</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./async.js&quot;</span> <span class="attr">async</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Start&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;DCL&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>derfer.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Defer Script&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>async.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Async Script&quot;</span>);</span><br></pre></td></tr></table></figure><p>答：defer 总是在 DCL 之前输出，但是 async 有可能之前也有可能之后</p><h3 id="load-事件与-DomContentLoaded-事件的先后顺序"><a href="#load-事件与-DomContentLoaded-事件的先后顺序" class="headerlink" title="load 事件与 DomContentLoaded 事件的先后顺序"></a>load 事件与 DomContentLoaded 事件的先后顺序</h3><p>当初始的 <code>HTML</code> 文档被完全加载和解析完成之后，<code>DOMContentLoaded</code> 事件被触发，而无需等待样式表、图像和子框架的完全加载.</p><p>当整个页面及所有依赖资源如样式表和图片都已完成加载时，将触发<code>load</code>事件</p><h3 id="React-Vue-中的-router-实现原理如何"><a href="#React-Vue-中的-router-实现原理如何" class="headerlink" title="React/Vue 中的 router 实现原理如何"></a>React/Vue 中的 router 实现原理如何</h3><p>前端路由实现的本质是<strong>监听 url 变化</strong>，实现方式有两种：Hash 模式和 History 模式，无需刷新页面就能重新加载相应的页面。 Hash url 的格式为<code>www.a.com/#/</code>，当#后的哈希值发生变化时，通过 hashchange 事件监听，然后页面跳转。 History url 通过<code>history.pushState</code>和<code>history.replaceState</code>改变 url。 两种模式的区别：</p><ul><li>hash 只能改变#后的值，而 history 模式可以随意设置同源 url；</li><li>hash 只能添加字符串类的数据，而 history 可以通过 API 添加多种类型的数据；</li><li>hash 的历史记录只显示之前的<code>www.a.com</code>而不会显示 hash 值，而 history 的每条记录都会进入到历史记录；</li><li>hash 无需后端配置且兼容性好，而 history 需要配置<code>index.html</code>用于匹配不到资源的情况。</li></ul><h3 id="什么是-HTML-的实体编码-HTML-Entity-Encode-1"><a href="#什么是-HTML-的实体编码-HTML-Entity-Encode-1" class="headerlink" title="什么是 HTML 的实体编码 (HTML Entity Encode)"></a>什么是 HTML 的实体编码 (HTML Entity Encode)</h3><p>HTML 实体是一段以连字号（&amp;）开头、以分号（;）结尾的字符串。用以显示不可见字符及保留字符 (如 HTML 标签)</p><p>在前端，一般为了避免 XSS 攻击，会将 <code>&lt;&gt;</code> 编码为 <code>&lt;</code> 与 <code>&gt;</code>，这些就是 HTML 实体编码。</p><p>在 <a href="https://html.spec.whatwg.org/multipage/named-characters.html#named-character-references">whatwg (opens new window)</a>中可查看实体编码数据。</p><p>在 HTML 转义时，仅仅只需要对六个字符进行编码: <code>&amp;</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&quot;</code>, <code>&#39;</code>, ```。可使用 <a href="https://npm.devtool.tech/he">he (opens new window)</a>这个库进行编码及转义</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 实体编码</span></span><br><span class="line">&gt; he.<span class="title function_">encode</span>(<span class="string">&#x27;&lt;img src=&quot;&quot;&gt;&lt;/img&gt;&#x27;</span>)</span><br><span class="line">&lt; <span class="string">&quot;&amp;#x3C;img src=&amp;#x22;&amp;#x22;&amp;#x3E;&amp;#x3C;/img&amp;#x3E;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 转义</span></span><br><span class="line">&gt; he.<span class="built_in">escape</span>(<span class="string">&#x27;&lt;img src=&quot;&quot;&gt;&lt;/img&gt;&#x27;</span>)</span><br><span class="line">&lt; <span class="string">&quot;&amp;lt;img src=&amp;quot;&amp;quot;&amp;gt;&amp;lt;/img&amp;gt;&quot;</span></span><br></pre></td></tr></table></figure><h3 id="DOM-中如何阻止事件默认行为，如何判断事件否可阻止？"><a href="#DOM-中如何阻止事件默认行为，如何判断事件否可阻止？" class="headerlink" title="DOM 中如何阻止事件默认行为，如何判断事件否可阻止？"></a>DOM 中如何阻止事件默认行为，如何判断事件否可阻止？</h3><ul><li><code>e.preventDefault()</code>: 取消事件</li><li><code>e.cancelable</code>: 事件是否可取消</li></ul><p>如果 passive 设置为 true 那其实 preventDefault 就会无效 因为 passive 为 true 会导致初始化的时候 cancelable 为 false</p><p>event.preventDefault 不能取消的没有固定哪一个类 主要是在规范中有没有定义 Default Action 还有即使是定义了 Default Action 那在实际中可能也会在不同的触发时间存在或不存在默认行为 所以可以依赖 event.cancelable 来处理 Default Action</p><h3 id="什么是事件冒泡和事件捕获"><a href="#什么是事件冒泡和事件捕获" class="headerlink" title="什么是事件冒泡和事件捕获"></a>什么是事件冒泡和事件捕获</h3><h4 id="事件"><a href="#事件" class="headerlink" title="事件"></a>事件</h4><p><strong>事件</strong> 表示的其实就是文档或浏览器窗口中某个特殊的时刻，javaScript更够与html进行交互就是通过事件实现的</p><h4 id="事件流"><a href="#事件流" class="headerlink" title="事件流"></a>事件流</h4><p><strong>事件流</strong> 描述的就是页面接收事件的顺序 事件流主要分为两种，一种是事件冒泡流， 一种是事件捕获流</p><h4 id="事件冒泡流"><a href="#事件冒泡流" class="headerlink" title="事件冒泡流"></a>事件冒泡流</h4><p>事件冒泡流就是指事件会从一个具体的元素开始触发，然后不断向上传递最终传递给document 也就是说 事件从一个具体的元素不断向上传递给不具体的元素， 用圆圈比喻 就是 从圆心向外传递</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div id=&quot;myDiv&quot;&gt;Click me&lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>事件冒泡流事件传递顺序： <code>&lt;div&gt; -&gt; &lt;body&gt; -&gt; &lt;html&gt; -&gt; document</code></p><h4 id="事件捕获流"><a href="#事件捕获流" class="headerlink" title="事件捕获流"></a>事件捕获流</h4><p>事件捕获流所描述的事件传播方向与事件冒泡流刚好相反， 事件捕获流是指 事件会从不具体的元素传递给具体的元素，相当于是事件最开始是从最外部触发，然后不断向内传递，最终传递给具体的元素 还是用圆圈比喻的话 就是从圆圈外部不断向圆心传递</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;head&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/head&gt;</span><br><span class="line">    &lt;body&gt;</span><br><span class="line">        &lt;div id=&quot;myDiv&quot;&gt;Click me&lt;/div&gt;</span><br><span class="line">    &lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><p>事件捕获流传递顺序：<code>document -&gt; &lt;html&gt; -&gt; &lt;body&gt; -&gt; &lt;div&gt;</code></p><h4 id="DOM事件流"><a href="#DOM事件流" class="headerlink" title="DOM事件流"></a>DOM事件流</h4><p>DOM2 Event规范规定了事件流分为三个阶段：事件捕获，到达目标，事件冒泡 也就是说一个事件触发，</p><ul><li>先是事件捕获，从外到内</li><li>然后到达具体的触发这个事件的元素，</li><li>最后事件冒泡，从内到外</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">  &lt;div class=&quot;item&quot;&gt;</span><br><span class="line">    &lt;button class=&#x27;btn&#x27;&gt;Click me&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">const container = document.querySelector(&#x27;.container&#x27;)</span><br><span class="line">const item = document.querySelector(&#x27;.item&#x27;);</span><br><span class="line">const btn = document.querySelector(&#x27;.btn&#x27;);</span><br><span class="line"></span><br><span class="line">document.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;Document click&quot;);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">document.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;Document click when capture&quot;);</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  capture: true // 表明在捕获阶段就触发</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">container.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;container click&quot;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">// 捕获阶段</span><br><span class="line">container.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;container click when capture&quot;);</span><br><span class="line">&#125;, &#123;</span><br><span class="line">  capture: true // 表明在捕获阶段捕获</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">item.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;item click&quot;);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">btn.addEventListener(&#x27;click&#x27;, (event) =&gt; &#123;</span><br><span class="line">  console.log(&quot;btn click&quot;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>输出 “Document click when capture” “container click when capture” “btn click” “item click” “container click” “Document click”</p><p>输出 说明 DOM事件流 会先进行事件捕获流(从外向内), 然后到达目标, 最后进行时间冒泡流(从内向外)</p><h4 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h4><p>事件委托 就是 如果有很多元素要写事件监听(也就是事件处理程序)，那么可以给所有元素的共同父元素添加一个事件处理程序, 然后因为事件冒泡流的存在, 在子元素上触发的事件最终会传递给父元素，所以在父元素上也可以监听到在子元素上触发的事件，从而提高页面效率</p><p>eg</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;ul id=&quot;myLink&quot;&gt;</span><br><span class="line">    &lt;li id=&quot;goSomeWhere&quot;&gt;goSomeWhere&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;doSomeThing&quot;&gt;doSomething&lt;/li&gt;</span><br><span class="line">    &lt;li id=&quot;sayHi&quot;&gt;sayHi&lt;/li&gt;</span><br><span class="line">&lt;/ul&gt;</span><br></pre></td></tr></table></figure><p>没有事件委托的代码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">const item1 = document.querySelector(&quot;#goSomeWhere&quot;);</span><br><span class="line">const item2 = document.querySelector(&quot;#doSomeThing&quot;);</span><br><span class="line">const item3 = document.querySelector(&quot;#sayHi&quot;);</span><br><span class="line"></span><br><span class="line">item1.addEventListener(&#x27;click&#x27;, (e) =&gt; &#123;</span><br><span class="line">    location.href = &quot;http://www.baidu.com&quot;;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">item2.addEventListener(&#x27;click&#x27;, (e) =&gt; &#123;</span><br><span class="line">    document.title = &#x27;Change Document title&#x27;;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">item3.addEventListener(&#x27;click&#x27;, (e) =&gt; &#123;</span><br><span class="line">    console.log(&#x27;Say hi&#x27;);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>事件委托, 只在父元素ul上面添加一个事件监听</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">const list = document.querySelector(&#x27;#myLink&#x27;);</span><br><span class="line"></span><br><span class="line">document.addEventListener(&#x27;click&#x27;, (e)=&gt; &#123;</span><br><span class="line">    const target = e.target; // 获取是具体在哪一个元素上触发的事件</span><br><span class="line"></span><br><span class="line">    switch(target.id) &#123;</span><br><span class="line">        case &#x27;goSomeWhere&#x27;:</span><br><span class="line">            location.href = &#x27;http://www.google.com&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case &#x27;goSomeWhere&#x27;:</span><br><span class="line">            document.title = &#x27;Change Document title&#x27;;</span><br><span class="line">            break;</span><br><span class="line">        case &#x27;sayHi&#x27;:</span><br><span class="line">            console.log(&#x27;sayHi&#x27;);</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="事件委托的优点"><a href="#事件委托的优点" class="headerlink" title="事件委托的优点"></a>事件委托的优点</h4><ol><li>document对象随时可用，任何时候可以给他添加事件监听</li><li>节省花在设置页面事件处理程序上的时间，只需要在一个DOM上设置事件监听</li><li>减少整个页面所需要的内存，提升整体性能</li></ol><h3 id="什么是事件委托，e-currentTarget-与-e-target-有何区别"><a href="#什么是事件委托，e-currentTarget-与-e-target-有何区别" class="headerlink" title="什么是事件委托，e.currentTarget 与 e.target 有何区别"></a>什么是事件委托，e.currentTarget 与 e.target 有何区别</h3><p><img src="https://user-images.githubusercontent.com/13389461/120127876-31b39b00-c1f3-11eb-8297-ca155f3b4562.png"></p><p>事件委托指当有大量子元素触发事件时，将事件监听器绑定在父元素进行监听，此时数百个事件监听器变为了一个监听器，提升了网页性能。</p><p>另外，React 把所有事件委托在 Root Element，用以提升性能。</p><blockquote><p>Event 接口的只读属性 currentTarget 表示的，标识是当事件沿着 DOM 触发时事件的当前目标。它总是指向事件绑定的元素，而 Event.target 则是事件触发的元素。</p></blockquote><h3 id="浏览器中-cookie-有哪些字段"><a href="#浏览器中-cookie-有哪些字段" class="headerlink" title="浏览器中 cookie 有哪些字段"></a>浏览器中 cookie 有哪些字段</h3><ul><li>Domain</li><li>Path</li><li>Expire/MaxAge</li><li>HttpOnly</li><li>Secure</li><li>SameSite</li></ul><h3 id="sessionStorage-与-localStorage-有何区别"><a href="#sessionStorage-与-localStorage-有何区别" class="headerlink" title="sessionStorage 与 localStorage 有何区别"></a>sessionStorage 与 localStorage 有何区别</h3><p>localStorage 生命周期是永久除非自主清除 sessionStorage 生命周期为当前窗口或标签页，关闭窗口或标签页则会清除数据</p><p>他们均只能存储字符串类型的对象</p><p>不同浏览器无法共享 localStorage 或 sessionStorage 中的信息。相同浏览器的不同页面间可以共享相同的 localStorage（页面属于相同域名和端口），但是不同页面或标签页间无法共享 sessionStorage 的信息。这里需要注意的是，页面及标 签页仅指顶级窗口，如果一个标签页包含多个 iframe 标签且他们属于同源页面，那么他们之间是可以共享 sessionStorage 的。</p><h3 id="如何设置一个支持过期时间的-localStorage"><a href="#如何设置一个支持过期时间的-localStorage" class="headerlink" title="如何设置一个支持过期时间的 localStorage"></a>如何设置一个支持过期时间的 localStorage</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">initLocalStorage</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="property">setItem</span> = <span class="keyword">function</span> (<span class="params">key, value, time = <span class="number">1000</span></span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> expiresTime = <span class="title class_">Date</span>.<span class="title function_">now</span>() + time * <span class="number">1000</span>;</span><br><span class="line">    <span class="keyword">const</span> payload = &#123;</span><br><span class="line">      <span class="attr">__data</span>: value,</span><br><span class="line">      <span class="attr">__expiresTime</span>: expiresTime,</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="title class_">Storage</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">setItem</span>.<span class="title function_">call</span>(<span class="variable language_">localStorage</span>, key, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(payload));</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="variable language_">localStorage</span>.<span class="property">getItem</span> = <span class="keyword">function</span> (<span class="params">key</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="title class_">Storage</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getItem</span>.<span class="title function_">call</span>(<span class="variable language_">localStorage</span>, key);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> value === <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> jsonVal = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(value);</span><br><span class="line">      <span class="keyword">if</span> (jsonVal.<span class="property">__expiresTime</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (jsonVal.<span class="property">__expiresTime</span> &gt;= <span class="title class_">Date</span>.<span class="title function_">now</span>()) &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(jsonVal.<span class="property">__data</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> value;</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">initLocalStorage</span>();</span><br></pre></td></tr></table></figure><h3 id="如何统计当前页面出现的所有标签"><a href="#如何统计当前页面出现的所有标签" class="headerlink" title="如何统计当前页面出现的所有标签"></a>如何统计当前页面出现的所有标签</h3><ul><li><code>document.querySelectorAll(&#39;*&#39;)</code></li><li><code>document.getElementsByTagName(&#39;*&#39;)</code></li><li><code>$$(&#39;*&#39;)</code>，可在浏览器控制台使用</li><li><code>document.all</code>，已废弃，不建议使用</li></ul><h3 id="在浏览器中点击-a-标签保存为文件如何做"><a href="#在浏览器中点击-a-标签保存为文件如何做" class="headerlink" title="在浏览器中点击 a 标签保存为文件如何做"></a>在浏览器中点击 a 标签保存为文件如何做</h3><p>有两种方式:</p><ol><li><code>a.download</code> 当指定 a 标签的 <code>download</code> 属性时，点击该链接会直接保存为文件，文件名为 <code>download</code> 属性</li><li>通过对 a 标签指定的 URL 在服务器设置响应头 <code>Content-Disposition: attachment; filename=&quot;filename.jpg&quot;</code> 可直接下载</li></ol><h3 id="浏览器中监听事件函数-addEventListener-第三个参数有那些值"><a href="#浏览器中监听事件函数-addEventListener-第三个参数有那些值" class="headerlink" title="浏览器中监听事件函数 addEventListener 第三个参数有那些值"></a>浏览器中监听事件函数 addEventListener 第三个参数有那些值</h3><ul><li>capture。监听器会在时间捕获阶段传播到 event.target 时触发。</li><li>passive。监听器不会调用 preventDefault()。</li><li>once。监听器只会执行一次，执行后移除。</li><li>singal。调用 abort()移除监听器。</li></ul><h3 id="浏览器中-Frame-与-Event-Loop-的关系是什么"><a href="#浏览器中-Frame-与-Event-Loop-的关系是什么" class="headerlink" title="浏览器中 Frame 与 Event Loop 的关系是什么"></a>浏览器中 Frame 与 Event Loop 的关系是什么</h3><p>浏览器组成中有两大引擎，JS 引擎和渲染引擎。</p><p>Frame(帧)是渲染引擎每隔 16ms(默认 60fps)将渲染树渲染、合成成位图的结果</p><p>每次 Event Loop 是 JS 引擎执行的一个周期，执行过程中可能依赖渲染引擎的执行结果，比如访问 DOM 和 CSSOM，也可能影响渲染引擎绘制帧，比如调用 requestAnimationFrame，在每个帧开始绘制时执行一段回调函数(通常包含影响渲染结果的代码)</p><p>因此 Frame 和 Event Loop 是相对独立运行的，但是 Event Loop 中执行的代码可能依赖或影响 Frame</p><h2 id="javascript"><a href="#javascript" class="headerlink" title="javascript"></a>javascript</h2><h3 id="什么是防抖和节流，他们的应用场景有哪些"><a href="#什么是防抖和节流，他们的应用场景有哪些" class="headerlink" title="什么是防抖和节流，他们的应用场景有哪些"></a>什么是防抖和节流，他们的应用场景有哪些</h3><h4 id="防抖-debounce"><a href="#防抖-debounce" class="headerlink" title="防抖 (debounce)"></a>防抖 (debounce)</h4><p>防抖，顾名思义，防止抖动，以免把一次事件误认为多次，敲键盘就是一个每天都会接触到的防抖操作。</p><p>想要了解一个概念，必先了解概念所应用的场景。在 JS 这个世界中，有哪些防抖的场景呢</p><ol><li>登录、发短信等按钮避免用户点击太快，以致于发送了多次请求，需要防抖</li><li>调整浏览器窗口大小时，resize 次数过于频繁，造成计算过多，此时需要一次到位，就用到了防抖</li><li>文本编辑器实时保存，当无任何更改操作一秒后进行保存</li></ol><p>代码如下，可以看出来<strong>防抖重在清零 <code>clearTimeout(timer)</code></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">debounce</span>(<span class="params">f, wait</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">clearTimeout</span>(timer);</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">f</span>(...args);</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="节流-throttle"><a href="#节流-throttle" class="headerlink" title="节流 (throttle)"></a>节流 (throttle)</h4><p>节流，顾名思义，控制水的流量。控制事件发生的频率，如控制为 1s 发生一次，甚至 1 分钟发生一次。与服务端(server)及网关(gateway)控制的限流 (Rate Limit) 类似。</p><ol><li><code>scroll</code> 事件，每隔一秒计算一次位置信息等</li><li>浏览器播放事件，每个一秒计算一次进度信息等</li><li>input 框实时搜索并发送请求展示下拉列表，每隔一秒发送一次请求 (也可做防抖)</li></ol><p>代码如下，可以看出来<strong>节流重在加锁 <code>timer=timeout</code></strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">throttle</span>(<span class="params">f, wait</span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> timer;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">(<span class="params">...args</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (timer) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    timer = <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">f</span>(...args);</span><br><span class="line">      timer = <span class="literal">null</span>;</span><br><span class="line">    &#125;, wait);</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="总结-简要答案"><a href="#总结-简要答案" class="headerlink" title="总结 (简要答案)"></a>总结 (简要答案)</h4><ul><li>防抖：防止抖动，单位时间内事件触发会被重置，避免事件被误伤触发多次。**代码实现重在清零 <code>clearTimeout</code>**。防抖可以比作等电梯，只要有一个人进来，就需要再等一会儿。业务场景有避免登录按钮多次点击的重复提交。</li><li>节流：控制流量，单位时间内事件只能触发一次，与服务器端的限流 (Rate Limit) 类似。**代码实现重在开锁关锁 <code>timer=timeout; timer=null</code>**。节流可以比作过红绿灯，每等一个红灯时间就可以过一批。</li></ul><h3 id="如何实现一个简单的-Promise"><a href="#如何实现一个简单的-Promise" class="headerlink" title="如何实现一个简单的 Promise"></a>如何实现一个简单的 Promise</h3><p>一个简单的 <code>Promise</code> 的粗糙实现，关键点在于</p><ol><li>当 <code>pending</code> 时， <code>thenable</code> 函数由一个队列维护</li><li>当状态变为 <code>resolved(fulfilled)</code> 时，队列中所有 <code>thenable</code> 函数执行</li><li>当 <code>resolved</code> 时， <code>thenable</code> 函数直接执行</li></ol><p><code>rejected</code> 状态同理</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Prom</span> &#123;</span><br><span class="line">  <span class="keyword">static</span> <span class="title function_">resolve</span>(<span class="params">value</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (value &amp;&amp; value.<span class="property">then</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> value;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Prom</span>(<span class="function">(<span class="params">resolve</span>) =&gt;</span> <span class="title function_">resolve</span>(value));</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">constructor</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">value</span> = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">reason</span> = <span class="literal">undefined</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&quot;PENDING&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 维护一个 resolve/pending 的函数队列</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">resolveFns</span> = [];</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">rejectFns</span> = [];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">resolve</span> = (<span class="params">value</span>) =&gt; &#123;</span><br><span class="line">      <span class="comment">// 注意此处的 setTimeout</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&quot;RESOLVED&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">value</span> = value;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">resolveFns</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">&#123; fn, resolve: res, reject: rej &#125;</span>) =&gt;</span></span><br><span class="line">          <span class="title function_">res</span>(<span class="title function_">fn</span>(value))</span><br><span class="line">        );</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">reject</span> = (<span class="params">e</span>) =&gt; &#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">status</span> = <span class="string">&quot;REJECTED&quot;</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">reason</span> = e;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">rejectFns</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">&#123; fn, resolve: res, reject: rej &#125;</span>) =&gt;</span></span><br><span class="line">          <span class="title function_">rej</span>(<span class="title function_">fn</span>(e))</span><br><span class="line">        );</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">fn</span>(resolve, reject);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">then</span>(<span class="params">fn</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> === <span class="string">&quot;RESOLVED&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">fn</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">      <span class="comment">// 需要返回一个 Promise</span></span><br><span class="line">      <span class="comment">// 如果状态为 resolved，直接执行</span></span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Prom</span>.<span class="title function_">resolve</span>(result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> === <span class="string">&quot;PENDING&quot;</span>) &#123;</span><br><span class="line">      <span class="comment">// 也是返回一个 Promise</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Prom</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="comment">// 推进队列中，resolved 后统一执行</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">resolveFns</span>.<span class="title function_">push</span>(&#123; fn, resolve, reject &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">catch</span>(fn) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> === <span class="string">&quot;REJECTED&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> result = <span class="title function_">fn</span>(<span class="variable language_">this</span>.<span class="property">value</span>);</span><br><span class="line">      <span class="keyword">return</span> <span class="title class_">Prom</span>.<span class="title function_">reject</span>(result);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">this</span>.<span class="property">status</span> === <span class="string">&quot;PENDING&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Prom</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">rejectFns</span>.<span class="title function_">push</span>(&#123; fn, resolve, reject &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Prom</span>.<span class="title function_">resolve</span>(<span class="number">10</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">o</span>) =&gt;</span> o * <span class="number">10</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">o</span>) =&gt;</span> o + <span class="number">10</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">o</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(o);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Prom</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> <span class="title function_">reject</span>(<span class="string">&quot;Error&quot;</span>)).<span class="title function_">catch</span>(<span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error&quot;</span>, e);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>]]></content>
      
      
      
        <tags>
            
            <tag> 面试题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>面试题-基础</title>
      <link href="/2022/10/26/%E9%9D%A2%E8%AF%95%E9%A2%98/"/>
      <url>/2022/10/26/%E9%9D%A2%E8%AF%95%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h4 id="快速实现元素居中布局"><a href="#快速实现元素居中布局" class="headerlink" title="快速实现元素居中布局"></a>快速实现元素居中布局</h4><h5 id="方法一-使用flex布局并margin自适应进行居中"><a href="#方法一-使用flex布局并margin自适应进行居中" class="headerlink" title="方法一 使用flex布局并margin自适应进行居中"></a>方法一 使用flex布局并margin自适应进行居中</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;father&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;son&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>快速剧中对齐<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span> &#123;</span><br><span class="line"><span class="comment">/* 样式代码省略 */</span></span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: auto</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="方法二-使用弹性盒子来实现居中"><a href="#方法二-使用弹性盒子来实现居中" class="headerlink" title="方法二 使用弹性盒子来实现居中"></a>方法二 使用弹性盒子来实现居中</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="selector-class">.father</span>&#123;</span><br><span class="line">     <span class="attribute">display</span>: flex;</span><br><span class="line">     <span class="attribute">justify-content</span>: center;</span><br><span class="line">     <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="方法三-使用绝对定位并进行偏移"><a href="#方法三-使用绝对定位并进行偏移" class="headerlink" title="方法三 使用绝对定位并进行偏移"></a>方法三 使用绝对定位并进行偏移</h5><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.father</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>:relative;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.son</span>&#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">left</span>:<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">top</span>:<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">margin-top</span>: -<span class="number">50px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="padding-和-margin-有什么不同"><a href="#padding-和-margin-有什么不同" class="headerlink" title="padding 和 margin 有什么不同"></a>padding 和 margin 有什么不同</h4><p>margin是指从自身边框到另一个容器边框之间的距离，就是容器外距离；即外边距。</p><p>padding是指自身边框到自身内部另一个容器边框之间的距离，就是容器内距离；即内边距。</p><p>margin是用来隔开元素与元素的间距；padding是用来隔开元素与内容的间隔。margin用于布局，可以分开元素，使元素与元素互不相干；padding用于设置元素与内容之间的间隔，让内容（文字）与（包裹）元素之间有一段“呼吸距离”。</p><h4 id="vw-和-百分比-有什么区别"><a href="#vw-和-百分比-有什么区别" class="headerlink" title="vw 和 百分比 有什么区别"></a>vw 和 百分比 有什么区别</h4><ul><li><p>% 有继承关系：如果元素的父元素宽度或高度改变，元素也会随着父元素一起变化。</p></li><li><p>vw 只和设备的宽度有关</p></li></ul><h4 id="行内元素-和-块级元素的区别"><a href="#行内元素-和-块级元素的区别" class="headerlink" title="行内元素 和 块级元素的区别"></a>行内元素 和 块级元素的区别</h4><ul><li><p>行内元素会在一条直线上排列（默认宽度只与内容有关），都是同一行的，水平方向排列。块级元素各占据一行（默认宽度是它本身父容器的100%（和父元素的宽度一致），与内容无关），垂直方向排列。块级元素从新行开始，结束接着一个断行。</p></li><li><p>块级元素可以包含行内元素和块级元素。行内元素不能包含块级元素，只能包含文本或者其它行内元素。</p></li><li><p>-行内元素与块级元素属性的不同，主要是盒模型属性上：行内元素设置width无效，height无效(可以设置line-height)，margin上下无效，padding上下无效</p></li></ul><blockquote><p>inline-block 的元素（如input、img)既具有 block 元素可以设置宽高的特性，同时又具有 inline 元素默认不换行的特性。当然不仅仅是这些特性，比如 inline-block 元素也可以设置 vertical-align（因为这个垂直对齐属性只对设置了<strong>inline-block</strong>的元素有效） 属性。<br>HTML 中的换行符、空格符、制表符等合并为空白符，字体大小不为 0 的情况下，空白符自然占据一定的宽度，使用inline-block 会产生元素间的空隙</p></blockquote><h4 id="如何让谷歌浏览器支持小字体"><a href="#如何让谷歌浏览器支持小字体" class="headerlink" title="如何让谷歌浏览器支持小字体"></a>如何让谷歌浏览器支持小字体</h4><p>谷歌浏览器最小字体只支持到 12px，再小就不会变化。</p><p>解决方法：<code>transform: scale(0.5)</code> 通过 css 的 transform 属性下的 sacle 缩放。</p><h4 id="前端需要注意哪些SEO"><a href="#前端需要注意哪些SEO" class="headerlink" title="前端需要注意哪些SEO"></a>前端需要注意哪些SEO</h4><ul><li><p>合理的 title 、 description 、 keywords ：搜索对着三项的权重逐个减⼩， title值强调重点即可，重要关键词出现不要超过2次，⽽且要靠前，不同⻚⾯ title 要有所不同； description 把⻚⾯内容⾼度概括，⻓度合适，不可过分堆砌关键词，不同⻚⾯description 有所不同； keywords 列举出重要关键词即可</p></li><li><p>语义化的 HTML 代码，符合W3C规范：语义化代码让搜索引擎容易理解⽹⻚</p></li><li><p>重要内容 HTML 代码放在最前：搜索引擎抓取 HTML 顺序是从上到下，有的搜索引擎对抓取⻓度有限制，保证重要内容⼀定会被抓取</p></li><li><p>重要内容不要⽤ js 输出：爬⾍不会执⾏js获取内容</p></li><li><p>少⽤ iframe ：搜索引擎不会抓取 iframe 中的内容</p></li><li><p>⾮装饰性图⽚必须加 alt</p></li><li><p>提⾼⽹站速度：⽹站速度是搜索引擎排序的⼀个重要指标</p></li></ul><h4 id="lt-img-gt-的-title-和-alt-有什么区别"><a href="#lt-img-gt-的-title-和-alt-有什么区别" class="headerlink" title="&lt;img&gt; 的 title 和 alt 有什么区别"></a><code>&lt;img&gt;</code> 的 title 和 alt 有什么区别</h4><ul><li><p>通常当⿏标滑动到元素上的时候显示</p></li><li><p>alt 是 <code>&lt;img&gt;</code>的特有属性，是图⽚内容的等价描述，⽤于图⽚⽆法加载时显示、读屏器阅读图⽚。可提图⽚⾼可访问性，除了纯装饰图⽚外都必须设置有意义的值，搜索引擎会重点分析。</p></li></ul>]]></content>
      
      
      
        <tags>
            
            <tag> 面试题 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>npm淘宝镜像</title>
      <link href="/2022/10/26/npm%E6%B7%98%E5%AE%9D%E9%95%9C%E5%83%8F/"/>
      <url>/2022/10/26/npm%E6%B7%98%E5%AE%9D%E9%95%9C%E5%83%8F/</url>
      
        <content type="html"><![CDATA[<p>由于node下载第三方依赖包是从国外服务器下载，虽然没有被墙，但是下载的速度是非常的缓慢且有可能会出现异常。</p><p>所以为了提高效率，我们还是把npm的镜像源替换成淘宝的镜像源。有几种方式供我们选择。</p><h4 id="使用-cnpm"><a href="#使用-cnpm" class="headerlink" title="使用 cnpm"></a>使用 cnpm</h4><p>使用阿里定制的cnpm命令行工具代替默认的npm，输入以下代码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><p>安装成功之后，以后安装依赖包的方式和npm的是一样的，只是npm的命令换成是cnpm就可以了。</p><p>在开发react-native的时候，不要使用cnpm！cnpm安装的模块路径比较奇怪，packager不能正常识别。所以，为了方便开发，我们最好是直接永久使用淘宝的镜像源。</p><h5 id="直接命令行的设置"><a href="#直接命令行的设置" class="headerlink" title="直接命令行的设置"></a>直接命令行的设置</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npm.taobao.org</span><br></pre></td></tr></table></figure><blockquote><p>如果想还原npm仓库地址的话，只需要在把地址配置成npm镜像就可以了。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org/</span><br></pre></td></tr></table></figure></blockquote>]]></content>
      
      
      
        <tags>
            
            <tag> npm </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>vuex</title>
      <link href="/2022/10/23/vuex/"/>
      <url>/2022/10/23/vuex/</url>
      
        <content type="html"><![CDATA[<h2 id="Vuex-概述"><a href="#Vuex-概述" class="headerlink" title="Vuex 概述"></a>Vuex 概述</h2><h3 id="1-组件之间共享数据的方式"><a href="#1-组件之间共享数据的方式" class="headerlink" title="1. 组件之间共享数据的方式"></a>1. 组件之间共享数据的方式</h3><p>父向子传值：v-bind 属性绑定</p><p>子向父传值：v-on 事件绑定</p><p>兄弟组件之间共享数据：EventBus</p><ul><li>$on 接收数据的那个组件</li><li>$emit 发送数据的那个组件</li></ul><h3 id="2-什么是Vuex"><a href="#2-什么是Vuex" class="headerlink" title="2. 什么是Vuex"></a>2. 什么是Vuex</h3><p>Vuex 是实现组件全局状态（数据）管理的一种机制，可以方便的实现组件之间数据的共享。</p><p><img src="https://s2.loli.net/2022/09/26/AeQvsBnzwgdhLUN.png" alt="image-20220926130644325.png"></p><h3 id="3-使用-Vuex-统一管理状态的好处"><a href="#3-使用-Vuex-统一管理状态的好处" class="headerlink" title="3. 使用 Vuex 统一管理状态的好处"></a>3. 使用 Vuex 统一管理状态的好处</h3><ol><li>能够在 vuex 中集中管理共享的数据，易于开发和后期维护。</li><li>能够高效地实现组件之间的数据共享，提高开发效率。</li><li>存储在 vuex 中的数据都是响应式的，能够实时保持数据与页面的同步。</li></ol><blockquote><p>一般情况下，只有组件之间共享的数据，才有必要存储到 vuex 中，对于组件中的私有数据，依旧存储在组件自身的 data 中即可。</p></blockquote><h2 id="Vuex-的基本使用"><a href="#Vuex-的基本使用" class="headerlink" title="Vuex 的基本使用"></a>Vuex 的基本使用</h2><h3 id="1-安装-vuex-依赖包"><a href="#1-安装-vuex-依赖包" class="headerlink" title="1. 安装 vuex 依赖包"></a>1. 安装 vuex 依赖包</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install vuex --save</span><br></pre></td></tr></table></figure><h3 id="2-导入-vuex-包"><a href="#2-导入-vuex-包" class="headerlink" title="2. 导入 vuex 包"></a>2. 导入 vuex 包</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br></pre></td></tr></table></figure><h3 id="3-创建-store-对象"><a href="#3-创建-store-对象" class="headerlink" title="3. 创建 store 对象"></a>3. 创建 store 对象</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="comment">// store 中存放的就是全局共享的数据</span></span><br><span class="line">    <span class="attr">state</span>: &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store</span><br></pre></td></tr></table></figure><h3 id="4-将-store-对象挂载到-vue-实例中"><a href="#4-将-store-对象挂载到-vue-实例中" class="headerlink" title="4. 将 store 对象挂载到 vue 实例中"></a>4. 将 store 对象挂载到 vue 实例中</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(app),</span><br><span class="line">    router,</span><br><span class="line">    <span class="comment">// 将创建的共享数据对象，挂载到 Vue 实例中</span></span><br><span class="line">    <span class="comment">// 所有的组件，就可以直接从 store 中获取全局的数据了</span></span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="Vuex-的核心概念"><a href="#Vuex-的核心概念" class="headerlink" title="Vuex 的核心概念"></a>Vuex 的核心概念</h2><h3 id="1-State"><a href="#1-State" class="headerlink" title="1. State"></a>1. State</h3><p>State 提供唯一的公共数据源，所有共享的数据都要统一放到 Store 的 State 中进行存储。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123; <span class="attr">count</span>: <span class="number">0</span> &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>组件访问 State 中数据的第一种方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">state</span>.全局数据名称</span><br></pre></td></tr></table></figure><p>组件访问 State 中数据的第二种方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 vuex 中按需导入 mapState 函数</span></span><br><span class="line"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将全局数据映射为当前组件的计算属性</span></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapState</span>([<span class="string">&#x27;count&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-Mutation"><a href="#2-Mutation" class="headerlink" title="2. Mutation"></a>2. Mutation</h3><p>Mutation 用于变更 Store 中的数据</p><ol><li>只能通过 mutation 变更 store 数据，不可以直接操作 store 的数据。</li><li>通过这种方式虽然操作起来稍微繁琐一些，但是可以集中控制所有数据的变化。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="title function_">add</span>(<span class="params">state</span>) &#123;</span><br><span class="line">            <span class="comment">// 变更状态</span></span><br><span class="line">            state.<span class="property">count</span> ++ </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 触发 mutation</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handle1</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;add&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可以触发 mutation 时传递参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> sotre = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">mutation</span>: &#123;</span><br><span class="line">        <span class="title function_">addN</span>(<span class="params">state, step</span>) &#123;</span><br><span class="line">            state.<span class="property">count</span> += step</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handle2</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">commit</span>(<span class="string">&#x27;addN&#x27;</span>, <span class="number">3</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>this.$store.commit() 是触发 mutation 的第一种方式，触发 mutation 的第二种方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapMutation&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapMutation</span>([<span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;addN&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>不要在 mutation 函数中执行异步操作，如计时器。</p><p>否则会造成 页面数据能更行渲染，但后台无法获取到实时的数据。</p></blockquote><h3 id="3-Action"><a href="#3-Action" class="headerlink" title="3. Action"></a>3. Action</h3><p>Action 用于处理异步任务。</p><p>如果通过异步操作变更数据，必须通过 Action，而不能使用 Mutation，但是在 Action 中还是要童工触发 Mutation 的方式间接变更数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="title function_">add</span>(<span class="params">state</span>) &#123;</span><br><span class="line">            state.<span class="property">count</span> ++</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="title function_">addAsync</span>(<span class="params">context</span>) &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            context.<span class="title function_">commit</span>(<span class="string">&#x27;add&#x27;</span>)           </span><br><span class="line">            &#125;,<span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 触发 action</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handle</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addAsync&#x27;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>触发 actions 异步任务时携带参数：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">mutations</span>: &#123;</span><br><span class="line">        <span class="title function_">addN</span>(<span class="params">state, step</span>) &#123;</span><br><span class="line">            state.<span class="property">count</span> += step</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">actions</span>: &#123;</span><br><span class="line">        <span class="title function_">addNAsync</span>(<span class="params">context, step</span>) &#123;</span><br><span class="line">            <span class="built_in">setTimeout</span>( <span class="function">() =&gt;</span> &#123;</span><br><span class="line">            context.<span class="title function_">commit</span>(<span class="string">&#x27;addN&#x27;</span>, step)           </span><br><span class="line">            &#125;,<span class="number">1000</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 触发 action</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">handle</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;addNAsync&#x27;</span>, <span class="number">5</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>触发 actions 的第二种方式</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapActions&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapActions</span>([<span class="string">&#x27;addAsync&#x27;</span>, <span class="string">&#x27;addNAsync&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-Getter"><a href="#4-Getter" class="headerlink" title="4. Getter"></a>4. Getter</h3><p>Getter 用于对 Store 中的数据进行加工处理形成新的数据。</p><ol><li>Getter 可以对 Store 中已有的数据加工处理之后形成新的数据，类似 Vue 的计算属性。</li><li>Store 中数据发生变化，Getter 的数据也会跟着发生变化。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">    <span class="attr">state</span>: &#123;</span><br><span class="line">        <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">getters</span>: &#123;</span><br><span class="line">        <span class="title function_">showNum</span>(<span class="params">state</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&#x27;当前最新的数量是【&#x27;</span> + state.<span class="property">count</span> + <span class="string">&#x27;】&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>使用 getters 的第一种方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getter</span>.名称</span><br></pre></td></tr></table></figure><p>使用 getters 的第二种方式：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapGetters&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">    ...<span class="title function_">mapGetters</span>([<span class="string">&#x27;showNum&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
            <tag> vuex </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ES6</title>
      <link href="/2022/10/23/ES6/"/>
      <url>/2022/10/23/ES6/</url>
      
        <content type="html"><![CDATA[<h2 id="ES-模块化"><a href="#ES-模块化" class="headerlink" title="ES 模块化"></a>ES 模块化</h2><h3 id="前端模块化规范的分类"><a href="#前端模块化规范的分类" class="headerlink" title="前端模块化规范的分类"></a>前端模块化规范的分类</h3><p>模块化的好处：大家都遵循同样的模块化规范写代码，降低了沟通的成本，极大方便了各个模块之间的相互调用。</p><p>在 ES6 模块化规范诞生之前，JavaScript 社区已经尝试并提出了 AMD、CMD、CommonJs 等模块化规范。<br>但是，这些社区听出的模块化规范，还是存在一定的差异性，并不是浏览器与服务器通用的模块化标准，例如：</p><ul><li>AMD 和 CMD 适用于浏览器端的 JavaScript模块化</li><li>CommonJs 适用于服务器端的 JavaScript 模块化</li></ul><p>太多的模块化规范给开发者增加了学习的难度和开发的成本，因此，大一统的 ES6 模块化诞生了</p><h3 id="什么是ES6-模块化"><a href="#什么是ES6-模块化" class="headerlink" title="什么是ES6 模块化"></a>什么是ES6 模块化</h3><p>ES6 模块化规范是浏览器端与服务器端通用的模块化开发规范。它的出现极大的降低了前端开发者的模块化学习成本，开发者不需要再额外学习 AMD、CMD 或 CommonJs等模块化规范。<br>ES6 模块化规范中的定义：</p><ul><li>每个 js 文件都是一个独立的模块</li><li>导入其它模块成员使用 <code>import</code> 关键字</li><li>向外共享模块成员使用 <code>export</code> 关键字</li></ul><h3 id="ES6-模块化的基本语法"><a href="#ES6-模块化的基本语法" class="headerlink" title="ES6 模块化的基本语法"></a>ES6 模块化的基本语法</h3><p>ES6 的模块化主要包含如下3种用法：</p><ul><li>默认导出与默认导入</li><li>按需导出与按需导入</li><li>直接导入并执行模块中的代码</li></ul><h4 id="默认导出"><a href="#默认导出" class="headerlink" title="默认导出"></a>默认导出</h4><p>默认导出语法：<code>export default &#123;默认导出的成员&#125;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> n1 = <span class="number">10</span> <span class="comment">//定义模块私有成员 n1</span></span><br><span class="line"><span class="keyword">let</span> n2 = <span class="number">20</span> <span class="comment">//定义模块私有成员 n2</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params"></span>) &#123;&#125; <span class="comment">//定义模块私有方法 show</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="comment">//使用 export default 默认导出语法，向外共享 n1 和 show 两个成员</span></span><br><span class="line">n1,</span><br><span class="line">show</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>每个模块中，只允许使用唯一的一次 <code>export default</code> ，否则会报错</p></blockquote><h4 id="默认导入"><a href="#默认导入" class="headerlink" title="默认导入"></a>默认导入</h4><p>默认到处的语法：<code>import 接受名称 form &#39;模块标识符&#39;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从 01默认导出.js 模块中导入 export default 向外共享的成员</span></span><br><span class="line"><span class="comment">// 并使用 m1 进行接收</span></span><br><span class="line"><span class="keyword">import</span>  m1  <span class="keyword">from</span>  <span class="string">&#x27;./01默认导出.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(m1)</span><br><span class="line"><span class="comment">// &#123; n1: 10, show: [Function: show] &#125;</span></span><br></pre></td></tr></table></figure><blockquote><p>默认导入时的接收名称可以任意名称，只要是合法的成员名称即可</p></blockquote><h4 id="按需导出"><a href="#按需导出" class="headerlink" title="按需导出"></a>按需导出</h4><p><code>export 按需导出的成员</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> s1 = <span class="string">&#x27;aaa&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">let</span> s2 = <span class="string">&#x27;ccc&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">say</span>(<span class="params"></span>)&#123;&#125;</span><br></pre></td></tr></table></figure><h4 id="按需导入"><a href="#按需导入" class="headerlink" title="按需导入"></a>按需导入</h4><p><code>import &#123;s1&#125; from &#39;模块标识符&#39;</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; s1, s2, say&#125; <span class="keyword">from</span> <span class="string">&#x27;./03按需导出.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s1)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(say) <span class="comment">//打印输出 [Function: say]</span></span><br></pre></td></tr></table></figure><h4 id="按需导出和按需导入的注意事项"><a href="#按需导出和按需导入的注意事项" class="headerlink" title="按需导出和按需导入的注意事项"></a>按需导出和按需导入的注意事项</h4><ul><li>每个模块中可以使用多次按需导出</li><li>按需导入的成员名称必须和按需导出的名称保持一致</li><li>按需导入时，可以使用 as 关键字进行重命名</li><li>按需导入可以和默认导入一起使用</li></ul><h4 id="直接导入并执行模块中的代码"><a href="#直接导入并执行模块中的代码" class="headerlink" title="直接导入并执行模块中的代码"></a>直接导入并执行模块中的代码</h4><p>如果只想单纯地执行某个模块中的代码，并不需要得到模块中向外共享的成员。此时，可以直接导入并执行模块代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在当前模块中执行一个 for 循环操作</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(i)</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// ------------分割线----------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//直接导入并执行模块代码，不需要得到模块向外共享的成员</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./05直接导入.js&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h2><h3 id="回调地狱"><a href="#回调地狱" class="headerlink" title="回调地狱"></a>回调地狱</h3><p>多层对调函数的相互嵌套，就形成了回调地狱</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;延时 1 秒后输出&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;再延时 2 秒后输出&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;再延时 3 秒后输出&#x27;</span>)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br><span class="line">&#125;, <span class="number">2000</span>)</span><br><span class="line">&#125;, <span class="number">1000</span>)</span><br></pre></td></tr></table></figure><p>回调地狱的缺点：</p><ul><li>代码耦合性太强，牵一发而动全身，那以维护</li><li>大量冗余的代码相互嵌套，代码的可读性变差</li></ul><p><strong>为了解决回调地狱的问题，ES6 中新增了 Promise 的概念</strong></p><h3 id="Promise-的基本概念"><a href="#Promise-的基本概念" class="headerlink" title="Promise 的基本概念"></a>Promise 的基本概念</h3><ol><li>Promise 是一个构造函数</li></ol><ul><li>我们可以创建 Promise 的实例 <code>const p = new Promise()</code></li><li>new 出来的 Promise 实力对象，代表一个异步操作</li></ul><ol start="2"><li><code>Promise.prototype</code> 上包含一个 <code>.then()</code> 的方法</li></ol><ul><li>每一次 new Promise() 构造函数得到的实例对象，都可以通过原型链的方式访问到 .then() 方法，例如 <code>p.then()</code></li></ul><ol start="3"><li><code>.then()</code>方法用来预先指定成功和失败的回调函数</li></ol><ul><li><code>p.then(成功的回调函数， 失败的回调函数)</code></li><li><code>p.then(result =&gt; &#123;&#125;, err =&gt; &#123;&#125;)</code></li><li>调用 .then() 方法时，成功的回调函数是必选的，失败的回调函数是可选的</li></ul><h3 id="基于回调函数按顺序读取文件内容"><a href="#基于回调函数按顺序读取文件内容" class="headerlink" title="基于回调函数按顺序读取文件内容"></a>基于回调函数按顺序读取文件内容</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err1, r1</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(err1) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err1.<span class="property">message</span>) <span class="comment">//读取文件 1 失败</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1) <span class="comment">//读取文件 1 成功</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err2, r2</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(err2) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err2.<span class="property">message</span>) <span class="comment">//读取文件 2 失败</span></span><br><span class="line">conlole.<span class="title function_">log</span>(r2) <span class="comment">//读取文件 2 成功</span></span><br><span class="line">fs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err3, r3</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(err3) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(err3.<span class="property">message</span>) <span class="comment">//读取文件 3 失败</span></span><br><span class="line">conlole.<span class="title function_">log</span>(r3) <span class="comment">//读取文件 3 成功</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="基于-then-fs-读取文件内容"><a href="#基于-then-fs-读取文件内容" class="headerlink" title="基于 then-fs 读取文件内容"></a>基于 then-fs 读取文件内容</h3><p>由于 node.js 官方提供的 fs 模块仅支持以回调函数的方式读取文件，不支持 Promise 的调用方式，因此，需要先运行如下的命令<code>npm install then-fs</code>，安装 then-fs 这个第三方，从而支持我们基于 Promise 的方式读取文件内容。<br>调用 then-fs 提供的 <code>readFile()</code>方法，可以异步地读取文件的内容，它的返回值是 Promise 的实例对象，因此可以调用 .then() 方法为每个 Promise 异步操作指定成功和失败之后的回调函数。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(r1) &#125;,<span class="function"><span class="params">err1</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(err1.<span class="property">message</span>) &#125;)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(r2) &#125;,<span class="function"><span class="params">err2</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(err2.<span class="property">message</span>) &#125;)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(r3) &#125;,<span class="function"><span class="params">err3</span> =&gt;</span> &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(err3.<span class="property">message</span>) &#125;)</span><br></pre></td></tr></table></figure><blockquote><p>注意上述的代码无法保证文件的读取顺序，需要进一步改进</p></blockquote><h3 id="then-方法的特性"><a href="#then-方法的特性" class="headerlink" title=".then() 方法的特性"></a>.then() 方法的特性</h3><p>如果上一个 .then() 方法中返回了一个新的 Promise 实力对象，则可以通过下一个 .then() 继续进行处理，通过 .then() 方法的链式调用，就解决了回调地狱的问题。</p><h3 id="基于-Promise-按顺序读取文件的内容"><a href="#基于-Promise-按顺序读取文件的内容" class="headerlink" title="基于 Promise 按顺序读取文件的内容"></a>基于 Promise 按顺序读取文件的内容</h3><p>promise 支持链式调用，从而来解决回调地狱中的问题。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">//1.返回值是 Promise 的实例对象</span></span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">r1</span>) =&gt;</span> &#123; <span class="comment">//2.通过 .then 为第一个 Promise 实例指定成功之后的回调函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">//3.在第一个 .then 中返回一个新的 Promise 实力对象</span></span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">r2</span>) =&gt;</span> &#123; <span class="comment">//4.继续调用 .then 为上一个 .then 的返回值（新的 Promise 实例）指定成功之后的回调函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">//5.在第二个 .then 中再返回一个新的 Promise 实力对象</span></span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">r3</span>) =&gt;</span> &#123; <span class="comment">//6.继续调用 .then 为上一个 .then 的返回值（新的 Promise 实例）指定成功之后的回调函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="通过-catch-捕获错误"><a href="#通过-catch-捕获错误" class="headerlink" title="通过 .catch 捕获错误"></a>通过 .catch 捕获错误</h3><p>在 Promise 的链式操作中如果发生了错误，可以使用 Promise.prototype.catch 方法进行捕获和处理</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>) <span class="comment">//文件不存在导致读取失败，后面的三个 .then 都不执行</span></span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">reafFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="comment">//捕获第一行发生的错误，并输出错误的消息</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>如果不希望前面的错误但是后续的 .then 无法正常执行，则可以将 .catch 提前调用</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/11.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="comment">//捕获第一行发生的错误，并输出错误的消息</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)<span class="comment">// 由于错误已被及时处理，不影响后续的 .then 的正常执行</span></span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r1</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1) <span class="comment">//输出 undefined</span></span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">reafFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r2</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line"><span class="keyword">return</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function"><span class="params">r3</span> =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="Promise-all-方法"><a href="#Promise-all-方法" class="headerlink" title="Promise.all() 方法"></a>Promise.all() 方法</h3><p>Promise.all() 方法会发起并行的 Promise 异步操作，等所有的异步操作全部结束后才会执行下一步的 .then 操作（等待机制）。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.定义一个数组，存放 3 个读文件的异步操作</span></span><br><span class="line"><span class="keyword">const</span> promiseArr = [</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 2.将 Promise 的数组，作为 Promise.all() 的参数</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">all</span>(promiseArr)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">[r1, r2, r3]</span>) =&gt;</span> &#123; <span class="comment">// 2.1所有文件读取成功（等待机制）</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1, r2, r3)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="comment">//2.2 捕获 Promise 异步操作中的错误</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>注意： 数组中 Promise 实例的顺序就是最终结果的顺序</p></blockquote><h3 id="Promise-race-方法"><a href="#Promise-race-方法" class="headerlink" title="Promise.race() 方法"></a>Promise.race() 方法</h3><p>Promise.race() 方法会发起并行的 Promise 异步操作,只要任何一个异步操作完成，就立即执行下一步的 .then 操作（赛跑机制）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1.定义一个数组，存放 3 个读文件的异步操作</span></span><br><span class="line"><span class="keyword">const</span> promiseArr = [</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/3.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">]</span><br><span class="line"><span class="comment">// 2.将 Promise 的数组，作为 Promise.race() 的参数</span></span><br><span class="line"><span class="title class_">Promise</span>.<span class="title function_">race</span>(promiseArr)</span><br><span class="line">.<span class="title function_">then</span>(<span class="function">(<span class="params">result</span>) =&gt;</span> &#123; <span class="comment">//2.1 只要任何一个操作完成，就立即执行成功的回调函数</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(result)</span><br><span class="line">&#125;)</span><br><span class="line">.<span class="title function_">catch</span>(<span class="function"><span class="params">err</span> =&gt;</span> &#123; <span class="comment">//2.2 捕获 Promise 异步操作中的错误</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="基于-Promise-封装读文件的方法"><a href="#基于-Promise-封装读文件的方法" class="headerlink" title="基于 Promise 封装读文件的方法"></a>基于 Promise 封装读文件的方法</h3><p>方法封装要求：</p><ol><li>方法的名称要定义为 getFile</li><li>方法接受一个形参 fpath，表示要读取的文件的路径</li><li>方法的返回值为 Promise 实例对象</li></ol><h4 id="getFile-方法的基本定义"><a href="#getFile-方法的基本定义" class="headerlink" title="getFile 方法的基本定义"></a>getFile 方法的基本定义</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意：第五行代码中的 new Promise（）只是创建了一个形式上的异步操作</p></blockquote><h4 id="创建具体的异步操作"><a href="#创建具体的异步操作" class="headerlink" title="创建具体的异步操作"></a>创建具体的异步操作</h4><p>如果想要创建具体的异步操作，则需要在 new Promise（） 构造函数期间传递一个 function 函数，将具体的异步操作定义到 function 函数内部。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err ,dataStr</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="获取-then-的两个实参"><a href="#获取-then-的两个实参" class="headerlink" title="获取 .then 的两个实参"></a>获取 .then 的两个实参</h4><p>通过 .then() 指定的成功和失败的回调函数，可以在 function 的形参中进行接收。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>)&#123;</span><br><span class="line">fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err ,dataStr</span>) =&gt;</span> &#123;&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------分割线------------</span><br><span class="line"></span><br><span class="line"><span class="comment">//getFile 方法的调用</span></span><br><span class="line"><span class="title function_">getFile</span>(<span class="string">&#x27;./file/1.text&#x27;</span>).<span class="title function_">then</span>(成功的回调函数，失败的回调函数)</span><br></pre></td></tr></table></figure><h4 id="调用-resolve-和-reject-回调函数"><a href="#调用-resolve-和-reject-回调函数" class="headerlink" title="调用 resolve 和 reject 回调函数"></a>调用 resolve 和 reject 回调函数</h4><p>Promise 异步操作的结果，可以调用 resolve 或 reject 回调函数进行处理.</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">getFile</span>(<span class="params">fpath</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve, reject</span>)&#123;</span><br><span class="line">fs.<span class="title function_">readFile</span>(fpath, <span class="string">&#x27;utf8&#x27;</span>, <span class="function">(<span class="params">err ,dataStr</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">if</span>(err) <span class="keyword">return</span> <span class="title function_">reject</span>(err) <span class="comment">//如果失败，则调用失败的回调函数</span></span><br><span class="line"><span class="title function_">resolve</span>(dataStr) <span class="comment">//如果成功，则调用成功的回调函数</span></span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------分割线------------</span><br><span class="line"></span><br><span class="line"><span class="comment">//getFile 方法的调用</span></span><br><span class="line"><span class="title function_">getFile</span>(<span class="string">&#x27;./file/1.text&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">r1</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(r1),</span><br><span class="line"><span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(err.<span class="property">message</span>)</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="async-await"><a href="#async-await" class="headerlink" title="async / await"></a>async / await</h2><h3 id="什么是-async-await"><a href="#什么是-async-await" class="headerlink" title="什么是 async / await"></a>什么是 async / await</h3><p>async / await 是 ES8 引入的新语法，用来简化 Promise 异步操作。在 async / await 出现之前，开发者只能通过链式 .then() 的方式处理 Promise。</p><p>.then 链式调用的优点：解决了回调地狱的问题</p><p>.then 链式调用的缺点：代码冗余、阅读性差、不易理解、</p><h3 id="async-await-的基本使用"><a href="#async-await-的基本使用" class="headerlink" title="async / await 的基本使用"></a>async / await 的基本使用</h3><p>使用 async / await 简化 Promise 异步操作的示例：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 按照顺序读取文件 1、2、3 的内容</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> r1 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r1)</span><br><span class="line">  <span class="keyword">const</span> r2 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r2)</span><br><span class="line">  <span class="keyword">const</span> r3 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/31.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r3)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getAllFile</span>()</span><br></pre></td></tr></table></figure><h3 id="async-await-的使用注意事项"><a href="#async-await-的使用注意事项" class="headerlink" title="async / await 的使用注意事项"></a>async / await 的使用注意事项</h3><ul><li>如果在 function 中使用了 await ，则 function 必须被 async 修饰</li><li>在 async 方法中，第一个 await 之前的代码会同步执行，await 之后的代码会异步执行</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">getAllFile</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> r1 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/1.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> r2 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/2.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="keyword">const</span> r3 = <span class="keyword">await</span> thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;/files/31.txt&#x27;</span>, <span class="string">&#x27;utf8&#x27;</span>)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(r1,r2,r3)</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">getAllFile</span>()</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line"></span><br><span class="line">-----------------------------分割线-------------------------------------</span><br><span class="line"></span><br><span class="line"><span class="comment">//最终输出的顺序</span></span><br><span class="line">A</span><br><span class="line">B</span><br><span class="line">C</span><br><span class="line"><span class="number">111</span> <span class="number">222</span> <span class="number">333</span></span><br><span class="line">D</span><br></pre></td></tr></table></figure><h2 id="EventLoop"><a href="#EventLoop" class="headerlink" title="EventLoop"></a>EventLoop</h2><h3 id="JavaScript-是单线程的语言"><a href="#JavaScript-是单线程的语言" class="headerlink" title="JavaScript 是单线程的语言"></a>JavaScript 是单线程的语言</h3><p>JavaScript 是一门单线程执行的变成语言 ，也就是说，同一时间只能做一件事情。<br>单线程执行任务队列的问题：如果钱一个任务非常耗时，则后续的任务就不得不一直等待，从而导致程序假死的问题。</p><h3 id="同步任务和异步任务"><a href="#同步任务和异步任务" class="headerlink" title="同步任务和异步任务"></a>同步任务和异步任务</h3><p>为了防止某个耗时任务导致程序假死的问题，JavaScript 把待执行的任务分为了两类：</p><ol><li>同步任务</li></ol><ul><li>又叫做非耗时任务，指的是在主线程上排队执行的那些任务</li><li>只有前一个任务执行完毕，才能执行后一个任务</li></ul><ol start="2"><li>异步任务</li></ol><ul><li>又叫做耗时任务，异步任务由 JavaScript 委托给宿主环境进行执行</li><li>当异步任务执行完成后，会通知 JavaScript 主线程执行异步任务的回调函数</li></ul><h3 id="同步任务和异步任务的执行过程"><a href="#同步任务和异步任务的执行过程" class="headerlink" title="同步任务和异步任务的执行过程"></a>同步任务和异步任务的执行过程</h3><ol><li>同步任务由 JavaScript 主线程次序执行</li><li>异步任务委托给宿主环境执行</li><li>已完成的异步任务对应的回调函数，会被加入到任务队列中等待执行</li><li>JavaScript 主线程的执行栈被清空后，会读取任务中的回调函数，次序执行</li><li>JavaScript 主线程不断重复上面的第四步</li></ol><h3 id="EventLoop-的基本概念"><a href="#EventLoop-的基本概念" class="headerlink" title="EventLoop 的基本概念"></a>EventLoop 的基本概念</h3><p>JavaScript 主线程从“任务队列”中读取异步任务的回调函数，放到执行栈中依次执行。这个过程是循环不断的，所以整个的这种运行机制又称为 EventLoop （事件循环）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> thenFs <span class="keyword">from</span> <span class="string">&#x27;then-fs&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">thenFs.<span class="title function_">readFile</span>(<span class="string">&#x27;./files/1.txt&#x27;</span>,<span class="string">&#x27;utf8&#x27;</span>).<span class="title function_">then</span>(<span class="function"><span class="params">dataStr</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;B&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;C&#x27;</span>)</span><br><span class="line">&#125;,<span class="number">0</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;D&#x27;</span>)</span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line"><span class="comment">// 输出结构</span></span><br><span class="line">    <span class="variable constant_">ADCB</span></span><br></pre></td></tr></table></figure><h2 id="宏任务和微任务"><a href="#宏任务和微任务" class="headerlink" title="宏任务和微任务"></a>宏任务和微任务</h2><h3 id="什么是宏任务和微任务"><a href="#什么是宏任务和微任务" class="headerlink" title="什么是宏任务和微任务"></a>什么是宏任务和微任务</h3><p>JavaScript 把异步任务又做了进一步的划分，异步任务又分为两类。</p><ol><li>宏任务</li></ol><ul><li>异步 Ajax 请求</li><li>setTimeout、setInterval</li><li>文件操作</li><li>其它宏任务</li></ul><ol start="2"><li>微任务</li></ol><ul><li>Promise.then、.catrh、.finally</li><li>process.nextTick</li><li>其它微任务</li></ul><h3 id="宏任务和微任务的执行顺序"><a href="#宏任务和微任务的执行顺序" class="headerlink" title="宏任务和微任务的执行顺序"></a>宏任务和微任务的执行顺序</h3><p>每一个宏任务执行完成后，都会检查是否存在待执行的微任务，如果有，则执行完所有微任务之后，再继续执行下一个宏任务。</p><h3 id="去银行办业务的场景"><a href="#去银行办业务的场景" class="headerlink" title="去银行办业务的场景"></a>去银行办业务的场景</h3><ol><li>小云和小腾去银行办业务。首先，需要取号之后进行排队</li></ol><ul><li>宏任务队列</li></ul><ol start="2"><li>假设当前银行网点只有一个柜员，小云在办理存款业务时，小腾只能等待</li></ol><ul><li>单线程，宏任务按次序执行</li></ul><ol start="3"><li>小云办完存款业务后，柜员询问他时候还想办理其它任务</li></ol><ul><li>当前宏任务执行完，检查是否有微任务</li></ul><ol start="4"><li>小云告诉柜员：想买理财产品、再办个信用卡、最后再兑换点纪念币</li></ol><ul><li>执行微任务，后续宏任务被推迟</li></ul><ol start="5"><li>小云离开柜台后，柜员开始为小腾办理业务</li></ol><ul><li>所有微任务执行完毕，开始执行下一个宏任务</li></ul><h4 id="分析代码输出的顺序"><a href="#分析代码输出的顺序" class="headerlink" title="分析代码输出的顺序"></a>分析代码输出的顺序</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">-----------------------------------------</span><br><span class="line"><span class="comment">// 最终结果</span></span><br><span class="line">    <span class="number">2431</span></span><br></pre></td></tr></table></figure><blockquote><p>分析：</p><ol><li>先执行所有同步任务<ul><li>2、4</li></ul></li><li>再执微任务<ul><li>3</li></ul></li><li>再执行下一个宏任务<ul><li>1</li></ul></li></ol></blockquote><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">    <span class="title function_">resolve</span>()</span><br><span class="line">&#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;6&#x27;</span>)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">    <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="keyword">function</span>(<span class="params">resolve</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;8&#x27;</span>)</span><br><span class="line">        <span class="title function_">resolve</span>()</span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;9&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">---------------------------</span><br><span class="line">    <span class="number">156234789</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
            <tag> ES6 模块化 </tag>
            
            <tag> Promise </tag>
            
            <tag> aysnc/await </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Vue 3.x</title>
      <link href="/2022/10/21/Vue/"/>
      <url>/2022/10/21/Vue/</url>
      
        <content type="html"><![CDATA[<h2 id="1-Vue-简介"><a href="#1-Vue-简介" class="headerlink" title="1 Vue 简介"></a>1 Vue 简介</h2><h3 id="1-1-什么是-Vue"><a href="#1-1-什么是-Vue" class="headerlink" title="1.1 什么是 Vue"></a>1.1 什么是 Vue</h3><p>官方给出的概念：Vue (读音 /vjuː/，类似于 view) 是一套用于构建用户界面的前端框架。</p><h3 id="1-2-构建用户界面的传统方式"><a href="#1-2-构建用户界面的传统方式" class="headerlink" title="1.2 构建用户界面的传统方式"></a>1.2 构建用户界面的传统方式</h3><p>在传统的 Web 前端开发中，是基于 JQuery + 模板引擎 的方式来构建用户界面的</p><ul><li>编写结构</li></ul><p>​    基于模板引擎技术，把数据渲染到页面上。</p><p>​    优点：初步解放了前端开发者，从此不用手动拼接字符串来渲染网页结构了。</p><p>​    缺点：1. 需要定义大量的模板结构；2. 缺少语法高亮和只能提示；3. 数据变化时需要重新调用模板编译的函数，否则页面结构不会更新。</p><ul><li>美化样式</li></ul><p>​    基础 CSS 样式，美化网页的可视化效果</p><ul><li>处理交互</li></ul><p>​    基于 JQuery 技术，处理用户和网页之间的交互行为。</p><p>​    优点：屏蔽了 DOM API 之间的兼容性，提高了 DOM 的操作效率和体验。</p><p>​    缺点：当业务复杂时、数据变化频繁时，前端开发者需要把大量的事件和精力浪费在 DOM 的操作上，而不是核心业务的处理上</p><h3 id="1-3-使用-vue-构建用户界面"><a href="#1-3-使用-vue-构建用户界面" class="headerlink" title="1.3 使用 vue 构建用户界面"></a>1.3 使用 vue 构建用户界面</h3><p>使用 vue 构建用户界面，解决了 jQuery + 模板引擎 的诸多痛点，极大的提高了前端开发的效率和体验。</p><ul><li>编写结构</li></ul><p>​    基于 vue 中提供的指令，可以方便快捷的渲染页面的结构（乐不思蜀）。 数据驱动视图（只要页面依赖的数据源变化，则页面自动重新渲染） Ps：指令是 vue 为开发者提供的模板语法，用来辅助开发者渲染页面的结构。</p><ul><li>美化样式</li></ul><p>​    基础 CSS 样式，美化网页的可视化效果。</p><ul><li>处理交互</li></ul><p>​    基于 vue 中提供的事件绑定，可以轻松处理用户和页面之间的交互行为。 Ps：开发者把工作的重心放在核心业务的实现上</p><h3 id="1-4-解读核心关键词：框架"><a href="#1-4-解读核心关键词：框架" class="headerlink" title="1.4 解读核心关键词：框架"></a>1.4 解读核心关键词：框架</h3><p>官方给 vue 的定位是前端框架，因为它提供了构建用户界面的一整套解决方案（俗称 vue 全家桶）：</p><ul><li><p>vue（核心库） </p></li><li><p>vue-router（路由方案） </p></li><li><p>vuex（状态管理方案） </p></li><li><p>vue 组件库（快速搭建页面 UI 效果的方案） </p></li></ul><p>以及辅助 vue 项目开发的一系列工具： </p><ul><li><p>vue-cli（npm 全局包：一键生成工程化的 vue 项目 - 基于 webpack、大而全） </p></li><li><p>vite（npm 全局包：一键生成工程化的 vue 项目 - 小而巧） </p></li><li><p>vue-devtools（浏览器插件：辅助调试的工具） </p></li><li><p>vetur（vscode 插件：提供语法高亮和智能提示）</p></li></ul><h2 id="2-Vue-的基本使用"><a href="#2-Vue-的基本使用" class="headerlink" title="2 Vue 的基本使用"></a>2 Vue 的基本使用</h2><h3 id="2-1-基本使用步骤"><a href="#2-1-基本使用步骤" class="headerlink" title="2.1 基本使用步骤"></a>2.1 基本使用步骤</h3><ul><li>导入 vue.js 的 script 脚本文件</li><li>在页面中声明一个将要被 vue 所控制的 DOM 区域</li><li>创建 vm 实例对象（vue 实例对象）</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">// 2. 在页面中声明一个将要被 vue 所控制的 DOM 区域</span><br><span class="line">    &lt;div id = &quot;app&quot;&gt;</span><br><span class="line">        &#123;&#123;username&#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">    // 1. 导入 vue.js 的 script 脚本文件</span><br><span class="line">    &lt;script src = &quot;./lib/vue-2.6.12.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">    // 创建 vm 实例对象</span><br><span class="line">        const vm = new Vue(&#123;</span><br><span class="line">            // 指定当前 vm 实例要控制页面的哪个区域</span><br><span class="line">            el: &#x27;#app&#x27;,</span><br><span class="line">            // 指定 Model 数据员</span><br><span class="line">            data: &#123;</span><br><span class="line">                username: &#x27;zs&#x27;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure><h3 id="2-2-基本代码与-MVVM-的对应关系"><a href="#2-2-基本代码与-MVVM-的对应关系" class="headerlink" title="2.2  基本代码与 MVVM 的对应关系"></a>2.2  基本代码与 MVVM 的对应关系</h3><h2 id="3-Vue-的指令与过滤器"><a href="#3-Vue-的指令与过滤器" class="headerlink" title="3 Vue 的指令与过滤器"></a>3 Vue 的指令与过滤器</h2><p>指令（Directives）是 vue 为开发者提供的模板语法，用于辅助开发者渲染页面的基本结构。</p><p>vue 中的指令按照不同的用途可以分为如下 6 大类：</p><ul><li>内容渲染指令</li><li>属性绑定指令</li><li>事件绑定指令</li><li>双向绑定指令</li><li>条件渲染指令</li><li>列表渲染指令</li></ul><blockquote><p>注意：指令是 vue 开发中最基础、最常用、最简单的知识点</p></blockquote><h3 id="3-1-内容渲染指令"><a href="#3-1-内容渲染指令" class="headerlink" title="3.1 内容渲染指令"></a>3.1 内容渲染指令</h3><p>内容渲染指令用来辅助开发者渲染 DOM 元素的文本内容。常用的内容渲染指令有如下 3 个：</p><ul><li>v-text</li><li><code>&#123;&#123; &#125;&#125;</code></li><li>v-html</li></ul><h4 id="3-1-1-v-text"><a href="#3-1-1-v-text" class="headerlink" title="3.1.1 v-text"></a>3.1.1 v-text</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 把 username 对应的值，渲染到第一个 p 标签中 --&gt;</span><br><span class="line">&lt;p v-text=&quot;username&quot;&gt;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 把 gender 对应的值，渲染到第二个 p 标签中 --&gt;</span><br><span class="line">&lt;!-- 注意： 第二个 p 标签中，默认的文本 ”性别“ 会被 gender 的值覆盖 --&gt;</span><br><span class="line">&lt;p v-text=&quot;gender&quot;&gt;性别&lt;/p&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：v-text 指令会覆盖元素内默认的值</p></blockquote><h4 id="3-1-2-双括号语法"><a href="#3-1-2-双括号语法" class="headerlink" title="3.1.2 双括号语法"></a>3.1.2 双括号语法</h4><p>vue 提供的 <code>&#123;&#123; &#125;&#125;</code> 语法，专门用来解决 v-text 会覆盖默认文本内容的问题。这种 <code>&#123;&#123; &#125;&#125;</code> 语法的专业名称是插值表达 式（英文名为：Mustache）。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用 &#123;&#123; &#125;&#125; 插值表达式，将对应的值渲染到元素的内容节点中 --&gt;</span><br><span class="line">&lt;!-- 同时保留元素自身的默认值 --&gt;</span><br><span class="line">&lt;p&gt;</span><br><span class="line">    姓名: &#123;&#123;username&#125;&#125;</span><br><span class="line">&lt;/p&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意: 相对于 v-text 指令来说, 插值表达式在开发中更常用一些! 因为它不会覆盖元素中默认的文本内容</p></blockquote><p>在 vue 提供的模板渲染语法中，除了支持绑定简单的数据值之外，还支持 Javascript 表达式的运算，例如</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; number + 1 &#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123; ok ? &#x27;Yes&#x27; : &#x27;No&#x27;&#125;&#125;</span><br><span class="line"></span><br><span class="line">&#123;&#123; message.split(&#x27;&#x27;)revverse().join(&#x27;&#x27;) &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">&quot;&#x27;list&#x27; + id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-1-3-v-html"><a href="#3-1-3-v-html" class="headerlink" title="3.1.3 v-html"></a>3.1.3 v-html</h4><p>v-text 指令和插值表达式只能渲染纯文本内容。如果要把包含 HTML 标签的字符串渲染为页面的 HTML 元素， 则需要用到 v-html 这个指令：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 假设 data 中定义了名为 discription 的数据,数据的值包含 HTML 标签 的字符串 --&gt;</span><br><span class="line">&lt;p v-html=&quot;discription&quot;&gt;&lt;/p&gt;</span><br></pre></td></tr></table></figure><h3 id="3-2-属性绑定指令"><a href="#3-2-属性绑定指令" class="headerlink" title="3.2  属性绑定指令"></a>3.2  属性绑定指令</h3><p>如果需要为元素的属性动态绑定属性值,则需要用到 v-bind 属性绑定指令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 假设有如下的 data 数据</span><br><span class="line">data: &#123;</span><br><span class="line">inputValue: &#x27;请输入内容&#x27;,</span><br><span class="line">imgSrc: &#x27;https://cn.vuejs.org/images/logo.png&#x27;</span><br><span class="line">&#125;</span><br><span class="line">--&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 使用 v-bind 指令, 为 input 的 placeholder 动态绑定属性值 --&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-bind:placeholder=&quot;inputValue&quot; /&gt;</span><br><span class="line"></span><br><span class="line">&lt;img v-bind:src=&quot;imgSrc&quot; alt=&quot;&quot; /&gt;</span><br></pre></td></tr></table></figure><h4 id="3-2-1-属性绑定指令的简写形式"><a href="#3-2-1-属性绑定指令的简写形式" class="headerlink" title="3.2.1 属性绑定指令的简写形式"></a>3.2.1 属性绑定指令的简写形式</h4><p>由于 v-bind 指令在开发中使用频率非常高，因此，vue 官方为其提供了简写形式（简写为英文的 : ）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;X-UA-Compatible&quot;</span> <span class="attr">content</span>=<span class="string">&quot;IE=edge&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">:placeholder</span>=<span class="string">&quot;inputValue&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">br</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">:src</span>=<span class="string">&quot;imgSrc&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;height: 100px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">inputValue</span>: <span class="string">&#x27;请输入内容&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">imgSrc</span>: <span class="string">&#x27;./Website01/images/bg.jpg&#x27;</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-3-事件绑定指令"><a href="#3-3-事件绑定指令" class="headerlink" title="3.3 事件绑定指令"></a>3.3 事件绑定指令</h3><p>vue 提供了 v-on 事件绑定指令，用来辅助程序员为 DOM 元素绑定事件监听。语法格式如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>count 的值为: &#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;addCount&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：原生 DOM 对象有 onclick、oninput、onkeyup 等原生事件，替换为 vue 的事件绑定形式后， 分别为：v-on:click、v-on:input、v-on:keyup</p></blockquote><p>通过 v-on 绑定的事件处理函数，需要在 methods 节点中进行声明：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">data</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">count</span>: <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">methods</span>: &#123;         <span class="comment">// v-on 绑定的事件处理函数需要声明在 methods 节点中</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">addCount</span>(<span class="params"></span>) &#123;   <span class="comment">//事件处理函数的名字</span></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// this 表示当前 new 出来的 vm 实例对象</span></span></span><br><span class="line"><span class="language-javascript">                <span class="comment">//通过 this 可以访问到 data 中的数据</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">count</span> += <span class="number">1</span>    </span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-3-1-事件绑定的简写形式"><a href="#3-3-1-事件绑定的简写形式" class="headerlink" title="3.3.1 事件绑定的简写形式"></a>3.3.1 事件绑定的简写形式</h4><p>由于 v-on 指令在开发中使用频率非常高，因此，vue 官方为其提供了简写形式（简写为英文的 @ ）。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span>&gt;</span>count 的值为：&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 完整写法 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;addCount&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 简写形式 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果事件处理函数中的代码足够简单，只有一行代码，可以简写到行内 --&gt;</span>、</span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">clock</span>=<span class="string">&quot;count += 1&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-3-2-事件对象-event"><a href="#3-3-2-事件对象-event" class="headerlink" title="3.3.2 事件对象 event"></a>3.3.2 事件对象 event</h4><p>在原生的 DOM 事件绑定中，可以在事件处理函数的形参处，接收事件对象 event(简写为e)。同理，在 v-on 指令（简 写为 @ ）所绑定的事件处理函数中，同样可以接收到事件对象 event，示例代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3&gt;count 的值为: &#123;&#123;count&#125;&#125;&lt;/h3&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;addCount&quot;</span>&gt;</span>+1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="comment">// ---------------------------------</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">addCount</span>(<span class="params">e</span>) &#123;</span><br><span class="line"><span class="keyword">const</span> nowBagColor = e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span>;</span><br><span class="line">e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = nowBgColor === <span class="string">&#x27;red&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">cout</span> += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-3-绑定事件并传参"><a href="#3-3-3-绑定事件并传参" class="headerlink" title="3.3.3 绑定事件并传参"></a>3.3.3 绑定事件并传参</h4><p>在使用 v-on 指令绑定事件时，可以使用 ( ) 进行传参，示例代码如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;h3&gt;count 的值为: &#123;&#123;count&#125;&#125;&lt;/h3&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;addNewCount(2)&quot;</span>&gt;</span>+2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="comment">// ---------------------------------</span></span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">addNewCount</span>(<span class="params">step</span>) &#123;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">count</span> += step;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-4-event"><a href="#3-3-4-event" class="headerlink" title="3.3.4 $event"></a>3.3.4 $event</h4><p>$event 是 vue 提供的特殊变量，用来表示原生的事件参数对象 event。$event 可以解决事件参数对象 event  被覆盖的问题。示例用法如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>count 的值为: &#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">&quot;addNewCount(2, $event)&quot;</span>&gt;</span>+2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">addNewCount</span>(<span class="params">step, e</span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> nowBagColor = e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span>;</span><br><span class="line">e.<span class="property">target</span>.<span class="property">style</span>.<span class="property">backgroundColor</span> = nowBgColor === <span class="string">&#x27;red&#x27;</span> ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;red&#x27;</span>;</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">count</span> += step;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-3-5-事件修饰符"><a href="#3-3-5-事件修饰符" class="headerlink" title="3.3.5 事件修饰符"></a>3.3.5 事件修饰符</h4><p>在事件处理函数中调用 preventDefault() 或 stopPropagation() 是非常常见的需求。因此，vue 提供了事件 修饰符的概念，来辅助程序员更方便的对事件的触发进行控制。常用的 5 个事件修饰符如下：</p><table><thead><tr><th>事件修饰符</th><th>说明</th></tr></thead><tbody><tr><td>.prevent</td><td>阻止默认行为 ( 例如: 阻止 a 链接的跳转, 阻止表单的提交等)</td></tr><tr><td>.stop</td><td>阻止事件冒泡</td></tr><tr><td>.capture</td><td>以捕获模式触发当前的事件处理函数</td></tr><tr><td>.once</td><td>绑定的事件只触发1次</td></tr><tr><td>.self</td><td>只有在 event.target 是当前元素自身出发事件处理函数</td></tr></tbody></table><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 触发 click 点击事件时,阻止 a 链接的默认跳转行为 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://www.baidu.com&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;onLinkClick&quot;</span>&gt;</span>百度首页<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-3-6-按键修饰符"><a href="#3-3-6-按键修饰符" class="headerlink" title="3.3.6 按键修饰符"></a>3.3.6 按键修饰符</h4><p>在监听键盘事件时，我们经常需要判断详细的按键。此时，可以为键盘相关的事件添加按键修饰符，例如</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 只有在 &#x27;key&#x27; 是 &#x27;Enter&#x27; 时调用 &#x27;vm.submit()&#x27; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 只有在 &#x27;key&#x27; 是 &#x27;Esc&#x27; 时调用 &#x27;vm.clearInput()&#x27; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">keyup.esc</span>=<span class="string">&quot;clearInput&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-4-双向绑定指令"><a href="#3-4-双向绑定指令" class="headerlink" title="3.4 双向绑定指令"></a>3.4 双向绑定指令</h3><p>vue 提供了 v-model 双向数据绑定指令，用来辅助开发者在不操作 DOM 的前提下，快速获取表单的数据。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>用户名是：&#123;&#123;username&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;username&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">P</span>&gt;</span>选中的省份是：&#123;&#123;province&#125;&#125;<span class="tag">&lt;/<span class="name">P</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">&quot;province&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span>&gt;</span>--请选择--<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span>&gt;</span>北京<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span>&gt;</span>河北<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span>&gt;</span>黑龙江<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：v-model 指令只能配合表单元素使用</p></blockquote><h4 id="3-4-1-v-model-指令的修饰符"><a href="#3-4-1-v-model-指令的修饰符" class="headerlink" title="3.4.1 v-model 指令的修饰符"></a>3.4.1 v-model 指令的修饰符</h4><p>为了方便对用户输入的内容进行处理，vue 为 v-model 指令提供了 3 个修饰符，分别是：</p><table><thead><tr><th>修饰符</th><th>作用</th><th>示例</th></tr></thead><tbody><tr><td>.number</td><td>自动将用户的输入值转为数值类型</td><td><code>&lt;input v-model.number=&quot;age&quot; /&gt;</code></td></tr><tr><td>.trim</td><td>自动过滤用户输入的首位空白字符</td><td><code>&lt;input v-model.trim=&quot;msg&quot; /&gt;</code></td></tr><tr><td>.lazy</td><td>在 ”change“ 时而非 ”input“ 时更新</td><td><code>&lt;input v-model.lazy=&quot;msg&quot; /&gt;</code></td></tr></tbody></table><h3 id="3-5-条件渲染指令"><a href="#3-5-条件渲染指令" class="headerlink" title="3.5 条件渲染指令"></a>3.5 条件渲染指令</h3><p>条件渲染指令用来辅助开发者按需控制 DOM 的显示与隐藏。条件渲染指令有如下两个，分别是：</p><ul><li>v-if</li><li>v-show</li></ul><h4 id="3-5-1-v-if-和-v-show-的区别"><a href="#3-5-1-v-if-和-v-show-的区别" class="headerlink" title="3.5.1 v-if 和 v-show 的区别"></a>3.5.1 v-if 和 v-show 的区别</h4><p>实现原理不同：</p><ul><li><p>v-if 指令会动态地创建或移除 DOM 元素，从而控制元素在页面上的显示与隐藏</p></li><li><p>v-show 指令会动态为元素添加或移除 style=”display: none;” 样式，从而控制元素的显示与隐藏；</p></li></ul><p>性能消耗不同：</p><p>v-if 有更高的切换开销，而 v-show 有更高的初始渲染开销。</p><ul><li>如果需要非常频繁地切换，则使用 v-show 较好</li><li>如果在运行时条件很少改变，则使用 v-if 较好</li></ul><h4 id="3-5-2-v-else"><a href="#3-5-2-v-else" class="headerlink" title="3.5.2 v-else"></a>3.5.2 v-else</h4><p>v-if 可以单独使用，或配合 v-else 指令一起使用：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;Math.random() &gt; 0.5&quot;</span>&gt;</span></span><br><span class="line">    随机数大于 0.5</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">    随机数小于或等于 0.5</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-5-3-v-else-if"><a href="#3-5-3-v-else-if" class="headerlink" title="3.5.3 v-else-if"></a>3.5.3 v-else-if</h4><p>v-else-if 指令，顾名思义，充当 v-if 的“else-if 块”，可以连续使用：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;type === &#x27;A&#x27;&quot;</span>&gt;</span>优秀<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &#x27;B&#x27;&quot;</span>&gt;</span>良好<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">&quot;type === &#x27;C&#x27;&quot;</span>&gt;</span>一般<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span>差<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3-6-列表渲染指令"><a href="#3-6-列表渲染指令" class="headerlink" title="3.6 列表渲染指令"></a>3.6 列表渲染指令</h3><p>vue 提供了 v-for 指令，用来辅助开发者基于一个数组来循环渲染相似的 UI 结构。</p><p>v-for 指令需要使用 item in items 的特殊语法，其中：</p><ul><li><p>items 是待循环的数组</p></li><li><p>item 是当前的循环项</p></li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line"><span class="attr">list</span>: [</span><br><span class="line">&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;,</span><br><span class="line">&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;ls&#x27;</span>&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;item in list&quot;</span>&gt;</span>姓名是：&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-6-1-v-for-中的索引"><a href="#3-6-1-v-for-中的索引" class="headerlink" title="3.6.1 v-for 中的索引"></a>3.6.1 v-for 中的索引</h4><p>v-for 指令还支持一个可选的第二个参数，即当前项的索引。语法格式为 (item, index) in items，示例代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line"><span class="attr">list</span>: [</span><br><span class="line">&#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>&#125;,</span><br><span class="line">&#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">&#x27;ls&#x27;</span>&#125;</span><br><span class="line">]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in list&quot;</span>&gt;</span>索引是：&#123;&#123;index&#125;&#125;，姓名是：&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：v-for 指令中的 item 项和 index 索引都是形参，可以根据需要进行重命名。例如 (user, i) in userlist</p></blockquote><h4 id="3-6-2-使用-key-维护列表的状态"><a href="#3-6-2-使用-key-维护列表的状态" class="headerlink" title="3.6.2 使用 key 维护列表的状态"></a>3.6.2 使用 key 维护列表的状态</h4><p>当列表的数据变化时，默认情况下，vue 会尽可能的复用已存在的 DOM 元素，从而提升渲染的性能。但这种 默认的性能优化策略，会导致有状态的列表无法被正确更新。 为了给 vue 一个提示，以便它能跟踪每个节点的身份，从而在保证有状态的列表被正确更新的前提下，提升渲 染的性能。此时，需要为每项提供一个唯一的 key 属性：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 用户列表区域 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 加 key 属性的好处: --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1. 正确维护列表的状态 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 2. 复用现有的 DOM 元素,提升渲染的性能 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">&quot;user in userlist&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;user.id&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> /&gt;</span></span><br><span class="line">        姓名: &#123;&#123;user.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-6-3-key-的注意事项"><a href="#3-6-3-key-的注意事项" class="headerlink" title="3.6.3 key 的注意事项"></a>3.6.3 key 的注意事项</h4><ul><li>key 的值只能是字符串或数字类型</li><li>key 的值必须具有唯一性（即：key 的值不能重复）</li><li>建议把数据项 id 属性的值作为 key 的值（因为 id 属性的值具有唯一性）</li><li>使用 index 的值当作 key 的值没有任何意义（因为 index 的值不具有唯一性）</li><li>建议使用 v-for 指令时一定要指定 key 的值（既提升性能、又防止列表状态紊乱）</li></ul><h3 id="3-7-过滤器"><a href="#3-7-过滤器" class="headerlink" title="3.7 过滤器"></a>3.7 过滤器</h3><p>过滤器（Filters）常用于文本的格式化。例如： hello -&gt; Hello</p><p>过滤器应该被添加在 JavaScript 表达式的尾部，由“管道符”进行调用，示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 在双花括号中通过&quot;管道符&quot;调用 capitalize 过滤器,对 message 的值进行格式化 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message | capitalize &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 在 v-bind 中通过&quot;管道符&quot;调用 formatId 过滤器,对 rawId的值进行格式化 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind</span>=<span class="string">&quot;rawId | formatId&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>过滤器可以用在两个地方：插值表达式和 v-bind 属性绑定。</p></blockquote><h4 id="3-7-1-定义过滤器"><a href="#3-7-1-定义过滤器" class="headerlink" title="3.7.1 定义过滤器"></a>3.7.1 定义过滤器</h4><p>在创建 vue 实例期间，可以在 filters 节点中定义过滤器，示例代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">message</span>: <span class="string">&#x27;hello vue.js&#x27;</span>,</span><br><span class="line">        <span class="attr">info</span>: <span class="string">&#x27;title info&#x27;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">filters</span>: &#123;<span class="comment">//在 filters 节点下定义&quot;过滤器&quot;</span></span><br><span class="line">        <span class="title function_">capitalize</span>(<span class="params">str</span>) &#123;<span class="comment">// 把首字符大写的过滤器</span></span><br><span class="line">            <span class="keyword">return</span> str.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + str.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-7-2-私有过滤器和全局过滤器"><a href="#3-7-2-私有过滤器和全局过滤器" class="headerlink" title="3.7.2 私有过滤器和全局过滤器"></a>3.7.2 私有过滤器和全局过滤器</h4><p>在 filters 节点下定义的过滤器，称为“私有过滤器”，因为它只能在当前 vm 实例所控制的 el 区域内使用。 如果希望在多个 vue 实例之间共享过滤器，则可以按照如下的格式定义全局过滤器：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 全局过滤器 - 独立于每个 vm 实例之外</span></span><br><span class="line"><span class="comment">// Vue.filter() 方法接受两个参数</span></span><br><span class="line"><span class="comment">// 第一个参数,是全局过滤器的&quot;名字&quot;</span></span><br><span class="line"><span class="comment">// 第二个参数,是全局过滤器的&quot;处理函数&quot;</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;capitalize&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> str.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + str.<span class="title function_">slice</span>(<span class="number">1</span>) + <span class="string">&#x27;~~~&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-7-3-连续调用多个过滤器"><a href="#3-7-3-连续调用多个过滤器" class="headerlink" title="3.7.3 连续调用多个过滤器"></a>3.7.3 连续调用多个过滤器</h4><p>过滤器可以串联地进行调用，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 把 message 的值,交给 filterA 进行处理 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 把 filterA 处理的结果,再交给 filterB 进行处理 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 最终把 filterB 处理的结果,作为最终的值渲染到页面上 --&gt;</span></span><br><span class="line">&#123;&#123;message | filterA | filterB&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;&#123;&#123; text | capitalize | maxLength &#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局过滤器 - 首字母大写</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;capitalize&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line"><span class="keyword">return</span> str.<span class="title function_">charAt</span>(<span class="number">0</span>).<span class="title function_">toUpperCase</span>() + str.<span class="title function_">slice</span>(<span class="number">1</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 全局过滤器 - 控制文本的最大长度</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;maxLength&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (str.<span class="property">length</span> &lt;= <span class="number">10</span>) <span class="keyword">return</span> str</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">strslice</span>(<span class="number">0</span>, <span class="number">10</span>) + <span class="string">&#x27;...&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-7-4-过滤器传参"><a href="#3-7-4-过滤器传参" class="headerlink" title="3.7.4 过滤器传参"></a>3.7.4 过滤器传参</h4><p>过滤器的本质是 JavaScript 函数，因此可以接收参数，格式如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- arg1 和 arg2 是传递给 filterA 的参数 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; message | filterA(arg1, arg2) &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 过滤器处理函数中的形参:</span></span><br><span class="line"><span class="comment">// 第一个参数: 永远都是&quot;管道符&quot;前面的待处理的值</span></span><br><span class="line"><span class="comment">// 从第二个参数开始: 才是调用过滤器时传递过来的 arg1 和 arg2 参数</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;filterA&#x27;</span>, <span class="function">(<span class="params">msg, arg1, arg2</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 逻辑代码...</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-7-5-过滤器的兼容性"><a href="#3-7-5-过滤器的兼容性" class="headerlink" title="3.7.5 过滤器的兼容性"></a>3.7.5 过滤器的兼容性</h4><p>过滤器仅在 vue 2.x 和 1.x 中受支持，在 vue 3.x 的版本中剔除了过滤器相关的功能。</p><p>在企业级项目开发中：</p><ul><li><p>如果使用的是 2.x 版本的 vue，则依然可以使用过滤器相关的功能</p></li><li><p>如果项目已经升级到了 3.x 版本的 vue，官方建议使用计算属性或方法代替被剔除的过滤器功能</p></li></ul><h3 id="3-8-品牌列表案例"><a href="#3-8-品牌列表案例" class="headerlink" title="3.8 品牌列表案例"></a>3.8 品牌列表案例</h3><h4 id="3-8-0-整体实现步骤"><a href="#3-8-0-整体实现步骤" class="headerlink" title="3.8.0 整体实现步骤"></a>3.8.0 整体实现步骤</h4><ol><li>创建基本的 vue 实例</li><li>基于 vue 渲染表格数据</li><li>实现添加品牌的功能</li><li>实现删除品牌的功能</li><li>实现修改品牌状态的功能</li></ol><h4 id="3-8-1-创建基本的-vue-实例"><a href="#3-8-1-创建基本的-vue-实例" class="headerlink" title="3.8.1 创建基本的 vue 实例"></a>3.8.1 创建基本的 vue 实例</h4><ul><li>导入 vue 的 js 文件 -&gt; 在  标签中声明 el 区域</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>创建 vue 实例对象</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">el</span>: <span class="string">&#x27;#app&#x27;</span>,</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">brandlist</span>: [</span><br><span class="line">            &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">brandname</span>:<span class="string">&#x27;宝马&#x27;</span>, <span class="attr">state</span>: <span class="literal">true</span>, <span class="attr">addtime</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125;,</span><br><span class="line">            &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">brandname</span>:<span class="string">&#x27;奥迪&#x27;</span>, <span class="attr">state</span>: <span class="literal">false</span>, <span class="attr">addtime</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125;,</span><br><span class="line">            &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">brandname</span>:<span class="string">&#x27;奔驰&#x27;</span>, <span class="attr">state</span>: <span class="literal">true</span>, <span class="attr">addtime</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125;,</span><br><span class="line">        ],</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="3-8-2-基于-vue-渲染表格数据"><a href="#3-8-2-基于-vue-渲染表格数据" class="headerlink" title="3.8.2 基于 vue 渲染表格数据"></a>3.8.2 基于 vue 渲染表格数据</h4><ul><li>使用 v-for 指令循环渲染表格的数据：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in brandlist&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;index + 1&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;item.brandname&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;item.state&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;item.addtime&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>将品牌的状态渲染为 Switch 开关效果：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;custom-control custom-switch&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;custom-control-input&quot;</span> <span class="attr">:id</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;item.state&quot;</span> /&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;custom-control-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;item.state&quot;</span>&gt;</span>已启用<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;custom-control-label&quot;</span> <span class="attr">:for</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">v-else</span>&gt;</span>已禁用<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><p>Switch 开关效果的官方文档地址： <a href="https://v4.bootcss.com/docs/components/forms/#switches">https://v4.bootcss.com/docs/components/forms/#switches</a></p><ul><li>使用全局过滤器对时间进行格式化：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123;item.addtime | dateFoemate&#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="title function_">filter</span>(<span class="string">&#x27;dateFormate&#x27;</span>, <span class="function">(<span class="params">str</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> dt = <span class="keyword">new</span> <span class="title class_">Date</span>(dtStr)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> y = dt.<span class="title function_">getFullYear</span>()</span><br><span class="line">    <span class="keyword">const</span> m = <span class="title function_">padZero</span>(dt.<span class="title function_">getMonth</span>() + <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">const</span> d = <span class="title function_">padZero</span>(dt.<span class="title function_">getDate</span>())</span><br><span class="line">    <span class="keyword">const</span> hh = <span class="title function_">padZero</span>(dt.<span class="title function_">getHours</span>())</span><br><span class="line">    <span class="keyword">const</span> mm = <span class="title function_">padZero</span>(dt.<span class="title function_">getMintues</span>())</span><br><span class="line">    <span class="keyword">const</span> ss = <span class="title function_">padZero</span>(dt.<span class="title function_">getSeconds</span>())</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span>`</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义补零函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">padZero</span>(<span class="params">n</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> n &gt; <span class="number">9</span> ? n : <span class="string">&#x27;0&#x27;</span> + n</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="3-8-3-添加品牌"><a href="#3-8-3-添加品牌" class="headerlink" title="3.8.3 添加品牌"></a>3.8.3 添加品牌</h4><ul><li>阻止表单的默认提交行为</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">&quot;form-inline&quot;</span> @<span class="attr">submit.prevent</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>为 input 输入框进行 v-model 双向数据绑定：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入品牌名称&quot;</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;brandname&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：需要在 data 数据中声明 brandname 属性字段。</p></blockquote><ul><li>为“添加品牌”的 button 按钮绑定 click 事件处理函数：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span> <span class="attr">class</span>=<span class="string">&quot;btn btn-primary mb-2&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;addNewBrand&quot;</span>&gt;</span>添加品牌<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>在 data 中声明 nextId 属性（用来记录下一个可用的 id 值），并在 methods 中声明 addNewBrand 事件处理函数：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">nextId</span>: <span class="number">4</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">addNewBrand</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="variable language_">this</span>.<span class="property">brandname</span>) <span class="keyword">return</span> <span class="title function_">alert</span>(<span class="string">&#x27;品牌名不能为空！&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">brandlist</span>.<span class="title function_">push</span>(&#123; <span class="attr">id</span>: <span class="variable language_">this</span>.<span class="property">nextId</span>, <span class="attr">brandname</span>: <span class="variable language_">this</span>.<span class="property">brandname</span>, <span class="attr">state</span>: <span class="literal">true</span>, <span class="attr">addtime</span>: <span class="keyword">new</span> <span class="title class_">Date</span>() &#125;)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">brandname</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">nextId</span> ++</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>监听 input 输入框的 keyup 事件，通过 .esc 按键修饰符快速清空文本框中的内容：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入品牌名称&quot;</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;brandname&quot;</span> @<span class="attr">keyup.esc</span>=<span class="string">&quot;brandname=&#x27;&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="3-8-4-删除品牌"><a href="#3-8-4-删除品牌" class="headerlink" title="3.8.4 删除品牌"></a>3.8.4 删除品牌</h4><ul><li>为删除的 a 链接绑定 click 点击事件处理函数，并阻止其默认行为：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;#&quot;</span> @<span class="attr">click.prevent</span>=<span class="string">&quot;removeBrand(item.id)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>在 methods 节点中声明 removeBrand 事件处理函数如下</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">removeBrand</span>(<span class="params">id</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">brandlist</span> = <span class="variable language_">this</span>.<span class="property">brandlist</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">id</span> !== id)</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="4-单页面应用程序"><a href="#4-单页面应用程序" class="headerlink" title="4 单页面应用程序"></a>4 单页面应用程序</h2><h3 id="4-1-什么是单页面应用程序"><a href="#4-1-什么是单页面应用程序" class="headerlink" title="4.1 什么是单页面应用程序"></a>4.1 什么是单页面应用程序</h3><p>单页面应用程序（英文名：Single Page Application）简称 SPA，顾名思义，指的是一个 Web 网站中只有唯一的一个 HTML 页面，所有的功能与交互都在这唯一的一个页面内完成。</p><h3 id="4-2-单页面应用程序的特点"><a href="#4-2-单页面应用程序的特点" class="headerlink" title="4.2 单页面应用程序的特点"></a>4.2 单页面应用程序的特点</h3><p>单页面应用程序将所有的功能局限于一个 web 页面中，仅在该 web 页面初始化时加载相应的资源（ HTML、 JavaScript 和 CSS）。</p><p> 一旦页面加载完成了，SPA 不会因为用户的操作而进行页面的重新加载或跳转。而是利用 JavaScript 动态地变换 HTML 的内容，从而实现页面与用户的交互</p><h3 id="4-3-单页面应用程序的优点"><a href="#4-3-单页面应用程序的优点" class="headerlink" title="4.3 单页面应用程序的优点"></a>4.3 单页面应用程序的优点</h3><ol><li>良好的交互体验</li></ol><ul><li>单页应用的内容的改变不需要重新加载整个页面</li><li>获取数据也是通过 Ajax 异步获取</li><li>没有页面之间的跳转，不会出现“白屏现象”</li></ul><ol start="2"><li>良好的前后全分离公式</li></ol><ul><li>后端专注于提供 API 接口，更易实现 API 接口的复用</li><li>前端专注于页面的渲染，更利于前端工程化的发展</li></ul><ol start="3"><li>减轻服务器的压力</li></ol><ul><li>服务器只提供数据，不负责页面的合成与逻辑的处理，吞吐能力会提高几倍</li></ul><h3 id="4-4-单页面应用程序的缺点"><a href="#4-4-单页面应用程序的缺点" class="headerlink" title="4.4 单页面应用程序的缺点"></a>4.4 单页面应用程序的缺点</h3><ol><li>首屏加载慢</li></ol><ul><li>路由懒加载</li><li>代码压缩</li><li>CDN 加速</li><li>网络传输压缩</li></ul><ol start="2"><li>不利于 SEO</li></ol><ul><li>SEO 服务器端渲染</li></ul><h3 id="4-5-如何快速创建-vue-的-SPA-项目"><a href="#4-5-如何快速创建-vue-的-SPA-项目" class="headerlink" title="4.5 如何快速创建 vue 的 SPA 项目"></a>4.5 如何快速创建 vue 的 SPA 项目</h3><p>vue 官方提供了两种快速创建工程化的 SPA 项目的方式：</p><ol><li>基于 vite 创建 SPA 项目</li><li>基于 vue-cli 创建 SPA 项目</li></ol><table><thead><tr><th></th><th>vite</th><th>vue-cli</th></tr></thead><tbody><tr><td>支持的 vue 版本</td><td>仅支持 vue3.x</td><td>支持 3.x 和 2.x</td></tr><tr><td>是否基于 webpack</td><td>否</td><td>是</td></tr><tr><td>运行速度</td><td>快</td><td>较慢</td></tr><tr><td>功能完整度</td><td>小而巧（逐渐完善）</td><td>大而全</td></tr><tr><td>是否建议在企业级开发中使用</td><td>目前不建议</td><td>建议在企业级开发中使用</td></tr></tbody></table><h2 id="5-vite-的基本使用"><a href="#5-vite-的基本使用" class="headerlink" title="5 vite 的基本使用"></a>5 vite 的基本使用</h2><h3 id="5-1-创建-vite-的项目"><a href="#5-1-创建-vite-的项目" class="headerlink" title="5.1 创建 vite 的项目"></a>5.1 创建 vite 的项目</h3><p>按照顺序执行如下的命令，即可基于 vite 创建 vue 3.x 的工程化项目</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">npm init vite-app 项目名称</span><br><span class="line"> </span><br><span class="line"><span class="built_in">cd</span> 项目名称</span><br><span class="line">npm install</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h3 id="5-2-梳理项目的结构"><a href="#5-2-梳理项目的结构" class="headerlink" title="5.2 梳理项目的结构"></a>5.2 梳理项目的结构</h3><p>使用 vite 创建的项目结构如下：</p><ul><li>node_modules 目录用来存放第三方依赖包</li><li>public 是公共的静态资源目录</li><li>src 是项目的源代码目录（程序员写的所有代码都要放在此目录下）</li><li>.gitgnore 是Git 的忽略文件</li><li>index.html 是SPA 单页面应用程序中唯一的 HTML 页面</li><li>package.json 是项目的包管理配置文件</li><li>assets目录是用来存放项目中所有的静态资源文件（css，fonts 等）</li><li>components 目录用来存放项目中所有的自定义组件</li><li>App.vue 是项目的根组件</li><li>index.css 是项目的全局样式表文件</li><li>main.js 是整个项目的打包入口文件</li></ul><h3 id="5-3-vite-项目的运行流程"><a href="#5-3-vite-项目的运行流程" class="headerlink" title="5.3 vite 项目的运行流程"></a>5.3 vite 项目的运行流程</h3><p>在工程化的项目中，vue 要做的事情很单纯：通过 main.js 把 App.vue 渲染到 index.html 的指定区域中。</p><p>其中：</p><ol><li>App.vue 用来编写待渲染的模板结构</li><li>index.html 中需要预留一个 el 区域</li><li>main.js 把 App.vue 渲染到了 index.html 所预留的区域中</li></ol><h4 id="5-3-1-在-App-vue-中编写模板结构"><a href="#5-3-1-在-App-vue-中编写模板结构" class="headerlink" title="5.3.1 在 App.vue 中编写模板结构"></a>5.3.1 在 App.vue 中编写模板结构</h4><p>清空 App.vue 的默认内容，并书写如下的模板结构</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h1&gt;这是 App 根组件&lt;/h1&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="5-3-2-在-index-html-中预留-el-区域"><a href="#5-3-2-在-index-html-中预留-el-区域" class="headerlink" title="5.3.2 在 index.html 中预留 el 区域"></a>5.3.2 在 index.html 中预留 el 区域</h4><p>打开 index.html 页面，确认预留了 el 区域</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- id 为 app 的 div 元素，就是将来 vue 要控制的区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;moudle&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/src/main.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="5-3-3-在-main-js-中进行渲染"><a href="#5-3-3-在-main-js-中进行渲染" class="headerlink" title="5.3.3 在 main.js 中进行渲染"></a>5.3.3 在 main.js 中进行渲染</h4><p>按照 vue 3.x 的标准用法，把 App.vue 中的模板内容渲染到 index.html 页面的 el 区域中：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. 从 vue 中按需导入 createApp 函数</span></span><br><span class="line"><span class="comment">// createApp 函数的作用：创建 vue 的“单页面应用程序实例”</span></span><br><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">// 2. 导入待渲染的 App 组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.调用 createApp() 函数，返回值是“单页面应用程序的实例”，用常量 spa_app 进行接收，同时把 App 组件作为参数传给 createApp 函数，表示要把 App 渲染到 index.html 页面上</span></span><br><span class="line"><span class="keyword">const</span> spa_app = <span class="title function_">createApp</span>(app)</span><br><span class="line"><span class="comment">//4. 调用 spa_app 实例的 mount 方法，用来指定 vue 实例要控制的区域</span></span><br><span class="line">spa_app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="6-组件化开发思想"><a href="#6-组件化开发思想" class="headerlink" title="6 组件化开发思想"></a>6 组件化开发思想</h2><h3 id="6-1-什么是组件化开发"><a href="#6-1-什么是组件化开发" class="headerlink" title="6.1 什么是组件化开发"></a>6.1 什么是组件化开发</h3><p>组件化开发指的是：根据封装的思想，把页面上可重用的部分封装为组件，从而方便项目的开发和维护。</p><h3 id="6-2-组件化开发的好处"><a href="#6-2-组件化开发的好处" class="headerlink" title="6.2 组件化开发的好处"></a>6.2 组件化开发的好处</h3><ul><li>提高了前端代码的复用性和灵活性</li><li>提升了开发效率和后期的可维护性</li></ul><h3 id="6-3-vue-中的组件化开发"><a href="#6-3-vue-中的组件化开发" class="headerlink" title="6.3 vue 中的组件化开发"></a>6.3 vue 中的组件化开发</h3><p>vue 是一个完全支持组件化开发的框架。vue 中规定组件的后缀名是 .vue。之前接触到的 App.vue 文件本质 上就是一个 vue 的组件。</p><h2 id="7-vue-组件的构成"><a href="#7-vue-组件的构成" class="headerlink" title="7 vue 组件的构成"></a>7 vue 组件的构成</h2><h3 id="7-1-vue-组件组成结构"><a href="#7-1-vue-组件组成结构" class="headerlink" title="7.1 vue 组件组成结构"></a>7.1 vue 组件组成结构</h3><p>每个 .vue 组件都由 3 部分构成，分别是：</p><ul><li>template -&gt; 组件的模板结构</li><li>script -&gt; 组件的 JavaScript 行为</li><li>style -&gt; 组件的样式</li></ul><blockquote><p>其中，每个组件中必须包含 template 模板结构，而 script 行为和 style 样式是可选的组成部分。</p></blockquote><h3 id="7-2-组件的-template-节点"><a href="#7-2-组件的-template-节点" class="headerlink" title="7.2 组件的 template 节点"></a>7.2 组件的 template 节点</h3><p>vue 规定：每个组件对应的模板结构，需要定义到 </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- 当前组件的 DOM 结构，需要定义到 template 标签内部 --&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：<code>&lt;template&gt;</code> 是 vue 提供的容器标签，只起到包裹性质的作用，它不会被渲染为真正的 DOM 元素。</p></blockquote><h4 id="7-2-1-在-template-中使用指令"><a href="#7-2-1-在-template-中使用指令" class="headerlink" title="7.2.1 在 template 中使用指令"></a>7.2.1 在 template 中使用指令</h4><p>在组件的 <code>&lt;template&gt;</code> 节点中，支持使用前面所学的指令语法，来辅助开发者渲染当前组件的 DOM 结构。代码示例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h1&gt;这是 App 根组件&lt;/h1&gt;</span><br><span class="line">&lt;p&gt;生成一个随机数字：&#123;&#123; (Math.random() * 10).toFixed(2) &#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p :title=&quot;new Date().toLocaleTimeString*()&quot;&gt;我在黑马学 vue&lt;/p&gt;</span><br><span class="line">&lt;p @click=&quot;showInfo&quot;&gt;按钮&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="7-2-2-在-template-中定义根节点"><a href="#7-2-2-在-template-中定义根节点" class="headerlink" title="7.2.2 在 template 中定义根节点"></a>7.2.2 在 template 中定义根节点</h4><p>在 vue 2.x 的版本中，<code>&lt;template&gt;</code> 节点内的 DOM 结构仅支持单个根节点：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- vue 2.x 中，template 节点内的所有元素，最外层“必须有”唯一的根节点进行包裹，否则报错 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 App 根组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是副标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p>但是，在 vue 3.x 的版本中，<code>&lt;template&gt;</code> 中支持定义多个根节点：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 这是包含多个根节点的 template 结构，因为 h1 标签和 h2 标签外层没有包裹性根元素 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 App 根组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h2</span>&gt;</span>这是副标题<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-3-组件的-script-节点"><a href="#7-3-组件的-script-节点" class="headerlink" title="7.3 组件的 script 节点"></a>7.3 组件的 script 节点</h3><p>vue 规定：组件内的 <code>&lt;script&gt;</code> 节点是可选的，开发者可以在 <code>&lt;script&gt;</code> 节点中封装组件的 JavaScript 业务逻辑。 <code>&lt;script &gt;</code> 节点的基本结构如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 今后，组将相关的 data 数据、methods 方法等，都需要定义到 export default 所导出的对象中</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="7-3-1-script-中的-name-节点"><a href="#7-3-1-script-中的-name-节点" class="headerlink" title="7.3.1 script 中的 name 节点"></a>7.3.1 script 中的 name 节点</h4><p>可以通过 name 节点为当前组件定义一个名称：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// name 属性指向的是当前组建的名称（建议每个单词的首字母大写）</span></span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&#x27;MyApp&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="7-3-2-script-中的-data-节点"><a href="#7-3-2-script-中的-data-节点" class="headerlink" title="7.3.2 script 中的 data 节点"></a>7.3.2 script 中的 data 节点</h4><p>vue 组件渲染期间需要用到的数据，可以定义在 data 节点中：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">name</span>: <span class="string">&#x27;MyApp&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">username</span>: <span class="string">&#x27;zs&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>组件中的 data 必须是函数.</p><p>vue 规定：组件中的 data 必须是一个函数，不能直接指向一个数据对象。因此在组件中定义 data 数据节点 时，下面的方式是错误的：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">data</span>: &#123;</span><br><span class="line">    <span class="attr">count</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="7-3-3-script-中的-methods-节点"><a href="#7-3-3-script-中的-methods-节点" class="headerlink" title="7.3.3 script 中的 methods 节点"></a>7.3.3 script 中的 methods 节点</h4><p>组件中的事件处理函数，必须定义到 methods 节点中，示例代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="attr">name</span>: <span class="string">&#x27;MyApp&#x27;</span>,</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">count</span>: <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">addCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7-4-组件的-style-节点"><a href="#7-4-组件的-style-节点" class="headerlink" title="7.4 组件的 style 节点"></a>7.4 组件的 style 节点</h3><p>vue 规定：组件内的 <code>&lt;style&gt;</code> 节点是可选的，开发者可以在 <code>&lt;style&gt;</code> 节点中编写样式美化当前组件的 UI 结构。<code>&lt;script &gt;</code> 节点的基本结构如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;css&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: normal</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>其中 <code>&lt;style&gt;</code> 标签上的 lang=”css” 属性是可选的，它表示所使用的样式语言。默认只支持普通的 css 语法，可<br>选值还有 less、scss 等</p></blockquote><h4 id="7-4-1-让-style-中支持-less-语法"><a href="#7-4-1-让-style-中支持-less-语法" class="headerlink" title="7.4.1 让 style 中支持 less 语法"></a>7.4.1 让 style 中支持 less 语法</h4><p>如果希望使用 less 语法编写组件的 style 样式，可以按照如下两个步骤进行配置：</p><ol><li>运行 npm install less -D 命令安装依赖包，从而提供 less 语法的编译支持</li><li>在 <code>&lt;style&gt;</code> 标签上添加 lang=”less” 属性，即可使用 less 语法编写组件的样式</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-tag">h1</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: normal;</span></span><br><span class="line"><span class="language-css">        <span class="selector-tag">i</span> &#123;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">color</span>: red;</span></span><br><span class="line"><span class="language-css">            <span class="attribute">font-style</span>: normal;</span></span><br><span class="line"><span class="language-css">        &#125;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-组件的基本使用"><a href="#8-组件的基本使用" class="headerlink" title="8 组件的基本使用"></a>8 组件的基本使用</h2><h3 id="8-1-组件的注册"><a href="#8-1-组件的注册" class="headerlink" title="8.1 组件的注册"></a>8.1 组件的注册</h3><p>组件之间可以进行相互的引用，例如：</p><blockquote><p>vue 中组件的引用原则：先注册后使用。</p></blockquote><h4 id="8-1-1-注册组件的两种方式"><a href="#8-1-1-注册组件的两种方式" class="headerlink" title="8.1.1 注册组件的两种方式"></a>8.1.1 注册组件的两种方式</h4><p>vue 中注册组件的方式分为“全局注册”和“局部注册”两种，其中：</p><ul><li>被全局注册的组件，可以在全局任何一个组件内使用</li><li>被局部注册的组件，只能在当前注册的范围内使用</li></ul><h4 id="8-1-2-全局注册组件"><a href="#8-1-2-全局注册组件" class="headerlink" title="8.1.2 全局注册组件"></a>8.1.2 全局注册组件</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="comment">// 1.导入Swiper 和 Test 两个组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Swiper</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MySwiper.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Test</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MyTest.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.调用 app 实例的 conponent（）方法，在全局注册 my-swiper 和 my-test 两个组件</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="string">&#x27;my-swiper&#x27;</span>, <span class="title class_">Swiper</span>)</span><br><span class="line">app.<span class="title function_">conponent</span>(<span class="string">&#x27;my-test&#x27;</span>, <span class="title class_">Test</span>)</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="8-1-3-使用全局注册组件"><a href="#8-1-3-使用全局注册组件" class="headerlink" title="8.1.3 使用全局注册组件"></a>8.1.3 使用全局注册组件</h4><p>使用 app.component() 方法注册的全局组件，直接以标签的形式进行使用即可，例如：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-swiper</span>&gt;</span><span class="tag">&lt;/<span class="name">my-swiper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-test</span>&gt;</span><span class="tag">&lt;/<span class="name">my-test</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-1-4-局部注册组件"><a href="#8-1-4-局部注册组件" class="headerlink" title="8.1.4 局部注册组件"></a>8.1.4 局部注册组件</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>这个 App 根组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-swiper</span>&gt;</span><span class="tag">&lt;/<span class="name">my-swiper</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">my-search</span>&gt;</span><span class="tag">&lt;/<span class="name">my-search</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">import</span> <span class="title class_">Search</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MySearch.vue&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">components</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="string">&#x27;my-search&#x27;</span>: <span class="title class_">Search</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-1-5-全局注册和局部注册的区别"><a href="#8-1-5-全局注册和局部注册的区别" class="headerlink" title="8.1.5 全局注册和局部注册的区别"></a>8.1.5 全局注册和局部注册的区别</h4><ul><li>被全局注册的组件，可以在全局任何一个组件内使用</li><li>被局部注册的组件，只能在当前注册的范围内使用</li></ul><p>应用场景：</p><ul><li>如果某些组件在开发期间的使用频率很高，推荐进行全局注册；</li><li>如果某些组件只在特定的情况下会被用到，推荐进行局部注册。</li></ul><h4 id="8-1-6-组件注册时名称的大小写"><a href="#8-1-6-组件注册时名称的大小写" class="headerlink" title="8.1.6 组件注册时名称的大小写"></a>8.1.6 组件注册时名称的大小写</h4><p>在进行组件的注册时，定义组件注册名称的方式有两种：</p><ul><li><p>使用 kebab-case 命名法（俗称短横线命名法，例如 my-swiper 和 my-search）</p></li><li><p>使用 PascalCase 命名法（俗称帕斯卡命名法或大驼峰命名法，例如 MySwiper 和 MySearch）</p></li></ul><p>短横线命名法的特点：</p><p>必须严格按照短横线名称进行使用</p><p>帕斯卡命名法的特点：</p><p>既可以严格按照帕斯卡名称进行使用，又可以转化为短横线名称进行使用</p><blockquote><p>注意：在实际开发中，推荐使用帕斯卡命名法为组件注册名称，因为它的适用性更强</p></blockquote><h4 id="8-1-7-通过-name-属性注册组件"><a href="#8-1-7-通过-name-属性注册组件" class="headerlink" title="8.1.7 通过 name 属性注册组件"></a>8.1.7 通过 name 属性注册组件</h4><p>在注册组件期间，除了可以直接提供组件的注册名称之外，还可以把组件的 name 属性作为注册后组件的名称， 示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>轮播图组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">name</span>: <span class="string">&#x27;MySwiper&#x27;</span> <span class="comment">// name 属性为当前组件的名字</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Swiper</span> <span class="keyword">from</span> <span class="string">&#x27;./components/MySwiper.vue&#x27;</span></span><br><span class="line">app.<span class="title function_">component</span>(<span class="title class_">Swiper</span>.<span class="property">name</span>, <span class="title class_">Swiper</span>)</span><br></pre></td></tr></table></figure><h3 id="8-2-组件之间的样式冲突问题"><a href="#8-2-组件之间的样式冲突问题" class="headerlink" title="8.2 组件之间的样式冲突问题"></a>8.2 组件之间的样式冲突问题</h3><p>默认情况下，写在 .vue 组件中的样式会全局生效，因此很容易造成多个组件之间的样式冲突问题。导致组件 之间样式冲突的根本原因是：</p><ul><li>单页面应用程序中，所有组件的 DOM 结构，都是基于唯一的 index.html 页面进行呈现的</li><li>每个组件中的样式，都会影响整个 index.html 页面中的 DOM 元素</li></ul><h4 id="8-2-1-思考：如何解决组件样式冲突的问题"><a href="#8-2-1-思考：如何解决组件样式冲突的问题" class="headerlink" title="8.2.1 思考：如何解决组件样式冲突的问题"></a>8.2.1 思考：如何解决组件样式冲突的问题</h4><p>为每个组件分配唯一的自定义属性，在编写组件样式时，通过属性选择器来控制样式的作用域，示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span> <span class="attr">data-v-001</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">data-v-001</span>&gt;</span>轮播图组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 通过中括号“属性选择器”，来防止组件之间的样式冲突问题，因为每个组件分配的自定义属性是“唯一的” */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.container</span><span class="selector-attr">[data-v-001]</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-2-2-style-节点的-scoped-属性"><a href="#8-2-2-style-节点的-scoped-属性" class="headerlink" title="8.2.2 style 节点的 scoped 属性"></a>8.2.2 style 节点的 scoped 属性</h4><p>为了提高开发效率和开发体验，vue 为 style 节点提供了 scoped 属性，从而防止组件之间的样式冲突问题：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;container&quot;</span> <span class="attr">data-v-001</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">data-v-001</span>&gt;</span>轮播图组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* style 节点的 scoped 属性，用来自动为每个组件分配唯一的“自定义属性”，并自动为当前组件的 DOM 标签和 style 样式应用这个自定义属性，防止组件的样式冲突问题 */</span></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-2-3-deep-样式穿透"><a href="#8-2-3-deep-样式穿透" class="headerlink" title="8.2.3 /deep/ 样式穿透"></a>8.2.3 /deep/ 样式穿透</h4><p>如果给当前组件的 style 节点添加了 scoped 属性，则当前组件的样式对其子组件是不生效的。如果想让某些样 式对子组件生效，可以使用 /deep/ 深度选择器。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;less&quot;</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: blue;   <span class="comment">/* 不加 /deep/ 时，生成的选择器格式为 .title[data-v-0522442de] */</span></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    </span></span><br><span class="line"><span class="language-css">    /deep/ <span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">color</span>: blue; <span class="comment">/* 加上 /deep/ 时，生成的选择器为 [data-v-052242de] .title */</span></span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意：/deep/ 是 vue2.x 中实现样式穿透的方案。在 vue3.x 中推荐使用 :deep() 替代 /deep/。</p></blockquote><h3 id="8-3-组件的-props"><a href="#8-3-组件的-props" class="headerlink" title="8.3 组件的 props"></a>8.3 组件的 props</h3><p>为了提高组件的复用性，在封装 vue 组件时需要遵守如下的原则：</p><ul><li>组件的 DOM 结构、Style 样式要尽量复用</li><li>组件中要展示的数据，尽量由组件的使用者提供</li></ul><p>为了方便使用者为组件提供要展示的数据，vue 组件提供了 props 的概念.</p><h4 id="8-3-1-什么是组件的-props"><a href="#8-3-1-什么是组件的-props" class="headerlink" title="8.3.1 什么是组件的 props"></a>8.3.1 什么是组件的 props</h4><p>props 是组件的自定义属性，组件的使用者可以通过 props 把数据传递到子组件内部，供子组件内部进行使 用。代码示例如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 通过自定义 props ，把文章的标题和作责，传递到 my-article 组件中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-article</span> <span class="attr">title</span>=<span class="string">&quot;面朝大海，春暖花开&quot;</span> <span class="attr">author</span>=<span class="string">&quot;海子&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-article</span>&gt;</span></span><br></pre></td></tr></table></figure><p>props 的作用：父组件通过 props 向子组件传递要展示的数据。</p><p>props 的好处：提高了组件的复用性。</p><h4 id="8-3-2-在组件中声明-props"><a href="#8-3-2-在组件中声明-props" class="headerlink" title="8.3.2 在组件中声明 props"></a>8.3.2 在组件中声明 props</h4><p>在封装 vue 组件时，可以把动态的数据项声明为 props 自定义属性。自定义属性可以在当前组件的模板结构 中被直接使用。示例代码如下</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- my-article 组件的定义如下 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>标题：&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>作者：&#123;&#123;author&#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: [<span class="string">&#x27;title&#x27;</span>, <span class="string">&#x27;author&#x27;</span>],     <span class="comment">// 父组件传递给 my-aricle 组件的数据，必须在 props 节点中声明</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-3-3-无法使用未声明的-props"><a href="#8-3-3-无法使用未声明的-props" class="headerlink" title="8.3.3 无法使用未声明的 props"></a>8.3.3 无法使用未声明的 props</h4><p>如果父组件给子组件传递了未声明的 props 属性，则这些属性会被忽略，无法被子组件使用，示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>标题：&#123;&#123;title&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span>&gt;</span>作者：&#123;&#123;author&#125;&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: [<span class="string">&#x27;title&#x27;</span>],     <span class="comment">// author 属性没有声明，因此子组件中无法访问到 author 的值</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-3-4-动态绑定-props-的值"><a href="#8-3-4-动态绑定-props-的值" class="headerlink" title="8.3.4 动态绑定 props 的值"></a>8.3.4 动态绑定 props 的值</h4><p>可以使用 v-bind 属性绑定的形式，为组件动态绑定 props 的值，示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">my-article</span> <span class="attr">:title</span>=<span class="string">&quot;info.title&quot;</span> <span class="attr">:author</span>=<span class="string">&quot;&#x27;post by&#x27; + info.author&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-article</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-3-5-props-的大小写命名"><a href="#8-3-5-props-的大小写命名" class="headerlink" title="8.3.5 props 的大小写命名"></a>8.3.5 props 的大小写命名</h4><p>组件中如果使用“camelCase (驼峰命名法)”声明了 props 属性的名称，则有两种方式为其绑定属性的值：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>发布时间：&#123;&#123;pubTime&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">props</span>: [<span class="string">&#x27;pubTime&#x27;</span>],   <span class="comment">// 采用驼峰命名法为当前的组件声明了 pubTime 属性</span></span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 既可以使用“驼峰命名法”的形式为组件绑定属性的值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-article</span> <span class="attr">pubTime</span>=<span class="string">&quot;1989&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-article</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 也可以使用“短横线分割命名”的形式为组件绑定属性的值 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">my-article</span> <span class="attr">pub-time</span>=<span class="string">&quot;1989&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-article</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-4-Class-与-Style-绑定"><a href="#8-4-Class-与-Style-绑定" class="headerlink" title="8.4 Class 与 Style 绑定"></a>8.4 Class 与 Style 绑定</h3><p>在实际开发中经常会遇到动态操作元素样式的需求。因此，vue 允许开发者通过 v-bind 属性绑定指令，为元 素动态绑定 class 属性的值和行内的 style 样式。</p><h4 id="8-4-1-动态绑定-HTML-的-class"><a href="#8-4-1-动态绑定-HTML-的-class" class="headerlink" title="8.4.1 动态绑定 HTML 的 class"></a>8.4.1 动态绑定 HTML 的 class</h4><p>可以通过三元表达式，动态的为元素绑定 class 的类名。示例代码如下：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;thin&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;isItalic ? &#x27;italic&#x27; : &#x27;&#x27;&quot;</span>&gt;</span>MyDeep 组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isItalic=!isItalic&quot;</span>&gt;</span>Toggle Italic<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123; <span class="attr">isItalic</span>: ture &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.thin</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-weight</span>: <span class="number">200</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.italic</span> &#123;</span></span><br><span class="line"><span class="language-css">        <span class="attribute">font-style</span>: italic;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-4-2-以数组语法绑定-HTML-的-class"><a href="#8-4-2-以数组语法绑定-HTML-的-class" class="headerlink" title="8.4.2 以数组语法绑定 HTML 的 class"></a>8.4.2 以数组语法绑定 HTML 的 class</h4><p>如果元素需要动态绑定多个 class 的类名，此时可以使用数组的语法格式：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">&quot;thin&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;[isItalic ? &#x27;italic&#x27; : &#x27;&#x27;, isDelete ? &#x27;delete&#x27; : &#x27;&#x27;]&quot;</span>&gt;</span></span><br><span class="line">    MyDeep 组件</span><br><span class="line"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isItalic=!isItalic&quot;</span>&gt;</span>Toggle Italic<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;isDelete=!isDelete&quot;</span>&gt;</span>Toggle Delete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">isItalic</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">isDelete</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-4-3-以对象语法绑定-HTML-的-class"><a href="#8-4-3-以对象语法绑定-HTML-的-class" class="headerlink" title="8.4.3 以对象语法绑定 HTML 的 class"></a>8.4.3 以对象语法绑定 HTML 的 class</h4><p>使用数组语法动态绑定 class 会导致模板结构臃肿的问题。此时可以使用对象语法进行简化：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">cliss</span>=<span class="string">&quot;thin&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;classObj&quot;</span>&gt;</span>MyDeep 组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;classObj.italic = !classObj.italic&quot;</span>&gt;</span>Toggle Italic<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;classObj.delete = !classObj.delete&quot;</span>&gt;</span>Toggle Delete<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">classObj</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="attr">italic</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">delete</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="8-4-4-以对象语法绑定内联的-style以对象语法绑定内联的-style"><a href="#8-4-4-以对象语法绑定内联的-style以对象语法绑定内联的-style" class="headerlink" title="8.4.4 以对象语法绑定内联的 style以对象语法绑定内联的 style"></a>8.4.4 以对象语法绑定内联的 style以对象语法绑定内联的 style</h4><p>:style 的对象语法十分直观——看着非常像 CSS，但其实是一个 JavaScript 对象。CSS property 名可以用驼 峰式 (camelCase) 或短横线分隔 (kebab-case，记得用引号括起来) 来命名：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">:style</span>=<span class="string">&quot;&#123;color: active, fontSize: fsize + &#x27;px&#x27;, &#x27;background-color: bgcolor&#x27;&#125;&quot;</span>&gt;</span></span><br><span class="line">黑马程序员    </span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;fsize += 1&quot;</span>&gt;</span>字号 +1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;fsize -= 1&quot;</span>&gt;</span>字号 -1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">data</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">active</span>: <span class="string">&#x27;red&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">fsize</span>: <span class="number">30</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">bgcolor</span>: <span class="string">&#x27;pink&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-5-组件封装案例"><a href="#8-5-组件封装案例" class="headerlink" title="8.5 组件封装案例"></a>8.5 组件封装案例</h3><ul><li>封装要求：</li></ul><ol><li>允许用户自定义 title 标题</li><li>允许用户自定义 bgcolor 背景色</li><li>允许用户自定义 color 文本颜色</li><li>MyHeader 组件需要在页面顶部进行 fixed 固定定位，且 z-index 等于 999</li></ol><ul><li>示例如下：</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-header title=&quot;黑马程序员&quot; bgcolor=&quot;#000&quot; color=&quot;#f8f8f8&quot;&gt;&lt;/my-header&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div class=&quot;header-container&quot; :style=&quot;&#123;backgroundColor: bgcolor, color: color&#125;&quot;&gt;</span><br><span class="line">        &#123;&#123;title || &#x27;Header组件&#x27;&#125;&#125;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;MyHeader&#x27;</span><br><span class="line">    props: [&#x27;title&#x27;,&#x27;bgcolor&#x27;,&#x27;color&#x27;]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">    .header-container &#123;</span><br><span class="line">        hight: 45px;</span><br><span class="line">        background-color: pink;</span><br><span class="line">        text-align: center;</span><br><span class="line">        line-height: 45px;</span><br><span class="line">        position: fixed;</span><br><span class="line">        top: 0;</span><br><span class="line">        left: 0;</span><br><span class="line">        widh: 100%;</span><br><span class="line">        z-index: 999;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h2 id="9-组件深入"><a href="#9-组件深入" class="headerlink" title="9 组件深入"></a>9 组件深入</h2><h3 id="9-1-props-验证"><a href="#9-1-props-验证" class="headerlink" title="9.1 props 验证"></a>9.1 props 验证</h3><h4 id="9-1-1-什么是-props-验证"><a href="#9-1-1-什么是-props-验证" class="headerlink" title="9.1.1 什么是 props 验证"></a>9.1.1 什么是 props 验证</h4><p>指的是：在封装组件时对外界传递过来的 props 数据进行合法性的校验，从而防止数据不合法的问题。</p><p>使用数据类型的 props 节点的缺点：无法为每个 prop 指定具体的数据类型。</p><p>对象类型的 props 节点提供了多种数据验证方案：</p><ul><li>基础的类型检查</li><li>多个可能的类型</li><li>必填项校验</li><li>属性默认值</li><li>自定义验证函数</li></ul><h4 id="9-1-2-对象类型的-props-节点"><a href="#9-1-2-对象类型的-props-节点" class="headerlink" title="9.1.2 对象类型的 props 节点"></a>9.1.2 对象类型的 props 节点</h4><p>使用对象类型的 props 节点，可以对每个 prop 进行数据类型的校验。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;div&gt;</span><br><span class="line">        &lt;p&gt;数量：&#123;&#123;count&#125;&#125;&lt;/p&gt;</span><br><span class="line">        &lt;p&gt;状态：&#123;&#123;state&#125;&#125;&lt;/p&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    name: &#x27;MyCount&#x27;,</span><br><span class="line">    props: &#123;</span><br><span class="line">        count: Number,</span><br><span class="line">        state: Boolean</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&#x27;less&#x27; scoped&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="9-1-3-基础的类型检查"><a href="#9-1-3-基础的类型检查" class="headerlink" title="9.1.3 基础的类型检查"></a>9.1.3 基础的类型检查</h4><p>可以直接为组件的 prop 属性指定基础的检验类型，从而防止组件的使用者为其绑定错误类型的书数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">export deafuet&#123;</span><br><span class="line">props: &#123;</span><br><span class="line">propA: String,</span><br><span class="line">propB: Number,</span><br><span class="line">propC: Boolean,</span><br><span class="line">propD: Array,</span><br><span class="line">propE: Object,</span><br><span class="line">propF: Date,</span><br><span class="line">propG: Function,</span><br><span class="line">propH: Symbol  // 符号类型</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-1-4-多个可能的类型"><a href="#9-1-4-多个可能的类型" class="headerlink" title="9.1.4 多个可能的类型"></a>9.1.4 多个可能的类型</h4><p>如果某个 prop 属性值的类型不唯一，此时可以通过数组的形式为其指定多个可能的类型。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">props: &#123;</span><br><span class="line">propA: [String, Number]</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-1-5-必填项校验"><a href="#9-1-5-必填项校验" class="headerlink" title="9.1.5 必填项校验"></a>9.1.5 必填项校验</h4><p>如果组件的某个 prop 属性是必填项，必须让组件的使用者为其传递属性的值，此时可以通过如下的方式将其设置为必填项。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">props: &#123;</span><br><span class="line">propB: &#123;</span><br><span class="line">type: String,</span><br><span class="line">required: true</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-1-6-属性默认值"><a href="#9-1-6-属性默认值" class="headerlink" title="9.1.6 属性默认值"></a>9.1.6 属性默认值</h4><p>在封装时，可以为某个 prop 属性指定默认值。</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">props: &#123;</span><br><span class="line">propC: &#123;</span><br><span class="line">type: Number,</span><br><span class="line">default: 100</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-1-7-自定义验证函数"><a href="#9-1-7-自定义验证函数" class="headerlink" title="9.1.7 自定义验证函数"></a>9.1.7 自定义验证函数</h4><p>在封装组件时，可以为 prop 属性指定自定义的验证函数，从而对 prop 属性的值进行更加精确的控制.</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">props: &#123;</span><br><span class="line">// 通过“配置对象”的形式，来定义 propD 属性的“验证规则”</span><br><span class="line">propD: &#123;</span><br><span class="line">// 通过 validator 函数，对 propD 属性的值进行校验，“属性的值”可以通过形参 value 进行接收</span><br><span class="line">validator(value) &#123;</span><br><span class="line">// propD 属性的值，必须匹配下列字符串中的一个</span><br><span class="line">// validator 函数的返回值为 true 表示验证通过，false 表示验证失败</span><br><span class="line">return [&#x27;success&#x27;, &#x27;warning&#x27;, &#x27;danger&#x27;].indexof(value) !==-1</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="9-2-计算属性"><a href="#9-2-计算属性" class="headerlink" title="9.2 计算属性"></a>9.2 计算属性</h3><h4 id="9-2-1-什么是计算属性"><a href="#9-2-1-什么是计算属性" class="headerlink" title="9.2.1 什么是计算属性"></a>9.2.1 什么是计算属性</h4><p>计算属性本质上就是一个 function 函数，它可以实时监听 data 中数据的变化，并 return 一个计算后的新值，供组件渲染 DOM 时使用。</p><h4 id="9-2-2-如何生命计算属性"><a href="#9-2-2-如何生命计算属性" class="headerlink" title="9.2.2 如何生命计算属性"></a>9.2.2 如何生命计算属性</h4><p>计算属性需要以 function 函数的形式声明到组件的 computed 选项中。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model.number=&quot;count&quot; /&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus&#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">data() &#123;</span><br><span class="line">return &#123;count: 1&#125;</span><br><span class="line">&#125;,</span><br><span class="line">computed: &#123;</span><br><span class="line">plus() &#123;</span><br><span class="line">return this.count * 2</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-2-3-计算属性的使用注意点"><a href="#9-2-3-计算属性的使用注意点" class="headerlink" title="9.2.3 计算属性的使用注意点"></a>9.2.3 计算属性的使用注意点</h4><ol><li>计算属性必须定义在 computed 节点中</li><li>计算属性必须是一个 function 函数</li><li>计算属性必须有返回值</li><li>计算属性必须当作普通属性使用</li></ol><h4 id="9-2-4-计算属性-vs-方法"><a href="#9-2-4-计算属性-vs-方法" class="headerlink" title="9.2.4 计算属性 vs 方法"></a>9.2.4 计算属性 vs 方法</h4><p>相对于方法来说，计算属性会缓存计算的结果，只有计算属性的依赖项发生变化时，才会重新进行运算。因此，计算属性的性能更好。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model.number=&quot;count&quot; /&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus()&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus()&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus()&#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">methods: &#123;</span><br><span class="line">plus() &#123;</span><br><span class="line">console.log(&#x27;方法被执行了&#x27;)</span><br><span class="line">return this.count * 2</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>控制台输出： 方法被执行了</p><p>​                        方法被执行了</p><p>​                        方法被执行了</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model.number=&quot;count&quot; /&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;count&#125;&#125; 乘以 2 的值为： &#123;&#123;plus&#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">computed: &#123;</span><br><span class="line">plus() &#123;</span><br><span class="line">console.log(&#x27;计算属性被执行了&#x27;)</span><br><span class="line">return this.count * 2</span><br><span class="line">&#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><blockquote><p>控制台输出：计算属性被执行了</p></blockquote><h4 id="9-2-5-计算属性案例"><a href="#9-2-5-计算属性案例" class="headerlink" title="9.2.5 计算属性案例"></a>9.2.5 计算属性案例</h4><ul><li>商品购物篮案例</li></ul><p>案例需求：</p><ol><li>已勾选的商品总数</li><li>已勾选的商品总价</li><li>结算按钮的禁用状态</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        ...</span><br><span class="line">        computed: &#123;</span><br><span class="line">        // 动态计算勾选水果的总数量</span><br><span class="line">total() &#123;</span><br><span class="line">                let t = 0</span><br><span class="line">                this.fruitlist.forEach(x =&gt; &#123;</span><br><span class="line">                    if (x.state) &#123;</span><br><span class="line">                        t += x.count</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                return t</span><br><span class="line">            &#125;,</span><br><span class="line">            // 动态计算勾选商品总价</span><br><span class="line">            amount() &#123;</span><br><span class="line">                let a = 0</span><br><span class="line">                this.fruitlisst.filter(x =&gt; x.state).forEach(x =&gt; &#123;</span><br><span class="line">                    a += x.price * x.count</span><br><span class="line">                &#125;)</span><br><span class="line">                return a</span><br><span class="line">            &#125;,</span><br><span class="line">            // 控制按钮的禁用状态</span><br><span class="line">            isDisabled() &#123;</span><br><span class="line">                return this.total === 0</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="9-3-自定义事件"><a href="#9-3-自定义事件" class="headerlink" title="9.3 自定义事件"></a>9.3 自定义事件</h3><h4 id="9-3-1-什么是自定义事件"><a href="#9-3-1-什么是自定义事件" class="headerlink" title="9.3.1 什么是自定义事件"></a>9.3.1 什么是自定义事件</h4><p>在封装组件时，为了让组件的使用者可以监听到组件内状态的变化，此时需要用到组件的自定义事件。</p><p><img src="https://cdn.staticaly.com/gh/Mango-Lun/images@main/img/202209081652782.png"></p><h4 id="9-3-2-自定义事件的-3-个使用步骤"><a href="#9-3-2-自定义事件的-3-个使用步骤" class="headerlink" title="9.3.2 自定义事件的 3 个使用步骤"></a>9.3.2 自定义事件的 3 个使用步骤</h4><p>在封装组件时：</p><ol><li>声明自定义事件</li><li>触发自定义事件</li></ol><p>在使用组件时：</p><ol start="3"><li>监听自定义事件</li></ol><h5 id="9-3-2-1-声明自定义事件"><a href="#9-3-2-1-声明自定义事件" class="headerlink" title="9.3.2.1 声明自定义事件"></a>9.3.2.1 声明自定义事件</h5><p>开发者为自定义组件封装的自定义事件，必须事先在 emits 节点中声明。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h3&gt;Counter组件&lt;/h3&gt;</span><br><span class="line">&lt;button&gt;+1&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    // my-counter 组件的自定义事件，必须实现声明到 emits 节点中</span><br><span class="line">    emits:[&#x27;change&#x27;]</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="9-3-2-2-触发自定义事件"><a href="#9-3-2-2-触发自定义事件" class="headerlink" title="9.3.2.2 触发自定义事件"></a>9.3.2.2 触发自定义事件</h5><p>在 emits 节点下声明的自定义事件，可以通过 this.$emit(‘自定义事件名称’)方法进行触发。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h3&gt;Counter组件&lt;/h3&gt;</span><br><span class="line">&lt;button&gt;+1&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    // my-counter 组件的自定义事件，必须实现声明到 emits 节点中</span><br><span class="line">    emits:[&#x27;change&#x27;],</span><br><span class="line">    methods: &#123;</span><br><span class="line">        onBtnClick() &#123;</span><br><span class="line">            this.$emit(&#x27;change&#x27;)</span><br><span class="line">            // 当点击 +1 按钮时，调用 this.$emit()方法，触发自定义事件</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="9-3-2-3-监听自定义事件"><a href="#9-3-2-3-监听自定义事件" class="headerlink" title="9.3.2.3 监听自定义事件"></a>9.3.2.3 监听自定义事件</h5><p>在使用自定义的组件时，可以通过 v-on 的形式监听自定义事件。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-counter @change=&quot;getCount&quot;&gt;&lt;/my-counter&gt;</span><br><span class="line"></span><br><span class="line">method: &#123;</span><br><span class="line">getCount() &#123;</span><br><span class="line">console.log(&#x27;监听到了 count 值的变化&#x27;)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-3-3-自定义事件传参"><a href="#9-3-3-自定义事件传参" class="headerlink" title="9.3.3 自定义事件传参"></a>9.3.3 自定义事件传参</h4><p>在调用 this.$emit() 方法触发自定义事件时，可以通过第二个参数为自定义事件传参。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h3&gt;Counter组件&lt;/h3&gt;</span><br><span class="line">&lt;button&gt;+1&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">    emits:[&#x27;change&#x27;],</span><br><span class="line">    methods: &#123;</span><br><span class="line">        onBtnClick() &#123;</span><br><span class="line">            this.$emit(&#x27;change&#x27;,this.count)</span><br><span class="line">            // 触发自定义事件时，通过第二个参数传参</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="9-4-组件上的-v-model"><a href="#9-4-组件上的-v-model" class="headerlink" title="9.4 组件上的 v-model"></a>9.4 组件上的 v-model</h3><h4 id="9-4-1-为什么需要在组件上使用-v-model"><a href="#9-4-1-为什么需要在组件上使用-v-model" class="headerlink" title="9.4.1 为什么需要在组件上使用 v-model"></a>9.4.1 为什么需要在组件上使用 v-model</h4><p>v-model 是双向数据绑定指令，当需要维护组件内外数据的同步时，可以在组件上使用 v-model 指令。</p><p><img src="https://cdn.staticaly.com/gh/Mango-Lun/images@main/img/202209081732528.png"></p><ul><li>外界数据的变化会自动同步到 counter 组件中</li><li>counter 组件中数据的变化，也会自动同步到外界</li></ul><h4 id="9-4-2-在组件上使用-v-model"><a href="#9-4-2-在组件上使用-v-model" class="headerlink" title="9.4.2 在组件上使用 v-model"></a>9.4.2 在组件上使用 v-model</h4><ul><li>父 -&gt; 子</li></ul><ol><li>父组件通过 v-bind： 属性绑定的形式，把数据传递给子组件</li><li>子组件中，通过 props 接收父组件传递过来的数据</li></ol><p><img src="https://cdn.staticaly.com/gh/Mango-Lun/images@main/img/202209081738145.png"></p><ul><li>子 -&gt; 父</li></ul><ol><li>在 v-bind：指令之前添加 v-model 指令</li><li>在子组件中声明 emits 自定事件，格式为 update：xxx</li><li>调用 $emit() 触发自定义事件，更新父组件的数据</li></ol><p><img src="https://cdn.staticaly.com/gh/Mango-Lun/images@main/img/202209081751315.png"></p><h3 id="9-5-案例"><a href="#9-5-案例" class="headerlink" title="9.5 案例"></a>9.5 案例</h3><h4 id="9-5-1-初始化项目"><a href="#9-5-1-初始化项目" class="headerlink" title="9.5.1 初始化项目"></a>9.5.1 初始化项目</h4><ol><li>在终端运行一下命令，初始化 vite 项目</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init vite-app todos</span><br></pre></td></tr></table></figure><ol start="2"><li>使用 vscode 打开项目，并安装依赖项</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><ol start="3"><li>安装 less 语法相关的依赖项</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i less -D</span><br></pre></td></tr></table></figure><h4 id="9-5-2-梳理项目结构"><a href="#9-5-2-梳理项目结构" class="headerlink" title="9.5.2 梳理项目结构"></a>9.5.2 梳理项目结构</h4><ol><li>重置 index.css 中的全局样式</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">12px</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">8px</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>重置 App.vue 组件的代码结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;App 根组件&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;MyApp&#x27;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        // 任务列表数组</span><br><span class="line">        todolist: [</span><br><span class="line">          &#123; id: 1, task: &#x27;周一早晨9点开会&#x27;, done: false&#125;,</span><br><span class="line">          &#123; id: 2, task: &#x27;周一晚上8点聚餐&#x27;, done: false&#125;,</span><br><span class="line">          &#123; id: 3, task: &#x27;准备周三上午的演讲稿&#x27;, done: true&#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>删除 components 目录下的 HelloWorld.vue 组件</li><li>在终端运行一下命令，把项目运行起来</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h4 id="9-5-3-封装-todo-list-组件"><a href="#9-5-3-封装-todo-list-组件" class="headerlink" title="9.5.3 封装 todo-list 组件"></a>9.5.3 封装 todo-list 组件</h4><h5 id="9-5-3-1-创建并注册-TodoList-组件"><a href="#9-5-3-1-创建并注册-TodoList-组件" class="headerlink" title="9.5.3.1 创建并注册 TodoList 组件"></a>9.5.3.1 创建并注册 TodoList 组件</h5><ol><li>在 <code>src/components/todo-list/</code>目录下新建<code>TodoList.vue</code>组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h3&gt;todolist 组件&lt;/h3&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;TodoList&#x27;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App.vue 组件中导入并注册 TodeList.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;App 根组件&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;todo-list&gt;&lt;/todo-list&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">// 导入 TodoList 组件</span><br><span class="line">import TodoList from &#x27;./components/todo-list/TodoList.vue&#x27;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;MyApp&#x27;,</span><br><span class="line">  data() &#123;</span><br><span class="line">    return &#123;</span><br><span class="line">      // 任务列表数组</span><br><span class="line">      todolist: [</span><br><span class="line">        &#123; id: 1, task: &#x27;周一早晨9点开会&#x27;, done: false &#125;,</span><br><span class="line">        &#123; id: 2, task: &#x27;周一晚上8点聚餐&#x27;, done: false &#125;,</span><br><span class="line">        &#123; id: 3, task: &#x27;准备周三上午的演讲稿&#x27;, done: true &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    TodoList,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App.vue 的 template 模板结构中使用注册的 TodoList 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;App 根组件&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;todo-list&gt;&lt;/todo-list&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-3-2-基于-bootstrap-渲染列表组件"><a href="#9-5-3-2-基于-bootstrap-渲染列表组件" class="headerlink" title="9.5.3.2 基于 bootstrap 渲染列表组件"></a>9.5.3.2 基于 bootstrap 渲染列表组件</h5><ol><li>将 bootstrap 文件拷贝到 <code>src/assets/</code> 静态资源目录中</li><li>在 main.js 入口文件中，导入 <code>src/assets/css/bootstrap.css</code>样式表</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/bootstrap.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure><ol start="3"><li>根据 bootstrap 提供的列表组和复选框渲染列表组件的基本效果</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ul class=&quot;list-group&quot;&gt;</span><br><span class="line">      &lt;!-- 列表组 --&gt;</span><br><span class="line">      &lt;li class=&quot;list-group-item d-flex justify-content-between align-items-center&quot;&gt;</span><br><span class="line">        &lt;!-- 复选框 --&gt;</span><br><span class="line">        &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; id=&quot;flexCheckDefault&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;form-check-label&quot; for=&quot;flexCheckDefault&quot;&gt;</span><br><span class="line">          Default checkbox</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">        &lt;!-- 徽标 --&gt;</span><br><span class="line">        &lt;span class=&quot;badge bg-success rounded-pill&quot;&gt;完成&lt;/span&gt;</span><br><span class="line">        &lt;span class=&quot;badge bg-warning rounded-pill&quot;&gt;未完成&lt;/span&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;TodoList&#x27;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-3-3-为-TodoList-声明-props-属性"><a href="#9-5-3-3-为-TodoList-声明-props-属性" class="headerlink" title="9.5.3.3 为 TodoList 声明 props 属性"></a>9.5.3.3 为 TodoList 声明 props 属性</h5><ol><li>为了接收外界传递过来的列表数据，需要在 TodoList 组件中声明如下的 props 属性</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;TodoList&#x27;,</span><br><span class="line">  props: &#123;</span><br><span class="line">    list: &#123;</span><br><span class="line">      type: Array,</span><br><span class="line">      required: true,</span><br><span class="line">      default: [],</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 组件中通过 list 属性，将数据传递到 TodoList 组件中</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;todo-list :list=&quot;todolist&quot;&gt;&lt;/todo-list&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-3-4-渲染列表的-DOM-结构"><a href="#9-5-3-4-渲染列表的-DOM-结构" class="headerlink" title="9.5.3.4 渲染列表的 DOM 结构"></a>9.5.3.4 渲染列表的 DOM 结构</h5><ol><li>通过 v-for 指令，循环渲染列表的 DOM 结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;ul class=&quot;list-group&quot;&gt;</span><br><span class="line">      &lt;!-- 列表组 --&gt;</span><br><span class="line">      &lt;li class=&quot;list-group-item d-flex justify-content-between align-items-center&quot; v-for=&quot;item in list&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;!-- 复选框 --&gt;</span><br><span class="line">        &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;form-check-label&quot; :for=&quot;item.id&quot;&gt;</span><br><span class="line">          &#123;&#123;item.task&#125;&#125;</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">        &lt;!-- 徽标 --&gt;</span><br><span class="line">        &lt;span class=&quot;badge bg-success rounded-pill&quot; v-if=&quot;item.done&quot;&gt;完成&lt;/span&gt;</span><br><span class="line">        &lt;span class=&quot;badge bg-warning rounded-pill&quot; v-else&gt;未完成&lt;/span&gt;</span><br><span class="line">      &lt;/li&gt;</span><br><span class="line">    &lt;/ul&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>通过 v-if 和 v-else 指令，按需渲染 bedge 效果</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class=&quot;badge bg-success rounded-pill&quot; v-if=&quot;item.done&quot;&gt;完成&lt;/span&gt;</span><br><span class="line">&lt;span class=&quot;badge bg-warning rounded-pill&quot; v-else&gt;未完成&lt;/span&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>通过 v-model 指令，双向绑定任务的完成情况</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;item.id&quot; v-model=&quot;item.done&quot;&gt;</span><br><span class="line">&lt;!-- 注意：App父组件通过 props 传递过来的 list 是引用类型的数据 --&gt;</span><br><span class="line">&lt;!-- 这里 v-model 双向绑定的结果是：用户的操作修改的是 App 组件中数据的状态 --&gt;</span><br></pre></td></tr></table></figure><ol start="4"><li>通过 v-bind 属性绑定，动态切换元素的 class 类名</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;label class=&quot;form-check-label&quot; :for=&quot;item.id&quot; :class=&quot;item.done ? &#x27;delete&#x27; : &#x27;&#x27;&quot;&gt;&#123;&#123;item.task&#125;&#125;&lt;/label&gt;</span><br></pre></td></tr></table></figure><p>​      在 TodoList 组件中声明如下样式，美化当前组件的 UI 结构</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.list-group</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.delete</span> &#123;</span><br><span class="line">  <span class="attribute">text-decoration</span>: line-through;</span><br><span class="line">  <span class="attribute">color</span>: gray;</span><br><span class="line">  <span class="attribute">font-style</span>: italic;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="9-5-4-封装-todo-input-组件"><a href="#9-5-4-封装-todo-input-组件" class="headerlink" title="9.5.4 封装 todo-input 组件"></a>9.5.4 封装 todo-input 组件</h4><h5 id="9-5-4-1-创建并注册-TodoInput-组件"><a href="#9-5-4-1-创建并注册-TodoInput-组件" class="headerlink" title="9.5.4.1 创建并注册 TodoInput 组件"></a>9.5.4.1 创建并注册 TodoInput 组件</h5><ol><li>在 <code>src/components/todo-list/</code> 目录下新建 TodoInput.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    TodoInput</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;TodoInput&#x27;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App.vue 组件中导入并注册 TodoInput.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">// 导入 TodoInput 组件</span><br><span class="line">import TodoInput from &#x27;./components/todo-input/TodoInput.vue&#x27;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">  name: &#x27;MyApp&#x27;,</span><br><span class="line">  components: &#123;</span><br><span class="line">    TodoList,</span><br><span class="line">    TodoInput</span><br><span class="line">&#125;,</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App.vue 的 template 模板结构中使用注册的 TodoInput 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;App 根组件&lt;/h1&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;todo-input&gt;&lt;/todo-input&gt;</span><br><span class="line">  &lt;todo-list :list=&quot;todolist&quot; class=&quot;mt-2&quot;&gt;&lt;/todo-list&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-4-2-基于-bootstrap-渲染组件结构"><a href="#9-5-4-2-基于-bootstrap-渲染组件结构" class="headerlink" title="9.5.4.2 基于 bootstrap 渲染组件结构"></a>9.5.4.2 基于 bootstrap 渲染组件结构</h5><ol><li>根据 bootstrap 提供的 inline-forms 渲染 TodoInput 组件的基本结构</li><li>在 TodoInput 组件中渲染如下的 DOM 结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- form 表单 --&gt;</span><br><span class="line">  &lt;form class=&quot;form-inline&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;input-group mb-2 mr-sm-2&quot;&gt;</span><br><span class="line">      &lt;!-- 输入框前缀 --&gt;</span><br><span class="line">      &lt;div class=&quot;input-group-prepend&quot;&gt;</span><br><span class="line">        &lt;span class=&quot;input-group-text&quot;&gt;任务&lt;/span&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">      &lt;!-- 文本输入框 --&gt;</span><br><span class="line">      &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;请填写任务信息&quot; style=&quot;width: 356px;&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;button type=&quot;submit&quot; class=&quot;btn btn-primary mb-2&quot;&gt;添加新任务&lt;/button&gt;</span><br><span class="line">  &lt;/form&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-4-3-通过自定义事件向外传递数据"><a href="#9-5-4-3-通过自定义事件向外传递数据" class="headerlink" title="9.5.4.3 通过自定义事件向外传递数据"></a>9.5.4.3 通过自定义事件向外传递数据</h5><blockquote><p>需求：</p><p>在 App 组件中，监听 TodoInput 组件的自定义事件，获取到要添加的任务名称，示例如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;todo-input @add=&quot;onAddNewTask&quot;&gt;&lt;/todo-input&gt;</span><br></pre></td></tr></table></figure></blockquote><ol><li>在 TodoInput 组件的 data 中声明如下的数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// 新任务名称</span></span><br><span class="line">        <span class="attr">taskname</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>为 input 输入框进行 v-model 的双向数据绑定</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;请填写任务信息&quot; style=&quot;width: 356px;&quot; v-model.trim=&quot;taskname&quot;&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>监听 form 表单的 submit 事件，阻止默认提交行为并指定事件处理函数</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;form class=&quot;form-inline&quot; @submit.prevent=&quot;onFormSubmit&quot;&gt;</span><br></pre></td></tr></table></figure><ol start="4"><li>在 methods 中声明 onFormSubmit 事件处理函数</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;TodoInput&#x27;,</span><br><span class="line">    data() &#123;</span><br><span class="line">      return &#123;</span><br><span class="line">        // 新任务名称</span><br><span class="line">        taskname: &#x27;&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      onFormSubmit() &#123;</span><br><span class="line">        if(!this.taskname) return alert(&#x27;任务名称不能为空！&#x27;)</span><br><span class="line">        // 触发自定义事件，并向外传递参数</span><br><span class="line">        this.$emit(&#x27;add&#x27;, this.taskname)</span><br><span class="line">        // 传递完成，清空文本框</span><br><span class="line">        this.taskname = &#x27;&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    emits: [&#x27;add&#x27;]</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-4-4-实现添加任务的功能"><a href="#9-5-4-4-实现添加任务的功能" class="headerlink" title="9.5.4.4 实现添加任务的功能"></a>9.5.4.4 实现添加任务的功能</h5><ol><li>在 App 组件中监听 TodoInput 组件自定义的 add 事件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;todo-input @add=&quot;onAddNewTask&quot;&gt;&lt;/todo-input&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 组件中的 data 中声明 nextId 来模拟自增 +1 的操作</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 任务列表数组</span></span><br><span class="line">      <span class="attr">todolist</span>: [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">task</span>: <span class="string">&#x27;周一早晨9点开会&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">task</span>: <span class="string">&#x27;周一晚上8点聚餐&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">task</span>: <span class="string">&#x27;准备周三上午的演讲稿&#x27;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">      <span class="comment">// 下一个可用的 Id</span></span><br><span class="line">      <span class="attr">nextId</span>: <span class="number">4</span>,</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件的 methods 中声明 onAddNewTask 事件处理函数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">    <span class="title function_">onAddNewTask</span>(<span class="params">x</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">todolist</span>.<span class="title function_">push</span>(&#123;</span><br><span class="line">        <span class="attr">id</span>: <span class="variable language_">this</span>.<span class="property">nextId</span>,</span><br><span class="line">        <span class="attr">task</span>: x,</span><br><span class="line">        <span class="attr">done</span>: <span class="literal">false</span>, <span class="comment">// 默认未完成</span></span><br><span class="line">      &#125;)</span><br><span class="line">      <span class="comment">// id 自增1</span></span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">nextId</span>++</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="9-5-5-封装-todo-button-组件"><a href="#9-5-5-封装-todo-button-组件" class="headerlink" title="9.5.5 封装 todo-button 组件"></a>9.5.5 封装 todo-button 组件</h4><h5 id="9-5-5-1-创建并注册-TodoButton-组件"><a href="#9-5-5-1-创建并注册-TodoButton-组件" class="headerlink" title="9.5.5.1 创建并注册 TodoButton 组件"></a>9.5.5.1 创建并注册 TodoButton 组件</h5><ol><li>在 <code>src/components/todo-button/</code> 目录下新建 TodoButton.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    xxx</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;TodoButton&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App.vue 组件中导入并注册 TodoButton.vue 组件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 TodoButton 组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">TodoButton</span> <span class="keyword">from</span> <span class="string">&#x27;./components/todo-button/TodoButton.vue&#x27;</span></span><br></pre></td></tr></table></figure><h5 id="9-5-5-2-基于-bootstrap-渲染组件结构"><a href="#9-5-5-2-基于-bootstrap-渲染组件结构" class="headerlink" title="9.5.5.2 基于 bootstrap 渲染组件结构"></a>9.5.5.2 基于 bootstrap 渲染组件结构</h5><ol><li>根据 bootstrap 提供的 Button group 渲染 TodoButton 组件的基本结构</li><li>在 TodoButton 组件中渲染如下 DOM 结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;mt-3 btn-container&quot;&gt;</span><br><span class="line">    &lt;div class=&quot;btn-group&quot; role=&quot;group&quot; aria-label=&quot;Basic example&quot;&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn btn-primary&quot;&gt;全部&lt;/button&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot;&gt;已完成&lt;/button&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn btn-secondary&quot;&gt;未完成&lt;/button&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>并通过 btn-container 类名美化组件样式</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"><span class="selector-class">.btn-container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h5 id="9-5-5-3-通过-props-指定默认激活的按钮"><a href="#9-5-5-3-通过-props-指定默认激活的按钮" class="headerlink" title="9.5.5.3 通过 props 指定默认激活的按钮"></a>9.5.5.3 通过 props 指定默认激活的按钮</h5><ol><li>在 TodoButton 组件中声明如下的 props，用来指定默认激活的按钮的索引</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">  <span class="attr">active</span>: &#123;</span><br><span class="line">    <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">    <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">  &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>通过动态绑定 class 类名的方式控制按钮的激活状态</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 0 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;&gt;全部&lt;/button&gt;</span><br><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 1 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;&gt;已完成&lt;/button&gt;</span><br><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 2 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;&gt;未完成&lt;/button&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件中声明默认激活项的索引，并通过属性绑定的方式传递给 TodoButton 组件</li></ol><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;todo-button :active=<span class="string">&quot;defaultActive&quot;</span>&gt;&lt;/todo-button&gt;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">      <span class="comment">// 任务列表数组</span></span><br><span class="line">      <span class="attr">todolist</span>: [</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">task</span>: <span class="string">&#x27;周一早晨9点开会&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">task</span>: <span class="string">&#x27;周一晚上8点聚餐&#x27;</span>, <span class="attr">done</span>: <span class="literal">false</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">task</span>: <span class="string">&#x27;准备周三上午的演讲稿&#x27;</span>, <span class="attr">done</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">      ],</span><br><span class="line">      <span class="comment">// 下一个可用的 Id</span></span><br><span class="line">      <span class="attr">nextId</span>: <span class="number">4</span>,</span><br><span class="line"></span><br><span class="line">      <span class="attr">defaultActive</span>: <span class="number">0</span></span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h5 id="9-5-5-4-通过-v-model-更新激活项的索引"><a href="#9-5-5-4-通过-v-model-更新激活项的索引" class="headerlink" title="9.5.5.4 通过 v-model 更新激活项的索引"></a>9.5.5.4 通过 v-model 更新激活项的索引</h5><blockquote><p>需求分析：</p><p>父 -&gt; 子 通过 props 传递了激活项的索引</p><p>子 -&gt; 父 需要更新父组件中激活项的索引</p><p>这种场景下适合在组件上使用 v-model 指令，维护组件内外数据的同步。</p></blockquote><ol><li>为 TodoButton 组件中的三个按钮分别别绑定 click 事件处理函数</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;btn-group&quot; role=&quot;group&quot; aria-label=&quot;Basic example&quot;&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 0 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;</span><br><span class="line">        @click=&quot;onBtnClick(0)&quot;&gt;全部&lt;/button&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 1 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;</span><br><span class="line">        @click=&quot;onBtnClick(1)&quot;&gt;已完成&lt;/button&gt;</span><br><span class="line">      &lt;button type=&quot;button&quot; class=&quot;btn&quot; :class=&quot;active === 2 ? &#x27;btn-primary&#x27; : &#x27;btn-secondary&#x27;&quot;</span><br><span class="line">        @click=&quot;onBtnClick(2)&quot;&gt;未完成&lt;/button&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 TodoButton 组件中声明如下的自定义事件，用来更新父组件通过 v-model 指令传递过来的 props 数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">emits</span>:[<span class="string">&#x27;update:active&#x27;</span>],</span><br></pre></td></tr></table></figure><ol start="3"><li>在 TodoButton 组件的 methods 节点中声明 onBtnClick 事件处理函数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>:&#123;</span><br><span class="line">   <span class="title function_">onBtnClick</span>(<span class="params">index</span>) &#123;</span><br><span class="line">   <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">active</span> === index) <span class="keyword">return</span></span><br><span class="line">   <span class="variable language_">this</span>.$emit(<span class="string">&#x27;update:active&#x27;</span>, index)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="9-5-5-5-通过计算属性动态切换列表的数据"><a href="#9-5-5-5-通过计算属性动态切换列表的数据" class="headerlink" title="9.5.5.5 通过计算属性动态切换列表的数据"></a>9.5.5.5 通过计算属性动态切换列表的数据</h5><blockquote><p>需求分析：</p><p>点击不同的按钮，切换显示不同的列表数据，此时可以根据当前激活按钮的索引，动态计算出要显示的列表数据并返回即可</p></blockquote><ol><li>在 App 跟组件中声明如下的计算属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">  <span class="title function_">tasklist</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">switch</span>(<span class="variable language_">this</span>.<span class="property">defaultActive</span>) &#123;</span><br><span class="line">      <span class="keyword">case</span> <span class="number">0</span>: <span class="comment">// 全部</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">todolist</span></span><br><span class="line">      <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// 已完成</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">todolist</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">done</span> === <span class="literal">true</span>)</span><br><span class="line">      <span class="keyword">case</span> <span class="number">2</span>: <span class="comment">// 未完成</span></span><br><span class="line">      <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">todolist</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">done</span> !== <span class="literal">true</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 根组件中 DOM 结构中，将 TodoList 组件的 <code>:list=&quot;todolist&quot;</code> 修改为</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;todo-list :list=&quot;tasklist&quot; class=&quot;mt-2&quot;&gt;&lt;/todo-list&gt;</span><br></pre></td></tr></table></figure><h2 id="10-组件高级"><a href="#10-组件高级" class="headerlink" title="10 组件高级"></a>10 组件高级</h2><h3 id="10-1-watch-侦听器"><a href="#10-1-watch-侦听器" class="headerlink" title="10.1 watch 侦听器"></a>10.1 watch 侦听器</h3><h4 id="10-1-1-什么是-watch-侦听器"><a href="#10-1-1-什么是-watch-侦听器" class="headerlink" title="10.1.1 什么是 watch 侦听器"></a>10.1.1 什么是 watch 侦听器</h4><p>watch 侦听器允许开发者监视数据的变化，从而针对数据的变化做特定的操作。例如，监视用户名的变化并发起请求，判断用户名是否可用。</p><h4 id="10-1-2-watch-侦听器的基本语法"><a href="#10-1-2-watch-侦听器的基本语法" class="headerlink" title="10.1.2 watch 侦听器的基本语法"></a>10.1.2 watch 侦听器的基本语法</h4><p>开发者需要在 watch 节点下，定义自己的侦听器。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">export default&#123;</span><br><span class="line">data() &#123;</span><br><span class="line">return &#123;</span><br><span class="line">            username:&#x27;&#x27;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    watch: &#123;</span><br><span class="line">        // 监听 username 的值的变化</span><br><span class="line">        // 形参列表中，第一个值是变化后的新值，第二个是变化前的旧值</span><br><span class="line">        username(newVal, oldVal) &#123;</span><br><span class="line">            console.log(newVal, oldVal)</span><br><span class="line">        &#125;，</span><br><span class="line">    &#125;，</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="10-1-3-使用-watch-检车用户名是否可用"><a href="#10-1-3-使用-watch-检车用户名是否可用" class="headerlink" title="10.1.3 使用 watch 检车用户名是否可用"></a>10.1.3 使用 watch 检车用户名是否可用</h4><p>监听 username 的值的变化，并使用 axios 发起 Ajax 请求，检测当前输入的用户名是否可用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">username</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">watch</span>: &#123;</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">username</span>(<span class="params"><span class="keyword">new</span>, old</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> &#123;<span class="attr">data</span>: res&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://www.escook.cn/api/finduser&#x27;</span> + <span class="keyword">new</span>)</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-1-4-immediate-选项"><a href="#10-1-4-immediate-选项" class="headerlink" title="10.1.4 immediate 选项"></a>10.1.4 immediate 选项</h4><p>默认情况下，组件在初次加载完毕后不会调用 watch 侦听器。如果想让 watch 侦听器立即被调用，则需要使用 immediate 选项。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">watch</span>: &#123;</span><br><span class="line"> <span class="attr">username</span>: &#123;</span><br><span class="line">     <span class="comment">// handler 属性是固定写法：当 username 变化是，调用 handler</span></span><br><span class="line">     <span class="keyword">async</span> <span class="title function_">handler</span>(<span class="params">newVal, oldVal</span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> &#123;<span class="attr">data</span>: res&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://www.escook.cn/api/finduser&#x27;</span> + newVal)</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">     &#125;,</span><br><span class="line">     <span class="attr">immediate</span>: <span class="literal">true</span></span><br><span class="line"> &#125;   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-1-5-deep-选项"><a href="#10-1-5-deep-选项" class="headerlink" title="10.1.5 deep 选项"></a>10.1.5 deep 选项</h4><p>当 watch 侦听的是一个对象，如果对象中的属性值发生了变化，则无法被监听到。此时需要使用 deep 选项。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">info</span>:&#123;</span><br><span class="line">            <span class="attr">username</span>: <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">match</span>: &#123;</span><br><span class="line">    <span class="attr">info</span>: &#123;</span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">handler</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> &#123;<span class="attr">data</span>: res&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://www.escook.cn/api/finduser&#x27;</span> + newVal.<span class="property">username</span>)</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">     &#125;,</span><br><span class="line">        <span class="attr">deep</span>: <span class="literal">true</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="10-1-6-监听对象中单个属性的变化"><a href="#10-1-6-监听对象中单个属性的变化" class="headerlink" title="10.1.6 监听对象中单个属性的变化"></a>10.1.6 监听对象中单个属性的变化</h4><p>如果只想监听对象中单个属性的变化，则可以按照如下的方式定义 watch 侦听器</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">info</span>:&#123;</span><br><span class="line">            <span class="attr">username</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">            <span class="attr">age</span>: <span class="number">20</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="attr">match</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;info.username&#x27;</span>: &#123; <span class="comment">// 只监听 info.username 属性值的变化</span></span><br><span class="line">        <span class="keyword">async</span> <span class="title function_">handler</span>(<span class="params">newVal</span>) &#123;</span><br><span class="line">         <span class="keyword">const</span> &#123;<span class="attr">data</span>: res&#125; = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">&#x27;https://www.escook.cn/api/finduser&#x27;</span> + newVal.<span class="property">username</span>)</span><br><span class="line">         <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">     &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="10-1-7-计算属性-vs-侦听器"><a href="#10-1-7-计算属性-vs-侦听器" class="headerlink" title="10.1.7 计算属性 vs 侦听器"></a>10.1.7 计算属性 vs 侦听器</h4><p>计算属性和侦听器侧重的应用场景不同：</p><p>计算属性侧重于监听多个值的变化，最终计算并返回一个值</p><p>侦听器侧重于监听单个数据的变化，最终执行特定的业务处理，不需要有任何返回值</p><h3 id="10-2-组件的生命周期"><a href="#10-2-组件的生命周期" class="headerlink" title="10.2 组件的生命周期"></a>10.2 组件的生命周期</h3><h4 id="10-2-1-组件运行的过程"><a href="#10-2-1-组件运行的过程" class="headerlink" title="10.2.1 组件运行的过程"></a>10.2.1 组件运行的过程</h4><p>组件从创建 -&gt; 运行（渲染）-&gt; 销毁的整个过程，强调的是一个时间段</p><h4 id="10-2-2-如何监听组件的不同过程"><a href="#10-2-2-如何监听组件的不同过程" class="headerlink" title="10.2.2 如何监听组件的不同过程"></a>10.2.2 如何监听组件的不同过程</h4><p>vue 框架为组件内置了不同时刻的生命周期函数，声明周期函数会伴随着组件的运行而自动调用。</p><ol><li>当组件在内存中被创建完毕之后，会自动调用 created 函数</li><li>当组件被成功的渲染到页面上之后，会自动调用 mounted 函数</li><li>当组件被销毁完毕之后，会自动调用 unmounted 函数</li></ol><h4 id="10-2-3-如何监听组件的更新"><a href="#10-2-3-如何监听组件的更新" class="headerlink" title="10.2.3 如何监听组件的更新"></a>10.2.3 如何监听组件的更新</h4><p>当组件的 data 数据更新后，vue 会自动重新渲染组件的 DOM 结构，从而保证 View 试图展示的数据和 Model 数据源保持一致。</p><p>当组件被重新渲染完毕之后，会自动调用 updated 声明周期函数。</p><h4 id="10-2-4-组件中主要的声明周期函数"><a href="#10-2-4-组件中主要的声明周期函数" class="headerlink" title="10.2.4 组件中主要的声明周期函数"></a>10.2.4 组件中主要的声明周期函数</h4><table><thead><tr><th align="center">生命周期函数</th><th align="center">执行时机</th><th align="center">所属阶段</th><th align="center">执行次数</th><th align="center">应用场景</th></tr></thead><tbody><tr><td align="center">created</td><td align="center">组件在内存中创建完毕之后</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">发 ajax 请求初始数据</td></tr><tr><td align="center">mounted</td><td align="center">组件初次在页面中渲染完毕之后</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">操作 DOM 元素</td></tr><tr><td align="center">updated</td><td align="center">组件在页面中被重新渲染完毕之后</td><td align="center">运行阶段</td><td align="center">0 或 多次</td><td align="center">-</td></tr><tr><td align="center">unmounted</td><td align="center">组件被销毁后（页面和内存）</td><td align="center">销毁阶段</td><td align="center">唯一1次</td><td align="center">-</td></tr></tbody></table><blockquote><p>注意：在实际开发中，created 是最常用的生命周期函数</p></blockquote><h4 id="10-2-5-组件中全部的声明周期函数"><a href="#10-2-5-组件中全部的声明周期函数" class="headerlink" title="10.2.5 组件中全部的声明周期函数"></a>10.2.5 组件中全部的声明周期函数</h4><table><thead><tr><th align="center">生命周期函数</th><th align="center">执行时机</th><th align="center">所属阶段</th><th align="center">执行次数</th><th align="center">应用场景</th></tr></thead><tbody><tr><td align="center">beforeCreate</td><td align="center">在内尺中开始创建组件之前</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">-</td></tr><tr><td align="center">created</td><td align="center">组件在内存中创建完毕之后</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">发 ajax 请求初始数据</td></tr><tr><td align="center">beforeMount</td><td align="center">组件初次渲染到页面之前</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">-</td></tr><tr><td align="center">mounted</td><td align="center">组件初次在页面中渲染完毕之后</td><td align="center">创建阶段</td><td align="center">唯一1次</td><td align="center">操作 DOM 元素</td></tr><tr><td align="center">beforeUpdat</td><td align="center">在组件被重新渲染之前</td><td align="center">运行阶段</td><td align="center">0 或 多次</td><td align="center">-</td></tr><tr><td align="center">updated</td><td align="center">组件在页面中被重新渲染完毕之后</td><td align="center">运行阶段</td><td align="center">0 或 多次</td><td align="center">-</td></tr><tr><td align="center">beforeUnmount</td><td align="center">在组件被销毁之前</td><td align="center">销毁阶段</td><td align="center">唯一1次</td><td align="center"></td></tr><tr><td align="center">unmounted</td><td align="center">组件被销毁后（页面和内存）</td><td align="center">销毁阶段</td><td align="center">唯一1次</td><td align="center">-</td></tr></tbody></table><blockquote><p>疑问：为什么不在 beforeCreate 中发 ajax 请求初始数据？</p><p>在发起 ajax 请求后，我们需要把请求获取到的数据挂在到我们的 data（） 节点中，而在 beforeCreate 阶段，我们无法访问到 data（） 节点，所以最早只能在 created 阶段发起 ajax 请求</p></blockquote><h3 id="10-3-组件之间的数据共享"><a href="#10-3-组件之间的数据共享" class="headerlink" title="10.3 组件之间的数据共享"></a>10.3 组件之间的数据共享</h3><h4 id="10-3-1-组件之间的关系"><a href="#10-3-1-组件之间的关系" class="headerlink" title="10.3.1 组件之间的关系"></a>10.3.1 组件之间的关系</h4><ol><li>父子关系</li><li>兄弟关系</li><li>后代关系</li></ol><h4 id="10-3-2-父子组件之间的数据共享"><a href="#10-3-2-父子组件之间的数据共享" class="headerlink" title="10.3.2 父子组件之间的数据共享"></a>10.3.2 父子组件之间的数据共享</h4><ol><li>父 -&gt; 子共享数据</li><li>子 -&gt; 父共享数据</li><li>父 &lt;-&gt; 子双向数据同步</li></ol><h5 id="10-3-2-1-父组件向子组件共享数据"><a href="#10-3-2-1-父组件向子组件共享数据" class="headerlink" title="10.3.2.1 父组件向子组件共享数据"></a>10.3.2.1 父组件向子组件共享数据</h5><p>父组件通过 v-bind 属性绑定向子组件共享数据。同时，子组件需要使用 props 接收数据。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">// 父组件</span><br><span class="line">&lt;my-test-1 :msg=&quot;message&quot; :user=&quot;userinfo&quot;&gt;&lt;/my-test-1&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    export default&#123;</span><br><span class="line">        name: &#x27;App&#x27;,</span><br><span class="line">        data() &#123;</span><br><span class="line">            return &#123;</span><br><span class="line">                message: &#x27;hello vue&#x27;,</span><br><span class="line">                userinfo: &#123;</span><br><span class="line">                    name: &#x27;zs&#x27;,</span><br><span class="line">                    age: 20</span><br><span class="line">                &#125;,</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 子组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h3&gt;测试父子传值&lt;/h3&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;p&gt;&#123;&#123;user&#125;&#125;&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        props: [&#x27;msg&#x27;, &#x27;user&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="10-3-2-2-子组件向父组件共享数据"><a href="#10-3-2-2-子组件向父组件共享数据" class="headerlink" title="10.3.2.2 子组件向父组件共享数据"></a>10.3.2.2 子组件向父组件共享数据</h5><p>子组件通过自定义事件的方式向父组件共享数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 子组件</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line"><span class="attr">emits</span>: [<span class="string">&#x27;n1change&#x27;</span>],</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">n1</span>: <span class="number">0</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">addN1</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">N1</span> ++</span><br><span class="line">            <span class="variable language_">this</span>.$emit(<span class="string">&#x27;n1change&#x27;</span>,<span class="variable language_">this</span>.<span class="property">N1</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// 父组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;my-test-1 @n1change=&quot;getn1&quot;&gt;&lt;/my-test-1&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">export default &#123;</span><br><span class="line">data() &#123; return &#123; n1FromSon: 0 &#125; &#125;,</span><br><span class="line">methods: &#123;</span><br><span class="line">getn1(n1) &#123;</span><br><span class="line">this.n1FromSon = n1</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-3-2-3-父子组件之间数据的双向同步"><a href="#10-3-2-3-父子组件之间数据的双向同步" class="headerlink" title="10.3.2.3 父子组件之间数据的双向同步"></a>10.3.2.3 父子组件之间数据的双向同步</h5><p>父组件在使用子组件期间，可以使用 v-model 指令维护组件内外数据的双向同步。</p><h4 id="10-3-3-兄弟组件之间的数据共享"><a href="#10-3-3-兄弟组件之间的数据共享" class="headerlink" title="10.3.3 兄弟组件之间的数据共享"></a>10.3.3 兄弟组件之间的数据共享</h4><p>兄弟组件之间实现数据共享的方案是 EventBus。可以借助第三方的包 mitt 来创建 eventBus 对象，从而实现兄弟组件之间的数据共享。</p><h5 id="10-3-3-1-安装-mitt-依赖包"><a href="#10-3-3-1-安装-mitt-依赖包" class="headerlink" title="10.3.3.1 安装 mitt 依赖包"></a>10.3.3.1 安装 mitt 依赖包</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mitt</span><br></pre></td></tr></table></figure><h5 id="10-3-3-2-创建公共的-EventBus-模块"><a href="#10-3-3-2-创建公共的-EventBus-模块" class="headerlink" title="10.3.3.2 创建公共的 EventBus 模块"></a>10.3.3.2 创建公共的 EventBus 模块</h5><p>在项目中创建公共的 eventBus 模块如下</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// evenBus.js</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 mitt 包</span></span><br><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&#x27;mitt&#x27;</span></span><br><span class="line"><span class="comment">// 创建 EventBus 的实例对象</span></span><br><span class="line"><span class="keyword">const</span> bus = <span class="title function_">mitt</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 EventBus 的示例对象共享出去</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> bus</span><br></pre></td></tr></table></figure><h5 id="10-3-3-3-在数据接收方自定义事件"><a href="#10-3-3-3-在数据接收方自定义事件" class="headerlink" title="10.3.3.3 在数据接收方自定义事件"></a>10.3.3.3 在数据接收方自定义事件</h5><p>在数据接收方，调用 bus.on(‘事件名称’，事件处理函数) 方法注册一个自定义事件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 eventBus.js 模块，得到共享的 bus 对象</span></span><br><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> &#123; <span class="attr">count</span>: <span class="number">0</span> &#125; &#125;,</span><br><span class="line">    <span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="comment">// 调用 bus.on() 方法注册一个自定义事件，通过事件处理函数的形参接收数据</span></span><br><span class="line">        bus.<span class="title function_">on</span>(<span class="string">&#x27;countChange&#x27;</span>, <span class="function">(<span class="params">count</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">count</span> = count</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-3-3-4-在数据发送方触发事件"><a href="#10-3-3-4-在数据发送方触发事件" class="headerlink" title="10.3.3.4 在数据发送方触发事件"></a>10.3.3.4 在数据发送方触发事件</h5><p>在数据发送方调用，bus.emit(‘事件名称’，要发送的数据) 方法触发自定义事件。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 导入 eventBus.js 模块，得到共享的 bus 对象</span></span><br><span class="line"><span class="keyword">import</span> bus <span class="keyword">from</span> <span class="string">&#x27;./eventBus.js&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123; <span class="keyword">return</span> &#123; <span class="attr">count</span>:<span class="number">0</span> &#125; &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">addCount</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">count</span>++</span><br><span class="line">            bus.<span class="title function_">emit</span>(<span class="string">&#x27;countChange&#x27;</span>, <span class="variable language_">this</span>.<span class="property">count</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-3-4-后带关系组件之间的数据共享"><a href="#10-3-4-后带关系组件之间的数据共享" class="headerlink" title="10.3.4 后带关系组件之间的数据共享"></a>10.3.4 后带关系组件之间的数据共享</h4><p>后代关系组件之间的数据共享，指的是父节点的组件向其子孙组件共享数据。此时组件之间的嵌套关系比较复杂，可以使用 provide 和 inject 实现后代关系组件之间的数据共享。</p><h5 id="10-3-4-1-父节点通过-provide-共享数据"><a href="#10-3-4-1-父节点通过-provide-共享数据" class="headerlink" title="10.3.4.1 父节点通过 provide 共享数据"></a>10.3.4.1 父节点通过 provide 共享数据</h5><p>父节点的组件可以通过 provide 方法，对其子孙组件共享数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span>&#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="string">&#x27;rea&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">provide</span>(<span class="params"></span>) &#123;</span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">color</span>: <span class="variable language_">this</span>.<span class="property">color</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-3-4-2-子孙节点通过-inject-接收数据"><a href="#10-3-4-2-子孙节点通过-inject-接收数据" class="headerlink" title="10.3.4.2 子孙节点通过 inject 接收数据"></a>10.3.4.2 子孙节点通过 inject 接收数据</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h5&gt;子孙组件 -- &#123;&#123; color &#125;&#125;&lt;/h5&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        inject: [&#x27;color&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h5 id="10-3-4-3-父节点对外共享响应式的数据"><a href="#10-3-4-3-父节点对外共享响应式的数据" class="headerlink" title="10.3.4.3 父节点对外共享响应式的数据"></a>10.3.4.3 父节点对外共享响应式的数据</h5><p>父节点使用 provide 向下共享数据时，可以结合 computed 函数向下共享响应式的数据。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;computed&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span> <span class="comment">// 1. 从 vue 中按需导入 computed 函数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;<span class="keyword">return</span> &#123;<span class="attr">color</span>: <span class="string">&#x27;red&#x27;</span>&#125;&#125;,</span><br><span class="line">    <span class="title function_">provide</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="comment">// 2.使用 computed 函数，可以把需要共享的数据“封装为”响应式数据</span></span><br><span class="line">            <span class="attr">color</span>: <span class="title function_">computed</span>( <span class="function">() =&gt;</span> <span class="variable language_">this</span>.<span class="property">color</span> )</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-3-4-4-子孙节点使用响应式的数据"><a href="#10-3-4-4-子孙节点使用响应式的数据" class="headerlink" title="10.3.4.4 子孙节点使用响应式的数据"></a>10.3.4.4 子孙节点使用响应式的数据</h5><p>如果如节点共享的是响应式的数据，则子孙节点必须以 .value 的形式进行使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h5&gt;子孙组件 -- &#123;&#123; color.value &#125;&#125;&lt;/h5&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        inject: [&#x27;color&#x27;]</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="10-3-5-vuex"><a href="#10-3-5-vuex" class="headerlink" title="10.3.5 vuex"></a>10.3.5 vuex</h4><p>vuex 是终极的组件之间的数据共享方案。在企业级的 vue 项目中，vuex 可以让组件之间的数据共享变得高效、清晰、且易于维护。</p><h3 id="10-4-vue-3-x-中全局配置-axios"><a href="#10-4-vue-3-x-中全局配置-axios" class="headerlink" title="10.4 vue 3.x 中全局配置 axios"></a>10.4 vue 3.x 中全局配置 axios</h3><h4 id="10-4-1-为什么要全局配置-axios"><a href="#10-4-1-为什么要全局配置-axios" class="headerlink" title="10.4.1 为什么要全局配置 axios"></a>10.4.1 为什么要全局配置 axios</h4><p>在实际开发中，几乎每个组件都会用到 axios 发起数据请求。此时会遇到如下两个问题：</p><ol><li>每个组件中都需要导入 axios （代码臃肿）</li><li>每次发请求都需要填写完整的请求路径（不利于后期维护）</li></ol><h4 id="10-4-2-如何全局配置-axios"><a href="#10-4-2-如何全局配置-axios" class="headerlink" title="10.4.2 如何全局配置 axios"></a>10.4.2 如何全局配置 axios</h4><p>在 main.js 入口文件中，通过 app.config.globalProperties 全局挂载 axios ，示例代码如下：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为 axios 配置请求的根路径</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://api.com&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 将 axios 挂载为 app 的全局子当以属性之后，每个组件可以通过 this 直接访问到全局挂载的自定义属性</span></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure><blockquote><p>$http 可以是任意编写</p></blockquote><p><code>this.$http.get(&#39;/user&#39;)</code></p><h3 id="10-5-购物车案例"><a href="#10-5-购物车案例" class="headerlink" title="10.5 购物车案例"></a>10.5 购物车案例</h3><h4 id="10-5-1-实现步骤"><a href="#10-5-1-实现步骤" class="headerlink" title="10.5.1 实现步骤"></a>10.5.1 实现步骤</h4><ol><li>初始化项目基本结构</li><li>封装 EsHeader 组件</li><li>基于 axios 请求商品列表数据</li><li>封装 EsFooter 组件</li><li>封装 EsGoods 组件</li><li>封装 EsCounter 组件</li></ol><h4 id="10-5-2-初始化项目结构"><a href="#10-5-2-初始化项目结构" class="headerlink" title="10.5.2 初始化项目结构"></a>10.5.2 初始化项目结构</h4><ol><li>运行如下的命令，初始化 vite 项目</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm init vite-app code-cart</span><br><span class="line"><span class="built_in">cd</span> code-cart</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><ol start="2"><li>清空项目结构：</li></ol><ul><li>把 bootstrap 相关文件放入 src/assets 目录下</li><li>在 main.js 中导入 bootstrap.css</li><li>清空 App.vue 组件</li><li>删除 components 目录下的 HelloWorld.vue 组件</li></ul><ol start="3"><li>为组件的样式启用 less 语法</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i less -D</span><br></pre></td></tr></table></figure><ol start="4"><li>初始化 index.css 全局样式</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-5-3-封装-es-header-组件"><a href="#10-5-3-封装-es-header-组件" class="headerlink" title="10.5.3 封装 es-header 组件"></a>10.5.3 封装 es-header 组件</h4><h5 id="10-5-3-1-创建并注册-EsHeader-组件"><a href="#10-5-3-1-创建并注册-EsHeader-组件" class="headerlink" title="10.5.3.1 创建并注册 EsHeader 组件"></a>10.5.3.1 创建并注册 EsHeader 组件</h5><ol><li>在 <code>src/components/es-header/</code>目录下新建 EsHeader.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    esheader</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;EsHeader&#x27;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App.vue 组件中导入并注册 EsHeader.vue 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  import EsHeader from &#x27;./components/es-header/EsHeader.vue&#x27;</span><br><span class="line"></span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;MyApp&#x27;,</span><br><span class="line">    components: &#123;</span><br><span class="line">      EsHeader</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App.vue 的 template 模板结构中使用 EsHeader 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-header&gt;&lt;/es-header&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-3-2-封装-es-header-组件"><a href="#10-5-3-2-封装-es-header-组件" class="headerlink" title="10.5.3.2 封装 es-header 组件"></a>10.5.3.2 封装 es-header 组件</h5><ol start="0"><li>封装需求：</li></ol><ul><li>允许用户自定义 title 标题内容</li><li>允许用户自定义 color 文字颜色</li><li>允许用户自定义 bgcolor 背景颜色</li><li>允许用户自定义 fsize 字体大小</li><li>es-header 组件中必须固定定位到页面顶部的位置，高二为 45px ，文本居中，z-index 为 999.</li></ul><ol><li>在 es-header 组件中封装以下的 props 属性：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">title</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;es-header&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">bgcolor</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;#007BFF&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">color</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&#x27;#ffffff&#x27;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">fsize</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="number">12</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>渲染标题内容，并动态为 DOM 元素绑定行内的 style 样式对象</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;header-container&quot; :style=&quot;&#123; backgroundColor: bgcolor, color: color, fontSize: fsize + &#x27;px&#x27; &#125;&quot;&gt; &#123;&#123;title&#125;&#125;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件中传递 title 属性值，并添加样式</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;app-container&quot;&gt;</span><br><span class="line">    &lt;h1&gt;App&lt;/h1&gt;</span><br><span class="line">    &lt;hr&gt;</span><br><span class="line">    &lt;es-header title=&quot;购物车案例&quot;&gt;&lt;/es-header&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">.app-container &#123;</span><br><span class="line">  padding-top: 45px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h4 id="10-5-4-基于-axios-请求商品列表数据"><a href="#10-5-4-基于-axios-请求商品列表数据" class="headerlink" title="10.5.4 基于 axios 请求商品列表数据"></a>10.5.4 基于 axios 请求商品列表数据</h4><h5 id="10-5-4-1-全局配置-axios"><a href="#10-5-4-1-全局配置-axios" class="headerlink" title="10.5.4.1 全局配置 axios"></a>10.5.4.1 全局配置 axios</h5><ol><li>运行如下命令安装 axios</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios -S</span><br></pre></td></tr></table></figure><ol start="2"><li>在 main.js 入口文件中导入并全局配置 axios</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/bootstrap.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h5 id="10-5-4-2-请求商品列表数据"><a href="#10-5-4-2-请求商品列表数据" class="headerlink" title="10.5.4.2 请求商品列表数据"></a>10.5.4.2 请求商品列表数据</h5><ol><li>在 App 组件中声明如下的 data 数据</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="comment">// 商品列表数据</span></span><br><span class="line">        <span class="attr">goodslist</span>: []</span><br><span class="line">      &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 组件的 created 声明周期函数中，预调用 获取商品列表数据的 methods 方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getGoodsList</span>()</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件的 methods 节点中，声明刚刚预调用的 getGoodList 方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="comment">// 获取商品列表</span></span><br><span class="line">      <span class="keyword">async</span> <span class="title function_">getGoodsList</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;<span class="attr">data</span>: res&#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">get</span>(<span class="string">&#x27;/api/cart&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span>(res.<span class="property">status</span> !== <span class="number">200</span>) <span class="keyword">return</span> <span class="title function_">alert</span>(<span class="string">&#x27;数据请求失败&#x27;</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">goodslist</span> = res.<span class="property">list</span>;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h4 id="10-5-5-封装-es-footer-组件"><a href="#10-5-5-封装-es-footer-组件" class="headerlink" title="10.5.5 封装 es-footer 组件"></a>10.5.5 封装 es-footer 组件</h4><h5 id="10-5-5-1-创建并注册-EsFooter-组件"><a href="#10-5-5-1-创建并注册-EsFooter-组件" class="headerlink" title="10.5.5.1 创建并注册 EsFooter 组件"></a>10.5.5.1 创建并注册 EsFooter 组件</h5><ol><li><p>在 <code>src/components/es-footer</code>目录下新建 EsFooter.vue 组件</p></li><li><p>在 App 组件中导入并注册 EsFooter.vue 组件</p></li><li><p>在 App 的template 模板结构中使用 EsFooter 组件</p></li></ol><h5 id="10-5-5-2-封装-es-footer-组件"><a href="#10-5-5-2-封装-es-footer-组件" class="headerlink" title="10.5.5.2 封装 es-footer 组件"></a>10.5.5.2 封装 es-footer 组件</h5><ol start="0"><li>封装需求</li></ol><ul><li>es-footer 组件必须固定定位到页面底部的位置，高度为 50px，内容两端贴边对齐，z-index 为 999</li><li>允许用户自定义 amout 总价格，并在渲染时保留两位小数</li><li>允许用户自定义 total 总数量，并渲染到结算按钮中，如果要结算的商品数量为 0 ，则禁用结算按钮</li><li>允许用户自定义 infull 全选按钮的选中状态</li><li>允许用户通过自定义事件的形式，监听全选按钮选中状态的变化，并获取到最新的选中状态</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-footer :isfull=&quot;flase&quot; :total=&quot;1&quot; :amount=&quot;98&quot; @fullChange=&quot;onFullStateChange&quot;&gt;&lt;/my-footer&gt;</span><br></pre></td></tr></table></figure><ol><li>将 EsFooter.vue 组件在页面底部进行固定定位</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">.footer-container &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border-top: 1px solid #efefef;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  padding: 0 10px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>根据 bootstrap 提供的 Checkboxs 渲染左侧的全选按钮</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;footer-container&quot;&gt;</span><br><span class="line">    &lt;!-- 全选区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">      &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; id=&quot;fullCheck&quot;&gt;</span><br><span class="line">      &lt;label class=&quot;form-check-label&quot; for=&quot;fullCheck&quot;&gt;</span><br><span class="line">        全选</span><br><span class="line">      &lt;/label&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 合计区域 --&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;span&gt;合计：&lt;/span&gt;</span><br><span class="line">      &lt;span class=&quot;amount&quot;&gt;￥0.00&lt;/span&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 结算按钮 --&gt;</span><br><span class="line">    &lt;button type=&quot;button&quot; class=&quot;btn btn-primary btn-settle&quot;&gt;结算(0)&lt;/button&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  export default &#123;</span><br><span class="line">    name: &#x27;EsFooter&#x27;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style lang=&quot;less&quot; scoped&gt;</span><br><span class="line">.footer-container &#123;</span><br><span class="line">  position: fixed;</span><br><span class="line">  bottom: 0;</span><br><span class="line">  left: 0;</span><br><span class="line">  width: 100%;</span><br><span class="line">  height: 50px;</span><br><span class="line">  background-color: #fff;</span><br><span class="line">  border-top: 1px solid #efefef;</span><br><span class="line">  display: flex;</span><br><span class="line">  justify-content: space-between;</span><br><span class="line">  align-items: center;</span><br><span class="line">  padding: 0 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.amount &#123;</span><br><span class="line">  font-weight: bold;</span><br><span class="line">  color: red</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.btn-settle &#123;</span><br><span class="line">  min-width: 90px;</span><br><span class="line">  height: 38px;</span><br><span class="line">  border-radius: 19px;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-5-3-封装自定义属性-amount"><a href="#10-5-5-3-封装自定义属性-amount" class="headerlink" title="10.5.5.3 封装自定义属性 amount"></a>10.5.5.3 封装自定义属性 amount</h5><blockquote><p>amount 是已勾选商品的总价</p></blockquote><ol><li>在 EsFooter 组件的 props 节点中声明如下自定义属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">amount</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>在 EsFooter 组件的 DOM 结构中渲染 amount 的值</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class=&quot;amount&quot;&gt;￥&#123;&#123;amount.toFixed(2)&#125;&#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure><blockquote><p>toFixed(2) 保留两位小数</p></blockquote><h5 id="10-5-5-4-封装自定义属性-total"><a href="#10-5-5-4-封装自定义属性-total" class="headerlink" title="10.5.5.4 封装自定义属性 total"></a>10.5.5.4 封装自定义属性 total</h5><blockquote><p>total 是已勾选商品的总数量</p></blockquote><ol><li>在 EsFooter 组件的 props 节点中声明如下的自定义属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">total</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="number">0</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li><p>在 EsFooter 组件的 DOM 结构中渲染 total 的值</p></li><li><p>动态控制结算按钮的禁用状态</p></li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn btn-primary btn-settle&quot; :disabled=&quot;total === 0&quot;&gt;结算(&#123;&#123;total&#125;&#125;)&lt;/button&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-5-5-封装自定义属性-isfull"><a href="#10-5-5-5-封装自定义属性-isfull" class="headerlink" title="10.5.5.5 封装自定义属性 isfull"></a>10.5.5.5 封装自定义属性 isfull</h5><blockquote><p>isfull 是全选按钮的选中状态，true 表示选中，false 表示未选中</p></blockquote><ol><li>在 EsFooter 组件的 props 节点中声明如下的自定义属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">isfull</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">        <span class="attr">default</span>: <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>为复选框动态绑定 checked 属性的值</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; id=&quot;fullCheck&quot; :checked=&quot;isfull&quot;&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-5-6-封装自定义事件-fullChange"><a href="#10-5-5-6-封装自定义事件-fullChange" class="headerlink" title="10.5.5.6 封装自定义事件 fullChange"></a>10.5.5.6 封装自定义事件 fullChange</h5><blockquote><p>通过自定义事件 fullChange，把最新的选中状态传递给组件的使用者</p></blockquote><ol><li>监听复选框选中状态变化的 change 事件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; id=&quot;fullCheck&quot; :checked=&quot;isfull&quot; @change=&quot;onCheckBoxChange&quot;&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 methods 中声明 onCheckBoxChange，并通过事件对象 e 获取到最新的选中状态</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="comment">// 监听 checkbox 选中状态变化的事件</span></span><br><span class="line">      <span class="title function_">onCheckBoxChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(e.target.checked)</span></span><br><span class="line">        <span class="variable language_">this</span>.$emit(<span class="string">&#x27;fullChange&#x27;</span>, e.<span class="property">target</span>.<span class="property">checked</span>)</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 emits 中声明自定义事件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">emits</span>: [<span class="string">&#x27;fullChange&#x27;</span>],</span><br></pre></td></tr></table></figure><ol start="4"><li>在 onCheckBoxChange 事件处理函数中，通过 $emit() 触发自定义事件，把最新的选中状态传递给当前组件的使用者</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="comment">// 监听 checkbox 选中状态变化的事件</span></span><br><span class="line">      <span class="title function_">onCheckBoxChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(e.target.checked)</span></span><br><span class="line">        <span class="variable language_">this</span>.$emit(<span class="string">&#x27;fullChange&#x27;</span>, e.<span class="property">target</span>.<span class="property">checked</span>)</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>在 App 组件中测试 EsFooter 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-footer @fullChange=&quot;onFullStateChange&quot;&gt;&lt;/es-footer&gt;</span><br></pre></td></tr></table></figure><p>​    并在 methods 中声明 onFullStateChange 处理函数，通过形参获取到全选按钮最新的选中状态</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 监听选中状态变化的事件</span></span><br><span class="line">      <span class="title function_">onFullStateChange</span>(<span class="params">isFull</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(isFull);</span><br><span class="line">      &#125;</span><br></pre></td></tr></table></figure><h4 id="10-5-6-封装-es-goods-组件"><a href="#10-5-6-封装-es-goods-组件" class="headerlink" title="10.5.6 封装 es-goods 组件"></a>10.5.6 封装 es-goods 组件</h4><h5 id="10-5-6-1-创建并注册-EsGood-组件"><a href="#10-5-6-1-创建并注册-EsGood-组件" class="headerlink" title="10.5.6.1 创建并注册 EsGood 组件"></a>10.5.6.1 创建并注册 EsGood 组件</h5><p>…</p><h5 id="10-5-6-2-封装-es-goods-组件"><a href="#10-5-6-2-封装-es-goods-组件" class="headerlink" title="10.5.6.2 封装 es-goods 组件"></a>10.5.6.2 封装 es-goods 组件</h5><ol start="0"><li>封装需求</li></ol><ul><li>实现 EsGoods 组件的基础布局</li><li>封装组件的 6 个自定义属性（id、thumb、title、price、count、checked）</li><li>封装组件的自定义事件 stateChange，允许外界监听组件选中状态的变化</li></ul><ol><li>渲染 EsGoods 组件的基础结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;goods-container&quot;&gt;</span><br><span class="line">    &lt;!-- 左侧图片区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;left&quot;&gt;</span><br><span class="line">      &lt;img src=&quot;&quot; alt=&quot;商品图片&quot; class=&quot;thumb&quot;&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 右侧信息区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">      &lt;!-- 商品名称 --&gt;</span><br><span class="line">      &lt;div class=&quot;top&quot;&gt;xxxx&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;bottom&quot;&gt;</span><br><span class="line">        &lt;!-- 商品价格 --&gt;</span><br><span class="line">        &lt;div class=&quot;price&quot;&gt;￥0.00&lt;/div&gt;</span><br><span class="line">        &lt;!-- 商品数量 --&gt;</span><br><span class="line">        &lt;div class=&quot;count&quot;&gt;数量&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>美化组件样式</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.goods-container</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 左侧图片</span></span><br><span class="line">  <span class="selector-class">.left</span> &#123;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 商品图片</span></span><br><span class="line">    <span class="selector-class">.thumb</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: block;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100px</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="number">#efefef</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 右侧商品信息</span></span><br><span class="line">  <span class="selector-class">.right</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">    <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.top</span> &#123;</span><br><span class="line">      <span class="attribute">font-weight</span>: bold;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.bottom</span> &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.price</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: red;</span><br><span class="line">        <span class="attribute">font-weight</span>: bold;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在商品缩略图之外包裹复选框效果</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;left&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">        &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; id=&quot;flexCheckDefault&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;form-check-label&quot; for=&quot;flexCheckDefault&quot;&gt;</span><br><span class="line">          &lt;img src=&quot;&quot; alt=&quot;商品图片&quot; class=&quot;thumb&quot;&gt;</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br></pre></td></tr></table></figure><ol start="4"><li>实现商品与复选框居中</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.form-check-input</span> &#123;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">3.4rem</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>在 App 组件中循环渲染 EsGoods 组件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-goods v-for=&quot;item in goodslist&quot; :key=&quot;item.id&quot;&gt;&lt;/es-goods&gt;</span><br></pre></td></tr></table></figure><ol start="6"><li>为 EsGoods 添加顶边框</li></ol><figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.goods-container</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">    <span class="comment">// 最终生成的选择器为 .goods-container + .goods-container</span></span><br><span class="line">    <span class="comment">// 在 css 中， + 是 ‘相邻兄弟选择器’，表示：选择紧连着另一个元素后的元素，二者具有相同的父元素</span></span><br><span class="line">    + <span class="selector-class">.goods-container</span> &#123;</span><br><span class="line">        <span class="attribute">border-top</span>: <span class="number">1px</span> solid <span class="number">#efefef</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ....省略其他样式</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-5-6-3-封装自定义属性-id"><a href="#10-5-6-3-封装自定义属性-id" class="headerlink" title="10.5.6.3 封装自定义属性 id"></a>10.5.6.3 封装自定义属性 id</h5><blockquote><p>id 是每个商品的唯一标识符</p></blockquote><ol><li>在 EsGoods 组件的 props 节点中声明如下的自定义属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">id</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: [<span class="title class_">Number</span>, <span class="title class_">String</span>],</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在渲染复选框时动态绑定 input 的 id 属性和 label 的 for 属性值</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;id&quot;&gt;</span><br><span class="line">&lt;label class=&quot;form-check-label&quot; :for=&quot;id&quot;&gt;</span><br><span class="line">    &lt;img src=&quot;&quot; alt=&quot;商品图片&quot; class=&quot;thumb&quot;&gt;</span><br><span class="line">&lt;/label&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 中使用 EsGoods 组件时，动态绑定 id 属性的值</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-goods v-for=&quot;item in goodslist&quot; :key=&quot;item.id&quot; :id=&quot;item.id&quot;&gt;&lt;/es-goods&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-6-4-封装其它属性"><a href="#10-5-6-4-封装其它属性" class="headerlink" title="10.5.6.4 封装其它属性"></a>10.5.6.4 封装其它属性</h5><blockquote><p>除了 id 属性之外，EsGoods 组件还要封装：</p><p>缩略图 thumb，商品名称 title，单价 price，数量 count，勾选状态 checked 这五个属性</p></blockquote><ol><li>在 EsGoods 组件的 props节点中，声明如下的自定义属性：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">thumb</span>: &#123;</span><br><span class="line">       <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">       <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">&#125;,</span><br><span class="line">   <span class="attr">title</span>: &#123;</span><br><span class="line">       <span class="attr">type</span>: <span class="title class_">String</span>,</span><br><span class="line">       <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">price</span>: &#123;</span><br><span class="line">       <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">       <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">count</span>: &#123;</span><br><span class="line">       <span class="attr">type</span>: <span class="title class_">Number</span>,</span><br><span class="line">       <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">   &#125;,</span><br><span class="line">   <span class="attr">checked</span>: &#123;</span><br><span class="line">       <span class="attr">type</span>: <span class="title class_">Boolean</span>,</span><br><span class="line">       <span class="attr">required</span>: <span class="literal">true</span></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 EsGoods 组件的 DOM 结构中渲染商品的信息数据</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div class=&quot;goods-container&quot;&gt;</span><br><span class="line">    &lt;!-- 左侧图片区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;left&quot;&gt;</span><br><span class="line">      &lt;div class=&quot;form-check&quot;&gt;</span><br><span class="line">        &lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;id&quot; :checked=&quot;checked&quot;&gt;</span><br><span class="line">        &lt;label class=&quot;form-check-label&quot; :for=&quot;id&quot;&gt;</span><br><span class="line">          &lt;img :src=&quot;thumb&quot; alt=&quot;商品图片&quot; class=&quot;thumb&quot;&gt;</span><br><span class="line">        &lt;/label&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">    &lt;!-- 右侧信息区域 --&gt;</span><br><span class="line">    &lt;div class=&quot;right&quot;&gt;</span><br><span class="line">      &lt;!-- 商品名称 --&gt;</span><br><span class="line">      &lt;div class=&quot;top&quot;&gt;&#123;&#123;title&#125;&#125;&lt;/div&gt;</span><br><span class="line">      &lt;div class=&quot;bottom&quot;&gt;</span><br><span class="line">        &lt;!-- 商品价格 --&gt;</span><br><span class="line">        &lt;div class=&quot;price&quot;&gt;￥&#123;&#123;price.toFixed(2)&#125;&#125;&lt;/div&gt;</span><br><span class="line">        &lt;!-- 商品数量 --&gt;</span><br><span class="line">        &lt;div class=&quot;count&quot;&gt;数量:&#123;&#123;count&#125;&#125;&lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    &lt;/div&gt;</span><br><span class="line">  &lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件中使用 EsGoods 组件时，动态绑定对应的属性值</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-goods v-for=&quot;item in goodslist&quot; :key=&quot;item.id&quot; :id=&quot;item.id&quot; :thumb=&quot;item.goods_img&quot;:title=&quot;item.goods_name&quot;:price=&quot;item.goods_price&quot; :count=&quot;item.goods_count&quot; :checked=&quot;item.goods_state&quot;&gt;&lt;/es-goods&gt;</span><br></pre></td></tr></table></figure><h5 id="10-5-6-5-封装自定义事件-stateChange"><a href="#10-5-6-5-封装自定义事件-stateChange" class="headerlink" title="10.5.6.5 封装自定义事件 stateChange"></a>10.5.6.5 封装自定义事件 stateChange</h5><blockquote><p>点击复选框时，可以把最新的勾选状态，通过自定义事件的方式传递给组件的使用者</p></blockquote><ol><li>在 EsGoods 组件中，监听 checkbox 选中状态的事件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input class=&quot;form-check-input&quot; type=&quot;checkbox&quot; value=&quot;&quot; :id=&quot;id&quot; :checked=&quot;checked&quot; @change=&quot;onCheckBoxChange&quot;&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 EsGoods 组件的 methods 中声明对应的事件处理函数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="title function_">onCheckBoxChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(e.target.checked);</span></span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 EsGoods 组件中声明自定义事件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">emits</span>: [<span class="string">&#x27;stateChange&#x27;</span>],</span><br></pre></td></tr></table></figure><ol start="4"><li>完善 onCheckBoxChange 函数的处理逻辑，调用 $emit() 函数触发自定义事件</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="title function_">onCheckBoxChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">// console.log(e.target.checked);</span></span><br><span class="line">        <span class="variable language_">this</span>.$emit(<span class="string">&#x27;stateChange&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">id</span>: <span class="variable language_">this</span>.<span class="property">id</span>,</span><br><span class="line">          <span class="attr">value</span>: e.<span class="property">target</span>.<span class="property">checked</span></span><br><span class="line">        &#125;)</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>在 App 组件中使用 EsGoods 组件时，监听它的 stateChange 事件</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-goods v-for=&quot;item in goodslist&quot; :key=&quot;item.id&quot; :id=&quot;item.id&quot; :thumb=&quot;item.goods_img&quot; :title=&quot;item.goods_name&quot;</span><br><span class="line">      :price=&quot;item.goods_price&quot; :count=&quot;item.goods_count&quot; :checked=&quot;item.goods_state&quot; @stateChange=&quot;onGoodsStateChange&quot;&gt;</span><br></pre></td></tr></table></figure><p>​    并在 App 的 methods 中声明如下的处理函数</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onGoodsStateChange</span>(<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> findResult = <span class="variable language_">this</span>.<span class="property">goodslist</span>.<span class="title function_">find</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">id</span> === e.<span class="property">id</span>)</span><br><span class="line">        <span class="keyword">if</span>(findResult) &#123;</span><br><span class="line">          findResult.<span class="property">goods_state</span> = e.<span class="property">value</span></span><br><span class="line">          <span class="comment">// console.log(findResult.goods_state);</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-5-7-实现合计、结算数量、全选功能"><a href="#10-5-7-实现合计、结算数量、全选功能" class="headerlink" title="10.5.7 实现合计、结算数量、全选功能"></a>10.5.7 实现合计、结算数量、全选功能</h4><h5 id="10-5-7-1-动态统计已勾选商品的总"><a href="#10-5-7-1-动态统计已勾选商品的总" class="headerlink" title="10.5.7.1 动态统计已勾选商品的总"></a>10.5.7.1 动态统计已勾选商品的总</h5><blockquote><p>需求分析：</p><p>合计的商品总价格，依赖于 goodslist 数组中每一件商品信息的变化，此场景下适合使用计算属性</p></blockquote><ol><li>在 App 中声明如下的计算属性</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">computed</span>: &#123;</span><br><span class="line">      <span class="comment">// 已勾选商品的总价格</span></span><br><span class="line">      <span class="title function_">amount</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> a = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">goodslist</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">goods_state</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">          a += x.<span class="property">goods_count</span> * x.<span class="property">goods_price</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// 已勾选商品的总数量</span></span><br><span class="line">      <span class="title function_">total</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> t = <span class="number">0</span>;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">goodslist</span>.<span class="title function_">filter</span>(<span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">goods_state</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">x</span> =&gt;</span> &#123;</span><br><span class="line">          t += x.<span class="property">goods_count</span></span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">return</span> t</span><br><span class="line">      &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 中使用 EsGoods 组件时，动态绑定已勾选商品的总价格</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;es-footer :amount=&quot;amount&quot; :total=&quot;total&quot; @fullChange=&quot;onFullStateChange&quot;&gt;&lt;/es-footer&gt;</span><br></pre></td></tr></table></figure><h4 id="10-5-8-封装-es-counter-组件"><a href="#10-5-8-封装-es-counter-组件" class="headerlink" title="10.5.8 封装 es-counter 组件"></a>10.5.8 封装 es-counter 组件</h4><h5 id="10-5-8-1-创建并注册-EsCounter-组件"><a href="#10-5-8-1-创建并注册-EsCounter-组件" class="headerlink" title="10.5.8.1 创建并注册 EsCounter 组件"></a>10.5.8.1 创建并注册 EsCounter 组件</h5><p>…</p><h5 id="10-5-8-2-封装-es-counter-组件"><a href="#10-5-8-2-封装-es-counter-组件" class="headerlink" title="10.5.8.2 封装 es-counter 组件"></a>10.5.8.2 封装 es-counter 组件</h5><ol start="0"><li>封装需求</li></ol><ul><li>渲染组件的基础布局</li><li>实现数量值的加减操作</li><li>处理 min 最小值</li><li>使用 watch 侦听器处理文本框输入的结果</li><li>封装 numChange 自定义事件</li></ul><h3 id="10-6-ref-引用"><a href="#10-6-ref-引用" class="headerlink" title="10.6 ref 引用"></a>10.6 ref 引用</h3><h4 id="10-6-1-什么是-ref-引用"><a href="#10-6-1-什么是-ref-引用" class="headerlink" title="10.6.1 什么是 ref 引用"></a>10.6.1 什么是 ref 引用</h4><p>ref 用来辅助开发者在不依赖于 jQuery 的情况下，获取 DOM 元素或组件的引用。</p><p>每个 vue 的组件实例上，都包含了一个 $refs 对象，里面存储着对应的 DOM 元素或组件的引用，默认形况下，$refs 指向一个空对象。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;h3&gt;MyRef&lt;/h3&gt;</span><br><span class="line">&lt;button @click=&quot;getRef&quot;&gt;获取 $refs 引用&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        methods: &#123;</span><br><span class="line">            getRef() &#123;</span><br><span class="line">                console.log(this) // this 代表当前组件的实例对象，this.$refs 默认指向空对象</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="10-6-2-如何使用-ref-引用-DOM-元素"><a href="#10-6-2-如何使用-ref-引用-DOM-元素" class="headerlink" title="10.6.2 如何使用 ref 引用 DOM 元素"></a>10.6.2 如何使用 ref 引用 DOM 元素</h4><p>如果想要使用 ref 引用页面上的 DOM 元素，则可以按照如下的方式进行操作：</p><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用 ref 属性，为对应的 <span class="variable constant_">DOM</span> 添加引用名称 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">h3</span> <span class="attr">ref</span>=<span class="string">&quot;myh3&quot;</span>&gt;</span>MyRef<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getRef&quot;</span>&gt;</span>获取 $refs 引用<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="attr">method</span>: &#123;</span><br><span class="line">    <span class="title function_">getRef</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">myh3</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">myh3</span>.<span class="property">style</span>.<span class="property">color</span> = <span class="string">&#x27;red&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-6-3-使用-ref-引用组件实例"><a href="#10-6-3-使用-ref-引用组件实例" class="headerlink" title="10.6.3 使用 ref 引用组件实例"></a>10.6.3 使用 ref 引用组件实例</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用 ref 属性，为对应的组件添加引用名称 --&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">my-counter</span> <span class="attr">ref</span>=<span class="string">&quot;conterRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">my-counter</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;getRef&quot;</span>&gt;</span>获取 $refs 引用<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="attr">method</span>: &#123;</span><br><span class="line">    <span class="title function_">getRef</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">conterRef</span>)</span><br><span class="line">        <span class="comment">// 引用到组件的实例之后，就可以调用组件上的 methods 方法</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">counterRef</span>.<span class="title function_">add</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-6-4-控制文本框和按钮的按需切换"><a href="#10-6-4-控制文本框和按钮的按需切换" class="headerlink" title="10.6.4 控制文本框和按钮的按需切换"></a>10.6.4 控制文本框和按钮的按需切换</h4><p>通过布尔值 inputVisible 来控制组件中的文本框与按钮的按需切换</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-if=&quot;inputVisible&quot;&gt;</span><br><span class="line">&lt;button v-else @click=&quot;showInput&quot;&gt;展示 input 输入框&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">inputVisible</span>: flase,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line"><span class="title function_">showInput</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">inputVisible</span> = <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-6-5-让文本框自动获得焦点"><a href="#10-6-5-让文本框自动获得焦点" class="headerlink" title="10.6.5 让文本框自动获得焦点"></a>10.6.5 让文本框自动获得焦点</h4><p>当文本框展示出来之后，如果希望它立即获得焦点，则可以添加 ref 引用，并调用原生的 DOM 对象的 .focus() 方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-if=&quot;inputVisible&quot; ref=&quot;ipt&quot;&gt;</span><br><span class="line">&lt;button v-else @click=&quot;showInput&quot;&gt;展示 input 输入框&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        methods: &#123;</span><br><span class="line">            showInput() &#123;</span><br><span class="line">                this.inputVisible = true,</span><br><span class="line">                this.$refs.ipt.focus()  </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><blockquote><p>报错</p></blockquote><h4 id="10-6-6-this-nextTick-cb-方法"><a href="#10-6-6-this-nextTick-cb-方法" class="headerlink" title="10.6.6 this.$nextTick(cb) 方法"></a>10.6.6 this.$nextTick(cb) 方法</h4><p>组件的 $nextTick(cb) 方法，会把 cb 回调推迟到下一个 DOM 更新周期之后执行。通俗的理解是：等组件的 DOM 异步地重新渲染完成之后，在执行 cb 回调函数，从而保证 cb 回调函数可以操作到最新的 DOM 元素。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;input type=&quot;text&quot; v-if=&quot;inputVisible&quot; ref=&quot;ipt&quot;&gt;</span><br><span class="line">&lt;button v-else @click=&quot;showInput&quot;&gt;展示 input 输入框&lt;/button&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">export default &#123;</span><br><span class="line">        methods: &#123;</span><br><span class="line">            showInput() &#123;</span><br><span class="line">                this.inputVisible = true,</span><br><span class="line">                this.$nextTick(() =&gt; &#123;</span><br><span class="line">                    this.$refs.ipt.focus()</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h3 id="10-7-动态组件"><a href="#10-7-动态组件" class="headerlink" title="10.7 动态组件"></a>10.7 动态组件</h3><h4 id="10-7-1-什么是动态组件"><a href="#10-7-1-什么是动态组件" class="headerlink" title="10.7.1 什么是动态组件"></a>10.7.1 什么是动态组件</h4><p>动态组件指的是动态切换组件的显示和隐藏，vue 提供了一个内置的 <code>&lt;component&gt;</code>组件，专门用来实现组件的动态渲染。</p><ul><li><code>&lt;component&gt;</code> 是组件的占位符</li><li>通过 is 属性动态指定要渲染的组件名称</li><li><code>&lt;component is=&quot;要渲染的组件的名称&quot;&gt; &lt;component&gt;</code></li></ul><h4 id="10-7-2-如何实现动态组件渲染"><a href="#10-7-2-如何实现动态组件渲染" class="headerlink" title="10.7.2 如何实现动态组件渲染"></a>10.7.2 如何实现动态组件渲染</h4><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">comName</span>: <span class="string">&#x27;my-ydnamic-1&#x27;</span> <span class="comment">// 1.当前要渲染的组件的名称</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">&lt;template&gt;</span><br><span class="line">&lt;!-- <span class="number">3.</span>点击按钮，动态切换组件的名称 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;comName=&#x27;my-dynamic-1&#x27;&quot;</span>&gt;</span>组件1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;comName=&#x27;my-dynamic-2&#x27;&quot;</span>&gt;</span>组件2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    &lt;!-- <span class="number">2.</span>通过 is 属性，动态指定要渲染的组件的名称 --&gt;</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;comName&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span></span><br><span class="line">&lt;/template&gt;    </span><br></pre></td></tr></table></figure><h4 id="10-7-3-使用-keep-alive-保持状态"><a href="#10-7-3-使用-keep-alive-保持状态" class="headerlink" title="10.7.3 使用 keep-alive 保持状态"></a>10.7.3 使用 keep-alive 保持状态</h4><p>默认情况下，切换动态组件时无法保持组件的状态。此时可以使用 vue 内置的 <code>&lt;keep-alive&gt;</code> 组件保持动态组件的状态。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;keep-alive&gt;</span><br><span class="line">&lt;component :is=&quot;comName&quot;&gt;&lt;/component&gt;</span><br><span class="line">&lt;/keep-alive&gt;</span><br></pre></td></tr></table></figure><h3 id="10-8-插槽"><a href="#10-8-插槽" class="headerlink" title="10.8 插槽"></a>10.8 插槽</h3><h4 id="10-8-1什么是插槽"><a href="#10-8-1什么是插槽" class="headerlink" title="10.8.1什么是插槽"></a>10.8.1什么是插槽</h4><p>插槽是 vue 为组件的封装者提供的能力。允许开发者在封装组件时，把不确定的、希望由用户指定的部分指定为插槽。</p><p><img src="https://s2.loli.net/2022/09/16/5iI823OPzdYeAyC.png" alt="image-20220916102759850.png"></p><p>可以把插槽认为时组件封装期间，为用户预留的内容的占位符。</p><h4 id="10-8-2-体验插槽的基本用法"><a href="#10-8-2-体验插槽的基本用法" class="headerlink" title="10.8.2 体验插槽的基本用法"></a>10.8.2 体验插槽的基本用法</h4><p>在封装组件时，可以通过 <code>&lt;slot&gt;</code>元素定义插槽，从而为用户预留内容占位符。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的第一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;slot&gt;&lt;/slot&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的最后一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-com-1&gt;</span><br><span class="line">&lt;p&gt;用户自定义的内容&lt;/p&gt;</span><br><span class="line">&lt;/my-com-1&gt;</span><br></pre></td></tr></table></figure><h5 id="10-8-2-1-没有预留插槽的内容会被丢弃"><a href="#10-8-2-1-没有预留插槽的内容会被丢弃" class="headerlink" title="10.8.2.1 没有预留插槽的内容会被丢弃"></a>10.8.2.1 没有预留插槽的内容会被丢弃</h5><p>如果在封装组件时没有预留任何 <code>&lt;slot&gt;</code>插槽，则用户提供的任何自定义内容都会被丢弃</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的第一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的最后一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-com-1&gt;</span><br><span class="line">&lt;p&gt;用户自定义的内容&lt;/p&gt;</span><br><span class="line">&lt;/my-com-1&gt;</span><br></pre></td></tr></table></figure><h5 id="10-8-2-2-后备内容"><a href="#10-8-2-2-后备内容" class="headerlink" title="10.8.2.2 后备内容"></a>10.8.2.2 后备内容</h5><p>封装组件时，可以为预留的 <code>&lt;slot&gt;</code>插槽提供后备内容（默认内容）。如果组件的使用者没有为插槽提供任何内容，则后备内容会生效。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的第一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;slot&gt;这是后备内容&lt;/slot&gt;</span><br><span class="line">&lt;p&gt;这是 MyCom 组件的最后一个 p 标签&lt;/p&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><h4 id="10-8-3-具名插槽"><a href="#10-8-3-具名插槽" class="headerlink" title="10.8.3 具名插槽"></a>10.8.3 具名插槽</h4><p>如果在封装组件时需要预留多个插槽节点，则需要为每个 <code>&lt;slot&gt;</code> 插槽指定具体的 name 纳名称。这种带有具体名称的插槽叫做“具名插槽”。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div class=&quot;container&quot;&gt;</span><br><span class="line">    &lt;header&gt;</span><br><span class="line">    &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">    &lt;main&gt;</span><br><span class="line">    &lt;slot name=&quot;main&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/main&gt;</span><br><span class="line">    &lt;footer&gt;</span><br><span class="line">    &lt;slot name=&quot;footer&quot;&gt;&lt;/slot&gt;</span><br><span class="line">    &lt;/footer&gt;</span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure><blockquote><p>如果没有指定 name 名称的插槽，会有隐含的名称叫做“default”</p></blockquote><h5 id="10-8-3-1-为具名插槽提供内容"><a href="#10-8-3-1-为具名插槽提供内容" class="headerlink" title="10.8.3.1 为具名插槽提供内容"></a>10.8.3.1 为具名插槽提供内容</h5><p>在向具名提供内容的时候，我们可以在一个 <code>&lt;template&gt;</code>元素上使用 v-slot 指令，并以 v-slot 的参数的形式提供其名称。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-com-1&gt;</span><br><span class="line">&lt;template v-slot:header&gt;</span><br><span class="line">    &lt;h1&gt;xxx&lt;/h1&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template v-slot:main&gt;</span><br><span class="line">    &lt;p&gt;...&lt;/p&gt;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">    &lt;template v-slot:footer&gt;</span><br><span class="line">&lt;p&gt;xxx&lt;/p&gt;    </span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/my-com-1&gt;</span><br></pre></td></tr></table></figure><h5 id="10-8-3-2-具名插槽的简写形式"><a href="#10-8-3-2-具名插槽的简写形式" class="headerlink" title="10.8.3.2 具名插槽的简写形式"></a>10.8.3.2 具名插槽的简写形式</h5><p>跟 v-on 和 v-bind 一样，v-slot 也有缩写，即把参数之前的 v-slot：替换为 # 。</p><h4 id="10-8-4-作用域插槽"><a href="#10-8-4-作用域插槽" class="headerlink" title="10.8.4 作用域插槽"></a>10.8.4 作用域插槽</h4><p>在封装组件的过程中，可以为预留的 <code>&lt;slot&gt;</code> 插槽绑定 props 数据，这种带有 props 数据的 插槽叫做 “作用域” 插槽。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">&lt;h3&gt;这是 Test 组件&lt;/h3&gt;</span><br><span class="line">    &lt;slot :info=&quot;infomation&quot;&gt;&lt;/slot&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- 使用自定义组件 --&gt;</span><br><span class="line">&lt;my-test&gt;</span><br><span class="line">&lt;template v-slot:default=&quot;scope&quot;&gt;</span><br><span class="line">    &#123;&#123;scope&#125;&#125;</span><br><span class="line">    &lt;/template&gt;</span><br><span class="line">&lt;/my-test&gt;</span><br></pre></td></tr></table></figure><h3 id="10-9-自定义指令"><a href="#10-9-自定义指令" class="headerlink" title="10.9 自定义指令"></a>10.9 自定义指令</h3><h4 id="10-9-1-什么是之定义指令"><a href="#10-9-1-什么是之定义指令" class="headerlink" title="10.9.1 什么是之定义指令"></a>10.9.1 什么是之定义指令</h4><p>vue 官方提供了 v-for、v-model、v-if 等常用的内置指令。除此之外 vue 还允许开发者自定义指令。</p><p>vue 中的自定义指令分为两类，分别是：</p><ul><li>私有自定义指令</li><li>全局自定义指令</li></ul><h4 id="10-9-2-声明私有自定义指令的语法"><a href="#10-9-2-声明私有自定义指令的语法" class="headerlink" title="10.9.2 声明私有自定义指令的语法"></a>10.9.2 声明私有自定义指令的语法</h4><p>在每个 vue 组件中，可以在 directives 节点下声明私有自定义指令。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">    <span class="comment">// 自定义一个私有指令</span></span><br><span class="line">    <span class="attr">focus</span>: &#123;</span><br><span class="line">        <span class="comment">// 当前绑定的元素插入到 DOM 中时，自动触发 mounted 函数</span></span><br><span class="line">        <span class="title function_">mounted</span>(<span class="params">el</span>) &#123;</span><br><span class="line">            el.<span class="property">focus</span> <span class="comment">// 让被绑定的元素自动获得焦点</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-9-3-声明全局自定义指令的语法"><a href="#10-9-3-声明全局自定义指令的语法" class="headerlink" title="10.9.3 声明全局自定义指令的语法"></a>10.9.3 声明全局自定义指令的语法</h4><p>全局共享的自定义指令需要通过“单页面应用程序的实例对象”进行声明。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> app = <span class="title class_">Vue</span>.<span class="title function_">createApp</span>(&#123;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册一个全局自定义指令 ‘v-focus’</span></span><br><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">    <span class="comment">// 当前绑定的元素插入到 DOM 中时，自动触发 mounted 函数</span></span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params">el</span>) &#123;</span><br><span class="line">        el.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="10-9-4-updated-函数"><a href="#10-9-4-updated-函数" class="headerlink" title="10.9.4 updated 函数"></a>10.9.4 updated 函数</h4><p>mounted 函数只在元素第一次插入 DOM 时被调用，当 DOM 更新时 mounted 函数不会被触发。updated 函数会在每次更新完成后被调用。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, &#123;</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params">el</span>) &#123;</span><br><span class="line">        el.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">updated</span>(<span class="params">el</span>) &#123;</span><br><span class="line">        el.<span class="title function_">focus</span>()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>注意： 在 vue2  的项目中，使用自定义指令时，【 mounted -&gt; bind 】、【 updated -&gt; update 】</p></blockquote><h4 id="10-9-5-函数简写"><a href="#10-9-5-函数简写" class="headerlink" title="10.9.5 函数简写"></a>10.9.5 函数简写</h4><p>如果 mounted 和 updated 函数中的逻辑完全相同，则可以简写成：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">directive</span>(<span class="string">&#x27;focus&#x27;</span>, <span class="function">(<span class="params">el</span>) =&gt;</span> &#123;</span><br><span class="line">    el.<span class="title function_">focus</span>()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="10-9-6-指令的参数值"><a href="#10-9-6-指令的参数值" class="headerlink" title="10.9.6 指令的参数值"></a>10.9.6 指令的参数值</h4><p>在绑定指令时，可以通过“等号”的形式为指令绑定具体的参数值。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; v-model.number=&quot;count&quot; v-focus v-color=&quot;red&quot;&gt;</span><br><span class="line">&lt;p v-color=&quot;cyan&quot;&gt;&#123;&#123;count&#125;&#125;&lt;/p&gt;</span><br><span class="line"></span><br><span class="line">&lt;button @click=&quot;count++&quot; &gt;+1&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">// 自定义v-color 指令</span><br><span class="line">app.dirctive(&#x27;color, binding&#x27;, &#123;</span><br><span class="line">// binding.value 就是通过“等号”为指定绑定的值</span><br><span class="line">el.style.color = binding.value</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="10-10-Table-案例"><a href="#10-10-Table-案例" class="headerlink" title="10.10 Table 案例"></a>10.10 Table 案例</h3><p>用到的知识点：</p><ul><li>组件封装</li><li>具名插槽</li><li>作用域插槽</li><li>自定义指令</li></ul><p>实现步骤：</p><ol><li>搭建项目的基本结构</li><li>请求商品列表的数据</li><li>封装 MyTable 组件</li><li>实现删除功能</li><li>实现添加标签的功能</li></ol><h4 id="10-10-1-搭建项目基本结构"><a href="#10-10-1-搭建项目基本结构" class="headerlink" title="10.10.1 搭建项目基本结构"></a>10.10.1 搭建项目基本结构</h4><h5 id="10-10-1-1-初始化项目"><a href="#10-10-1-1-初始化项目" class="headerlink" title="10.10.1.1 初始化项目"></a>10.10.1.1 初始化项目</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">npm init vite-app table-demo</span><br><span class="line">npm install</span><br><span class="line">npm i less -D</span><br><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h4 id="10-10-2-请求商品列表数据"><a href="#10-10-2-请求商品列表数据" class="headerlink" title="10.10.2 请求商品列表数据"></a>10.10.2 请求商品列表数据</h4><ol><li>安装 Ajax</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios -S</span><br></pre></td></tr></table></figure><ol start="2"><li>在 main.js 中导如并配置全局 axios</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; createApp &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./assets/css/bootstrap.css&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br><span class="line"></span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 的 data 中声明 goodslist 商品列表数据：</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        <span class="attr">goodslist</span>: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><ol start="4"><li>methods 声明 getGoodsList 方法。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">      <span class="keyword">async</span> <span class="title function_">getGoodsList</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123;<span class="attr">data</span>:res&#125; = <span class="keyword">await</span> <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">get</span>(<span class="string">&#x27;/api/goods&#x27;</span>)</span><br><span class="line">        <span class="comment">// console.log(res)</span></span><br><span class="line">        <span class="keyword">if</span>(res.<span class="property">status</span> !== <span class="number">0</span> ) <span class="keyword">return</span> <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;获取列表失败！&#x27;</span>)</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">goodslist</span> = res.<span class="property">data</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ol start="5"><li>声明 created 函数并调用 getGoodsList 方法</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">created</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">getGoodsList</span>()</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><h4 id="10-10-3-封装-MyTable-组件"><a href="#10-10-3-封装-MyTable-组件" class="headerlink" title="10.10.3 封装 MyTable 组件"></a>10.10.3 封装 MyTable 组件</h4><h5 id="10-10-3-0-MyTable-组件的封装要求"><a href="#10-10-3-0-MyTable-组件的封装要求" class="headerlink" title="10.10.3.0 MyTable 组件的封装要求"></a>10.10.3.0 MyTable 组件的封装要求</h5><ol><li>用户通过名为 data 的 prop 属性，为 MyTable 组件指定数据源</li><li>在 MyTable 组件中，预留名称为 header 的具名插槽</li><li>在 MyTable 组件中，预留名称为 body 的作用域插槽</li></ol><h5 id="10-10-3-1-创建并使用-MyTable-组件"><a href="#10-10-3-1-创建并使用-MyTable-组件" class="headerlink" title="10.10.3.1 创建并使用 MyTable 组件"></a>10.10.3.1 创建并使用 MyTable 组件</h5><p>​    …</p><h5 id="10-10-3-2-为表格声明-data-数据源"><a href="#10-10-3-2-为表格声明-data-数据源" class="headerlink" title="10.10.3.2 为表格声明 data 数据源"></a>10.10.3.2 为表格声明 data 数据源</h5><ol><li>在 MyTable 组件的 props 节点中声明表格的 data 数据源</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">props</span>: &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="title class_">Array</span>,</span><br><span class="line">        <span class="attr">required</span>: <span class="literal">true</span>,</span><br><span class="line">        <span class="attr">default</span>: []</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 组件中使用 MyTable 组件时，通过属性绑定的形式为表格指定 data 数据源</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-table :data=&quot;goodslist&quot;&gt;&lt;/my-table&gt;</span><br></pre></td></tr></table></figure><h5 id="10-10-3-3-封装-MyTable-组件的模板结构"><a href="#10-10-3-3-封装-MyTable-组件的模板结构" class="headerlink" title="10.10.3.3 封装 MyTable 组件的模板结构"></a>10.10.3.3 封装 MyTable 组件的模板结构</h5><ol><li>基于 bootstrap 提供的 Tables，在 MyTable 组件中渲染最基本的模板结构</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;table class=&quot;table table-bordered table-striped table-hover&quot;&gt;</span><br><span class="line">    &lt;!-- 标题区域 --&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;!-- 内容主体区域 --&gt;</span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;body&quot; :row=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">  &lt;/table&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>为了提高组件的复用性，最好把表格的标题区域预留为 slot 具名插槽，方便使用者自定义表格数据</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;table class=&quot;table table-bordered table-striped table-hover&quot;&gt;</span><br><span class="line">    &lt;!-- 标题区域 --&gt;</span><br><span class="line">    &lt;thead&gt;</span><br><span class="line">      &lt;tr&gt;</span><br><span class="line">        &lt;slot name=&quot;header&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/thead&gt;</span><br><span class="line">    &lt;!-- 内容主体区域 --&gt;</span><br><span class="line">    &lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;body&quot; :row=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br><span class="line">  &lt;/table&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在 App 组件中，通过具名插槽的形式，为 MyTable 组件指定标题名称</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-table :data=&quot;goodslist&quot;&gt;</span><br><span class="line">      &lt;template #header&gt;</span><br><span class="line">        &lt;th&gt;#&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;商品名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;价格&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标签&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template #body=&quot;&#123;row, index&#125;&quot;&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;index + 1&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;row.goods_name&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;￥&#123;&#123;row.goods_price&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;row.tags&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;button type=&quot;button&quot; class=&quot;btn btn-danger btn-sm&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/my-table&gt;</span><br></pre></td></tr></table></figure><h5 id="10-10-3-4-预留名称为-body-的作用域插槽"><a href="#10-10-3-4-预留名称为-body-的作用域插槽" class="headerlink" title="10.10.3.4 预留名称为 body 的作用域插槽"></a>10.10.3.4 预留名称为 body 的作用域插槽</h5><ol><li>在 MyTable 组件中，通过 v-for 指令 循环渲染 表格的数据行</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;body&quot; :row=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>为了提高 MyTable 组件的复用性，最好把表格数据行里面的 td 单元格预留位 slot 具名插槽。</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;body&quot; :row=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>为了让组件的使用者提供 body 插槽的内容时，能够自定义内容的渲染方式，需要把 body 具名插槽升级为 作用域插槽</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;tbody&gt;</span><br><span class="line">      &lt;tr v-for=&quot;(item, index) in data&quot; :key=&quot;item.id&quot;&gt;</span><br><span class="line">        &lt;slot name=&quot;body&quot; :row=&quot;item&quot; :index=&quot;index&quot;&gt;&lt;/slot&gt;</span><br><span class="line">      &lt;/tr&gt;</span><br><span class="line">    &lt;/tbody&gt;</span><br></pre></td></tr></table></figure><ol start="4"><li>在 App 组件中，基于作用域插槽的方式渲染表格的数据</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;my-table :data=&quot;goodslist&quot;&gt;</span><br><span class="line">      &lt;template #header&gt;</span><br><span class="line">        &lt;th&gt;#&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;商品名称&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;价格&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;标签&lt;/th&gt;</span><br><span class="line">        &lt;th&gt;操作&lt;/th&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">      &lt;template #body=&quot;&#123;row, index&#125;&quot;&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;index + 1&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;row.goods_name&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;￥&#123;&#123;row.goods_price&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;&#123;&#123;row.tags&#125;&#125;&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;</span><br><span class="line">          &lt;button type=&quot;button&quot; class=&quot;btn btn-danger btn-sm&quot;&gt;删除&lt;/button&gt;</span><br><span class="line">        &lt;/td&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/my-table&gt;</span><br></pre></td></tr></table></figure><h4 id="10-10-4-实现删除功能‘"><a href="#10-10-4-实现删除功能‘" class="headerlink" title="10.10.4 实现删除功能‘"></a>10.10.4 实现删除功能‘</h4><ol><li>为删除按钮绑定 click 事件处理函数</li></ol><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn btn-danger btn-sm&quot; @click=&quot;onRemove(row.id)&quot;&gt;删除&lt;/button&gt;</span><br></pre></td></tr></table></figure><ol start="2"><li>在 App 组件的 methods 中声明事件处理函数</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onRemove</span>(<span class="params">id</span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">goodslist</span> = <span class="variable language_">this</span>.<span class="property">goodslist</span>.<span class="title function_">filter</span>( <span class="function"><span class="params">x</span> =&gt;</span> x.<span class="property">id</span> !== id)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="10-10-5-实现添加功能"><a href="#10-10-5-实现添加功能" class="headerlink" title="10.10.5 实现添加功能"></a>10.10.5 实现添加功能</h4><h5 id="10-10-5-1-自定义渲染标签列"><a href="#10-10-5-1-自定义渲染标签列" class="headerlink" title="10.10.5.1 自定义渲染标签列"></a>10.10.5.1 自定义渲染标签列</h5><p>根据 bootstrap 提供的 Badge 效果，循环渲染商品的标签信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;span class=&quot;badge bg-warning text-dark me-2&quot; v-for=&quot;item in row.tags&quot; :key=&quot;item&quot;&gt;&#123;&#123;item&#125;&#125;&lt;/span&gt;</span><br></pre></td></tr></table></figure><h5 id="10-10-5-2-实现-input-和-button-按需展示"><a href="#10-10-5-2-实现-input-和-button-按需展示" class="headerlink" title="10.10.5.2 实现 input 和 button 按需展示"></a>10.10.5.2 实现 input 和 button 按需展示</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=&quot;text&quot; class=&quot;form-control form-control-sm form-ipt&quot; v-if=&quot;row.inVisible&quot;&gt;</span><br><span class="line">&lt;button type=&quot;button&quot; class=&quot;btn btn-primary btn-sm&quot; v-else @click=&quot;row.inVisible = true&quot;&gt;+Tag&lt;/button&gt;</span><br></pre></td></tr></table></figure><h5 id="10-10-5-3-让-input-自动获取焦点"><a href="#10-10-5-3-让-input-自动获取焦点" class="headerlink" title="10.10.5.3 让 input 自动获取焦点"></a>10.10.5.3 让 input 自动获取焦点</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> <span class="keyword">class</span>=<span class="string">&quot;form-control form-control-sm form-ipt&quot;</span> v-<span class="keyword">if</span>=<span class="string">&quot;row.inVisible&quot;</span> v-focus&gt;</span><br><span class="line">    </span><br><span class="line"><span class="attr">directives</span>: &#123;</span><br><span class="line">      <span class="title function_">focus</span>(<span class="params">el</span>) &#123;</span><br><span class="line">        el.<span class="title function_">focus</span>()</span><br><span class="line">      &#125;</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h5 id="10-10-5-4-文本失去焦点自动隐藏"><a href="#10-10-5-4-文本失去焦点自动隐藏" class="headerlink" title="10.10.5.4 文本失去焦点自动隐藏"></a>10.10.5.4 文本失去焦点自动隐藏</h5><figure class="highlight jsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;text&quot;</span> <span class="keyword">class</span>=<span class="string">&quot;form-control form-control-sm form-ipt&quot;</span> v-<span class="keyword">if</span>=<span class="string">&quot;row.inputVisible&quot;</span> v-focus v-model.<span class="property">trim</span>=<span class="string">&quot;row.inputValue&quot;</span> @blur=<span class="string">&quot;onInputConfirm(row)&quot;</span>&gt;</span><br></pre></td></tr></table></figure><h5 id="10-10-5-5-为商品添加新的-tag-标签"><a href="#10-10-5-5-为商品添加新的-tag-标签" class="headerlink" title="10.10.5.5 为商品添加新的 tag 标签"></a>10.10.5.5 为商品添加新的 tag 标签</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">onInputConfirm</span>(<span class="params">item</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> val = item.<span class="property">inputValue</span> </span><br><span class="line">        item.<span class="property">inputValue</span> = <span class="string">&#x27;&#x27;</span></span><br><span class="line">        item.<span class="property">inputVisible</span> = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">if</span>(!val || item.<span class="property">tags</span>.<span class="title function_">indexOf</span>(val) !== -<span class="number">1</span>) <span class="keyword">return</span> </span><br><span class="line">        item.<span class="property">tags</span>.<span class="title function_">push</span>(val)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="10-10-5-6-响应文本框的回车按钮"><a href="#10-10-5-6-响应文本框的回车按钮" class="headerlink" title="10.10.5.6 响应文本框的回车按钮"></a>10.10.5.6 响应文本框的回车按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control form-control-sm form-ipt&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;row.inputVisible&quot;</span> <span class="attr">v-focus</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;row.inputValue&quot;</span> @<span class="attr">blur</span>=<span class="string">&quot;onInputConfirm(row)&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;onInputConfirm(row)&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h5 id="10-10-5-7-响应文本框-esc-按钮"><a href="#10-10-5-7-响应文本框-esc-按钮" class="headerlink" title="10.10.5.7 响应文本框 esc 按钮"></a>10.10.5.7 响应文本框 esc 按钮</h5><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;form-control form-control-sm form-ipt&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;row.inputVisible&quot;</span> <span class="attr">v-focus</span> <span class="attr">v-model.trim</span>=<span class="string">&quot;row.inputValue&quot;</span> @<span class="attr">blur</span>=<span class="string">&quot;onInputConfirm(row)&quot;</span> @<span class="attr">keyup.enter</span>=<span class="string">&quot;onInputConfirm(row)&quot;</span> @<span class="attr">keyup.esc</span>=<span class="string">&quot;row.inputValue=&#x27;&#x27;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="11-vue-cli"><a href="#11-vue-cli" class="headerlink" title="11 vue-cli"></a>11 vue-cli</h2><h3 id="11-1-什么是-vue-cli"><a href="#11-1-什么是-vue-cli" class="headerlink" title="11.1 什么是 vue-cli"></a>11.1 什么是 vue-cli</h3><p>vue-cli （俗称：vue 脚手架）是 vue 官方提供的快速生成 vue 工程化项目的工具。</p><p>特点：</p><ol><li>开箱即用</li><li>基于 webpack</li><li>功能丰富且易于扩展</li><li>支持创建 vue2 和 vue3 的项目</li></ol><h3 id="11-2-安装vue-cli"><a href="#11-2-安装vue-cli" class="headerlink" title="11.2 安装vue-cli"></a>11.2 安装vue-cli</h3><p>vue-cli 是基于 Node.js 开发出来的工具，因此需要使用 npm 将它安装为全局可用的工具</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><h4 id="解决-Windows-powershell-不识别-vue-命令的问题"><a href="#解决-Windows-powershell-不识别-vue-命令的问题" class="headerlink" title="解决 Windows powershell 不识别 vue 命令的问题"></a>解决 Windows powershell 不识别 vue 命令的问题</h4><p>默认情况下，在 PowerShell 中执行 vue –version 命令会提示错误。</p><p>解决方法：</p><ol><li>以管理员身份运行 powershell</li><li>执行 set-ExecutionPolicy RemoteSigned 命令</li><li>输入字符 Y ，回车</li></ol><h3 id="11-3-创建项目"><a href="#11-3-创建项目" class="headerlink" title="11.3 创建项目"></a>11.3 创建项目</h3><p>vue-cli 提供了创建项目的两种方式</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 命令行</span></span><br><span class="line">vue create 项目名称</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可视化界面</span></span><br><span class="line">vue ui</span><br></pre></td></tr></table></figure><h2 id="12-组件库"><a href="#12-组件库" class="headerlink" title="12 组件库"></a>12 组件库</h2><h3 id="12-1什么是组件库"><a href="#12-1什么是组件库" class="headerlink" title="12.1什么是组件库"></a>12.1什么是组件库</h3><p>在实际开发中，前端开发者可以把自己封装的 .vue 组件整理、打包、并发布为 npm 包，从而供其他人下载和使用。这种可以直接下载并在项目中使用的现成组件，就叫做 vue 组件库。</p><h3 id="12-2vue-组件库和-bootstrap-的区别"><a href="#12-2vue-组件库和-bootstrap-的区别" class="headerlink" title="12.2vue 组件库和 bootstrap 的区别"></a>12.2vue 组件库和 bootstrap 的区别</h3><p>二者之间存在本质的区别：</p><ul><li>bootstrap 只提供了纯粹的原材料（css 样式、HTML 结构以及 js 特效），需要由开发者进一步的组装和改造。</li><li>vue 组件库是遵循 vue 语法、高度定制的现成组件，开箱即用。</li></ul><h3 id="12-3最常见的-vue-组件库"><a href="#12-3最常见的-vue-组件库" class="headerlink" title="12.3最常见的 vue 组件库"></a>12.3最常见的 vue 组件库</h3><ol><li>PC 端</li></ol><ul><li>Element UI</li><li>View UI</li></ul><ol start="2"><li>移动端</li></ol><ul><li>MInt UI</li><li>Vant</li></ul><h3 id="12-4Element-UI"><a href="#12-4Element-UI" class="headerlink" title="12.4Element UI"></a>12.4Element UI</h3><p>Element UI 是饿了么前端团队开源的一套 PC 端 vue 组件库。支持在 vue2 和 vue3 的项目中使用：</p><ul><li>vue2 的项目中使用旧版的 Element UI</li><li>vue3 的项目中使用新版的 Element Plus</li></ul><h4 id="在-vue2-的项目中安装-element-ui"><a href="#在-vue2-的项目中安装-element-ui" class="headerlink" title="- 在 vue2 的项目中安装 element-ui"></a>- 在 vue2 的项目中安装 element-ui</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install element-ui -S</span><br></pre></td></tr></table></figure><h4 id="引入-element-ui"><a href="#引入-element-ui" class="headerlink" title="- 引入 element-ui"></a>- 引入 element-ui</h4><p>开发者可以一次性完整引入所有的 element-ui 组件，或是根据需求，只按需引入用到的 element-ui 组件：</p><ul><li>完整引入：操作简单，但是会额外引入一些用不到的组件，导致项目体积过大。</li><li>按需引入：操作相对复杂一些，但是只会引入用到的组件，能起到优化项目体积的目的。</li></ul><h4 id="完整引入"><a href="#完整引入" class="headerlink" title="- 完整引入"></a>- 完整引入</h4><p>在 main.js 中写入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 完整引入 element-ui 组件</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementUI</span> <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"><span class="comment">// 导入 element-ui 组件的样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 把 ElementUI 注册为 vue 的插件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">ElementUI</span>) </span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="按需引入"><a href="#按需引入" class="headerlink" title="- 按需引入"></a>- 按需引入</h4><p>借助 babel-plugin-component，我们可以只引入需要的组件，以达到减小项目体积的目的。</p><ol><li>安装 babel-plugin-component</li></ol><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install babel-plugin-component</span><br></pre></td></tr></table></figure><ol start="2"><li>修改跟目录下的 babel.config.js 配置文件，新增 plugins 节点。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">presets</span>: [<span class="string">&#x27;@vue/cli-plugin-babel/preset&#x27;</span>],</span><br><span class="line">    <span class="attr">plugins</span>: [</span><br><span class="line">        [</span><br><span class="line">            <span class="string">&#x27;component&#x27;</span>,</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="attr">libraryName</span>: <span class="string">&#x27;element-ui&#x27;</span>,</span><br><span class="line">                <span class="attr">styleLibraryName</span>: <span class="string">&#x27;theme-chalk&#x27;</span></span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>如果你只希望引入部分组件，比如 Button，那么需要在 main.js 中写入。</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 按需导入 element-ui 组件</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Button</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">component</span>(<span class="title class_">Button</span>.<span class="property">name</span>, <span class="title class_">Button</span>)</span><br><span class="line"><span class="comment">// 或者 Vue.use(Button)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>),</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h4 id="把组件的导入和注册封装为独立的模块"><a href="#把组件的导入和注册封装为独立的模块" class="headerlink" title="- 把组件的导入和注册封装为独立的模块"></a>- 把组件的导入和注册封装为独立的模块</h4><p>在 src 目录下新建 element-ui/index.js 模块，并声明如下代码：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 模块路径 /src/element-ui/index.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="comment">// 按需导入 element ui 组件</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Button</span>, <span class="title class_">Input</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册需要的组件</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Button</span>)</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Input</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在 main.js 导入</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;./element-ui&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="13-axios-拦截器"><a href="#13-axios-拦截器" class="headerlink" title="13 axios 拦截器"></a>13 axios 拦截器</h2><h3 id="13-1-回顾：在-vue3-的项目中全局配置axios"><a href="#13-1-回顾：在-vue3-的项目中全局配置axios" class="headerlink" title="13.1 回顾：在 vue3 的项目中全局配置axios"></a>13.1 回顾：在 vue3 的项目中全局配置axios</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;createApp&#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="title function_">createApp</span>(<span class="title class_">App</span>)</span><br><span class="line"></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">app.<span class="property">config</span>.<span class="property">globalProperties</span>.<span class="property">$http</span> = axios</span><br><span class="line">app.<span class="title function_">mount</span>(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="13-2-在-vue2-的项目中全局配置-axios"><a href="#13-2-在-vue2-的项目中全局配置-axios" class="headerlink" title="13.2 在 vue2 的项目中全局配置 axios"></a>13.2 在 vue2 的项目中全局配置 axios</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = axios</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="13-3-什么是拦截器"><a href="#13-3-什么是拦截器" class="headerlink" title="13.3 什么是拦截器"></a>13.3 什么是拦截器</h3><p>拦截器（interceptors）会在每此发起 ajax 请求和得到响应的时候自动被触发。</p><p><img src="https://s2.loli.net/2022/09/24/UEovjr3M4DFgk8t.png" alt="image-20220924131944904.png"></p><p>应用场景：</p><ol><li>Token 身份认证</li><li>Loading 效果</li><li>etc…</li></ol><h3 id="13-4-配置请求拦截器"><a href="#13-4-配置请求拦截器" class="headerlink" title="13.4 配置请求拦截器"></a>13.4 配置请求拦截器</h3><p>通过 axios.interceptors.request.use(成功的回调，失败的回调) 可以配置请求拦截器。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;,<span class="keyword">function</span>(<span class="params">err</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>注意：失败的回调可以被省略</p></blockquote><h4 id="13-4-1-请求拦截器-Token-认证"><a href="#13-4-1-请求拦截器-Token-认证" class="headerlink" title="13.4.1 请求拦截器 - Token 认证"></a>13.4.1 请求拦截器 - Token 认证</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line"></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 为当前请求配置 Token 认证字段</span></span><br><span class="line">    config.<span class="property">headers</span>.<span class="property">Authorization</span> = <span class="string">&#x27;Bearer xxx&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> config</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure><h4 id="13-4-2-请求拦截器-展示-Loading-效果"><a href="#13-4-2-请求拦截器-展示-Loading-效果" class="headerlink" title="13.4.2 请求拦截器 - 展示 Loading 效果"></a>13.4.2 请求拦截器 - 展示 Loading 效果</h4><p>借助于 element ui 提供的 Loading 组件可以方便的实现 Loading 效果的展示。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 按需导入 Loading 效果组件</span></span><br><span class="line"><span class="keyword">import</span> &#123;<span class="title class_">Loading</span>&#125; <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明变量，用来存储 Loading 组件的实例对象</span></span><br><span class="line"><span class="keyword">let</span> loadingInstance = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">axios.<span class="property">interceptors</span>.<span class="property">request</span>.<span class="title function_">use</span>(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 调用 Loading 组件的 service（）方法，创建 Loading 组件的实例，并全屏展示 Loading 效果</span></span><br><span class="line">    loadingInstance = <span class="title class_">Loading</span>.<span class="title function_">service</span>(&#123;<span class="attr">fullscreen</span>: <span class="literal">true</span>&#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="13-5-配置响应拦截器"><a href="#13-5-配置响应拦截器" class="headerlink" title="13.5 配置响应拦截器"></a>13.5 配置响应拦截器</h3><p>通过 axios.interceeptors.response.use(成功的回调，失败的回调) 可以配置响应拦截器。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">interrceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="keyword">function</span>(<span class="params">response</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">&#125;, <span class="keyword">function</span>(<span class="params">error</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Promise</span>.<span class="title function_">reject</span>(error)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="13-5-1-响应拦截器-关闭-Loading-效果"><a href="#13-5-1-响应拦截器-关闭-Loading-效果" class="headerlink" title="13.5.1 响应拦截器 - 关闭 Loading 效果"></a>13.5.1 响应拦截器 - 关闭 Loading 效果</h4><p>调用 Loading 实力提供的 close（）方法即可关闭 Loading 效果。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">interceptors</span>.<span class="property">response</span>.<span class="title function_">use</span>(<span class="function"><span class="params">resonse</span> =&gt;</span> &#123;</span><br><span class="line">    loadingInstance.<span class="title function_">clse</span>()</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="14-proxy-跨域代理"><a href="#14-proxy-跨域代理" class="headerlink" title="14 proxy 跨域代理"></a>14 proxy 跨域代理</h2><h3 id="14-1-接口的跨域问题"><a href="#14-1-接口的跨域问题" class="headerlink" title="14.1 接口的跨域问题"></a>14.1 接口的跨域问题</h3><p>vue 项目运行的地址： <a href="http://localhost:8080/">http://localhost:8080/</a></p><p>API 接口运行的地址：<a href="https://www.escook.cn/api/users">https://www.escook.cn/api/users</a></p><p>由于当前的 API 接口没有开启 CORS 跨域资源共享，因此默认情况下，上面的接口无法请求成功。</p><p><img src="https://s2.loli.net/2022/09/24/8vcqbzM9xJGKfnD.png" alt="image-20220924134630271.png"></p><h3 id="14-2-通过代理解决接口的跨域问题"><a href="#14-2-通过代理解决接口的跨域问题" class="headerlink" title="14.2 通过代理解决接口的跨域问题"></a>14.2 通过代理解决接口的跨域问题</h3><p>通过 vue-cli 创建的项目在遇到接口跨域问题时，可以通过代理的方式来解决：</p><p><img src="https://s2.loli.net/2022/09/24/1u6ZJeSgmszNLBC.png" alt="image-20220924135112537.png"></p><ol><li>把 axios 的请求根路径设置为 vue 项目的运行地址（接口请求不再跨域）</li><li>vue 项目发现请求的接口不存在，把请求交给 proxy 代理</li><li>代理把请求根路径替换为 devServer.proxy 属性的值，发起真正的数据请求</li><li>代理把请求到的数据转发给 axios</li></ol><h3 id="14-3-在项目中配置-proxy-代理"><a href="#14-3-在项目中配置-proxy-代理" class="headerlink" title="14.3 在项目中配置 proxy 代理"></a>14.3 在项目中配置 proxy 代理</h3><ol><li>在 main.js 中，把 axios 的请求根路径改造为当前 web 项目的根路径</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span> = <span class="string">&#x27;http://localhost:8080&#x27;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在项目根目录下创建 vue.config.js 的配置对象，并声明如下的配置</li></ol><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">module</span>.<span class="property">exports</span> = &#123;</span><br><span class="line">    <span class="attr">devServer</span>: &#123;</span><br><span class="line">        <span class="attr">proxy</span>: <span class="string">&#x27;https://www.escook.cn&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注意：</p><ol><li>devServer.proxy 提供的代理功能，仅在开发调试阶段生效</li><li>项目上线发布时，依旧需要 API 接口服务器开启 CORS 跨域资源共享</li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> Note </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Note </tag>
            
            <tag> Vue </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
